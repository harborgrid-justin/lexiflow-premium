import { Controller, Get, UseGuards } from "@nestjs/common";
import { ApiOperation, ApiResponse, ApiTags } from "@nestjs/swagger";
import { AbacGuard } from "../guards/abac.guard";
import { MalwareSignaturesService } from "../services/malware.signatures.service";

/**
 * Malware Signatures Controller
 * Provides endpoints for malware signature management and scanning
 */
@ApiTags("Security")
@Controller("security")
@UseGuards(AbacGuard)
export class MalwareSignaturesController {
  constructor(
    private readonly malwareSignaturesService: MalwareSignaturesService
  ) {}

  /**
   * Get all malware signatures
   */
  @Get("malware-signatures")
  @ApiOperation({
    summary: "Get malware signatures",
    description:
      "Retrieve the current list of malware signatures for threat detection",
  })
  @ApiResponse({
    status: 200,
    description: "List of malware signatures",
    schema: {
      type: "array",
      items: { type: "string" },
    },
  })
  async getMalwareSignatures(): Promise<string[]> {
    return this.malwareSignaturesService.getMalwareSignatures();
  }
}
