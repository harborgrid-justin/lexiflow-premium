import{r as s,j as e,m as w,y as R,ax as S,k as T,F as A,p as D}from"./vendor-core-V-oW58GW.js";import{B as b}from"./Button-PaGqeZoR.js";import{T as E}from"./TextArea-BMpffac7.js";import{u as I}from"./ThemeContext-OPG61qw5.js";import{G as C}from"./geminiService-DjDdWyh4.js";import{c as a}from"./useQueryHooks-BdeOvP9e.js";import{r as P,R as F}from"./dataService-75QCl8KS.js";import"./vendor-misc-Dwkhvdtg.js";import"./vendor-charts-KZIdMATq.js";import"./schemas-B2_dy3tf.js";import"./preload-helper-BXl3LOEh.js";import"./type-mappings-DEPYyX4d.js";const H=({onInsert:N,caseContext:d})=>{const{theme:r}=I(),[l,j]=s.useState(""),[i,o]=s.useState(""),[m,x]=s.useState(!1),[u,y]=s.useState("Persuasive"),[p,c]=s.useState(0),[f,n]=s.useState(null),h=async()=>{if(l){x(!0),n(null),c(0),o("");try{const t=`
            Draft a section for a legal pleading with the following context:

            CASE INFORMATION:
            - Title: ${d.title}
            - Summary: ${d.summary||"No summary provided"}

            DRAFTING PARAMETERS:
            - Tone: ${u}
            - Style: Professional legal writing
            - Format: Proper paragraph structure with legal citations where appropriate

            USER REQUEST:
            ${l}

            INSTRUCTIONS:
            - Use clear, concise legal language
            - Include relevant legal standards if applicable
            - Format as proper legal paragraphs
            - Do NOT include markdown code blocks
            - Return ONLY the legal text
        `,v=await P(()=>C.generateDraft(t,"Pleading Section"),{maxRetries:3,initialDelay:1e3,maxDelay:8e3,backoffFactor:2,onRetry:(g,k)=>{c(g),console.warn(`Retry attempt ${g}:`,k.message)}});o(v),n(null)}catch(t){console.error("AI drafting error:",t),t instanceof F?(n(`Failed after ${t.attempts} attempts: ${t.lastError.message}`),o("")):(n("An unexpected error occurred. Please check your connection and try again."),o(""))}finally{x(!1),c(0)}}};return e.jsxs("div",{className:a("flex flex-col h-full border-l",r.surface.highlight,r.border.default),children:[e.jsxs("div",{className:a("p-4 border-b",r.surface.default,r.border.default),children:[e.jsxs("h3",{className:a("text-sm font-bold flex items-center gap-2",r.text.primary),children:[e.jsx(w,{className:"h-4 w-4 text-purple-600"})," AI Co-Counsel"]}),e.jsx("p",{className:a("text-xs mt-1",r.text.secondary),children:"Draft arguments based on case facts."})]}),e.jsxs("div",{className:"p-4 flex-1 overflow-y-auto space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:a("block text-xs font-bold uppercase mb-1.5",r.text.secondary),children:"Drafting Goal"}),e.jsx(E,{value:l,onChange:t=>j(t.target.value),placeholder:"e.g., Draft an introduction arguing that the court lacks personal jurisdiction...",rows:4,className:r.surface.default})]}),e.jsxs("div",{children:[e.jsx("label",{className:a("block text-xs font-bold uppercase mb-1.5",r.text.secondary),children:"Tone Strategy"}),e.jsx("div",{className:"flex gap-2",children:["Persuasive","Neutral","Aggressive"].map(t=>e.jsx("button",{onClick:()=>y(t),className:a("flex-1 py-1.5 text-xs font-medium rounded border transition-colors",u===t?"bg-purple-100 border-purple-300 text-purple-800 dark:bg-purple-900/30 dark:border-purple-700 dark:text-purple-300":a(r.surface.default,r.border.default,r.text.secondary)),children:t},t))})]}),f&&e.jsxs("div",{className:a("p-3 rounded-lg border flex items-start gap-2","bg-rose-50 border-rose-200 text-rose-800 dark:bg-rose-900/20 dark:border-rose-800 dark:text-rose-300"),children:[e.jsx(R,{className:"h-4 w-4 mt-0.5 flex-shrink-0"}),e.jsxs("div",{className:"text-xs",children:[e.jsx("div",{className:"font-semibold mb-1",children:"Connection Error"}),e.jsx("div",{children:f})]})]}),e.jsx(b,{onClick:h,isLoading:m,variant:"primary",className:"w-full bg-gradient-to-r from-purple-600 to-indigo-600 hover:from-purple-700 hover:to-indigo-700 border-none text-white",icon:S,disabled:!l.trim(),children:m?p>0?`Retrying (${p}/3)...`:"Drafting...":"Generate Text"}),i&&e.jsxs("div",{className:"animate-in fade-in slide-in-from-bottom-4 duration-300",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:a("text-xs font-bold uppercase",r.text.secondary),children:"Result"}),e.jsx("div",{className:"flex gap-2",children:e.jsx("button",{onClick:h,className:"p-1 hover:bg-slate-200 dark:hover:bg-slate-800 rounded text-slate-500",title:"Regenerate",children:e.jsx(T,{className:"h-3 w-3"})})})]}),e.jsx("div",{className:a("p-3 rounded border text-sm font-serif leading-relaxed mb-3",r.surface.default,r.border.default,r.text.primary),children:i}),e.jsx(b,{onClick:()=>N(i),variant:"secondary",className:"w-full",icon:A,children:"Insert into Document"})]}),e.jsxs("div",{className:a("p-3 rounded bg-blue-50 dark:bg-blue-900/20 border border-blue-100 dark:border-blue-800 flex gap-2 items-start mt-6"),children:[e.jsx(D,{className:"h-4 w-4 text-blue-600 dark:text-blue-400 shrink-0 mt-0.5"}),e.jsxs("p",{className:"text-xs text-blue-800 dark:text-blue-300",children:[e.jsx("strong",{children:"Tip:"}),' You can reference specific exhibit IDs (e.g., "Exhibit A") in your prompt and the AI will contextually link them.']})]})]})]})};export{H as AIDraftingAssistant};
