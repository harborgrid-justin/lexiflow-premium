import{d as s,S as n,g as i}from"./dataService-BWLMkXM4.js";import"./preload-helper-BXl3LOEh.js";import"./useQueryHooks-Oyt-TMLP.js";import"./vendor-core-V-oW58GW.js";import"./vendor-misc-Dwkhvdtg.js";import"./vendor-charts-KZIdMATq.js";import"./type-mappings-DEPYyX4d.js";const d={getAll:async()=>s.getAll(n.ASSETS),getById:async e=>s.get(n.ASSETS,e),add:async e=>{const t=e&&typeof e=="object"?e:{};return s.put(n.ASSETS,{...t,status:t.status||"available",createdAt:new Date().toISOString()})},update:async(e,t)=>{const a=await s.get(n.ASSETS,e);return s.put(n.ASSETS,{...a&&typeof a=="object"?a:{},...t&&typeof t=="object"?t:{}})},delete:async e=>s.delete(n.ASSETS,e),getAssets:async e=>{let t=await s.getAll(n.ASSETS);return e?.type&&(t=t.filter(a=>a.type===e.type)),e?.status&&(t=t.filter(a=>a.status===e.status)),e?.assignedTo&&(t=t.filter(a=>a.assignedTo===e.assignedTo)),t},assignAsset:async(e,t)=>{await i(100);try{const a=await s.get(n.ASSETS,e);return a?(a.assignedTo&&a.assignedTo!==t&&console.warn(`[AssetService] Asset ${e} already assigned to ${a.assignedTo}`),await s.put(n.ASSETS,{...a,assignedTo:t,status:"in-use",assignedAt:new Date().toISOString()}),console.log(`[AssetService] Assigned asset ${e} to user ${t}`),!0):!1}catch{return!1}},unassignAsset:async e=>{await i(100);try{const t=await s.get(n.ASSETS,e);return t?(await s.put(n.ASSETS,{...t,assignedTo:void 0,status:"available",unassignedAt:new Date().toISOString()}),console.log(`[AssetService] Unassigned asset ${e}`),!0):!1}catch{return!1}},getMaintenanceHistory:async e=>(await i(50),(await s.getAll(n.MAINTENANCE_TICKETS)).filter(a=>a.assetId===e).sort((a,r)=>new Date(r.performedAt).getTime()-new Date(a.performedAt).getTime())),scheduleMaintenance:async(e,t)=>{const a={id:`maint-${Date.now()}`,assetId:e,type:t.type||"inspection",description:t.description||"Scheduled maintenance",performedBy:t.performedBy,performedAt:t.performedAt||new Date().toISOString(),cost:t.cost,nextMaintenanceDate:t.nextMaintenanceDate};await s.put(n.MAINTENANCE_TICKETS,a);const r=await s.get(n.ASSETS,e);return r&&await s.put(n.ASSETS,{...r,status:"maintenance"}),a}};export{d as AssetService};
