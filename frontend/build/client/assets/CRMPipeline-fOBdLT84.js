import{r as d,j as t,a8 as L,aa as $,al as k}from"./vendor-core-V-oW58GW.js";import{d as M,q as m,c as n}from"./useQueryHooks-BdeOvP9e.js";import"./dataService-75QCl8KS.js";import{u as I}from"./ThemeContext-OPG61qw5.js";import"./SyncContext-DYD5yPAv.js";import{u as K}from"./useModalState-Cst_3NmK.js";import{u as A}from"./useNotify-Bhb3OIEg.js";import{K as E,a as O,b as T}from"./Kanban-BbECSZhC.js";import"./vendor-misc-Dwkhvdtg.js";import"./vendor-charts-KZIdMATq.js";import"./preload-helper-BXl3LOEh.js";import"./type-mappings-DEPYyX4d.js";const W=({leads:u})=>{const{theme:a}=I(),{success:p}=A(),[i,c]=d.useState(null),[f,x]=d.useState(null),h=K(),{mutate:g}=M(async({id:s,stage:o})=>(m.getQueryState(["crm","leads"])?.data||[]).map(r=>r.id===s?{...r,stage:o}:r),{onSuccess:s=>{m.setQueryData(["crm","leads"],s)}}),y=(s,o)=>{c(o),s.dataTransfer.effectAllowed="move"},j=s=>{i!==null&&g({id:i,stage:s}),c(null),x(null)},b=()=>{h.open(),p('Lead intake wizard opened. Use "New Intake" button in header to add leads.')},v=["New Lead","Conflict Check","Engagement","Matter Created"];return t.jsx("div",{className:"flex flex-col h-full",children:t.jsx(E,{children:v.map((s,o)=>{const l=u.filter(e=>typeof e=="object"&&e!==null&&"stage"in e&&e.stage===s);return t.jsx(O,{title:s,count:l.length,isDragOver:f===s,onDrop:()=>j(s),action:o===0?t.jsxs("button",{onClick:b,className:n("mt-3 w-full py-2 border-2 border-dashed rounded-lg text-xs font-bold transition-all flex items-center justify-center",a.border.default,a.text.secondary,`hover:${a.surface.default}`,`hover:${a.primary.text}`,`hover:${a.primary.border}`),children:[t.jsx(k,{className:"h-3 w-3 mr-1"})," Add Lead"]}):void 0,children:l.map(e=>{if(typeof e!="object"||e===null)return null;const r="id"in e?String(e.id):"",N="client"in e&&typeof e.client=="string"?e.client:"",S="title"in e&&typeof e.title=="string"?e.title:"",D="value"in e&&typeof e.value=="string"?e.value:"$0",w="date"in e&&typeof e.date=="string"?e.date:"";return t.jsxs(T,{onDragStart:C=>y(C,r),isDragging:i===r,children:[t.jsx("div",{className:"flex justify-between items-start mb-1",children:t.jsx("h4",{className:n("font-bold text-sm line-clamp-1 transition-colors",a.text.primary,`group-hover:${a.primary.text}`),children:N})}),t.jsx("p",{className:n("text-xs mb-3 line-clamp-1",a.text.secondary),children:S}),t.jsxs("div",{className:n("flex justify-between items-center text-xs pt-2 border-t",a.border.default),children:[t.jsxs("span",{className:n("font-mono font-medium flex items-center",a.status.success.text),children:[t.jsx(L,{className:"h-3 w-3 mr-0.5"}),D.replace("$","")]}),t.jsxs("span",{className:n("flex items-center gap-1",a.text.tertiary),children:[t.jsx($,{className:"h-3 w-3"})," ",w]})]})]},r)})},s)})})})};export{W as CRMPipeline,W as default};
