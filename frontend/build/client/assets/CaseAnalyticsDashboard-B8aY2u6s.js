import{r as N,j as e,ae as R,a0 as T,a8 as z,q as E,aj as S,bQ as $,bM as B,bR as L,bS as F}from"./vendor-core-V-oW58GW.js";import{u as g,b,c as s}from"./useQueryHooks-BdeOvP9e.js";import{B as U}from"./Button-PaGqeZoR.js";import{C as j}from"./Card-D56KNEnI.js";import{u as P}from"./ThemeContext-OPG61qw5.js";import{C as Q}from"./type-mappings-DEPYyX4d.js";import"./vendor-misc-Dwkhvdtg.js";import"./vendor-charts-KZIdMATq.js";const V=()=>{const{isDark:t}=P(),[l,u]=N.useState("30d"),d="all",{data:i}=g(["matters","all"],()=>b.cases.getAll()),{data:r}=g(["billing","time-entries"],()=>b.billing.getTimeEntries()),{data:p}=g(["billing","invoices"],()=>b.billing.getInvoices()),x=N.useMemo(()=>{if(!i)return{totalMatters:0,revenue:0,avgResolution:0,utilization:0};const c=new Date,o=new Date;l==="7d"?o.setDate(c.getDate()-7):l==="30d"?o.setDate(c.getDate()-30):l==="90d"?o.setDate(c.getDate()-90):l==="ytd"&&o.setMonth(0,1);const v=i.filter(a=>a.createdAt&&new Date(a.createdAt)>=o&&d==="all"),w=p?.filter(a=>a.createdAt&&new Date(a.createdAt)>=o).reduce((a,n)=>a+(n.totalAmount||0),0)||0,h=v.filter(a=>a.status===Q.Closed),D=h.length>0?Math.round(h.reduce((a,n)=>{if(!n.createdAt||!n.updatedAt)return a;const C=new Date(n.createdAt),M=new Date(n.updatedAt);return a+(M.getTime()-C.getTime())/(1e3*60*60*24)},0)/h.length):0,A=r?.reduce((a,n)=>a+(n.duration||0),0)||0,f=180*(r?.length||1),y=f>0?A/f*100:0;return{totalMatters:v.length,revenue:w,avgResolution:D,utilization:y}},[i,r,p,l,d]);return e.jsxs("div",{className:s("h-full flex flex-col",t?"bg-slate-900":"bg-slate-50"),children:[e.jsx("div",{className:s("border-b px-6 py-4",t?"bg-slate-800 border-slate-700":"bg-white border-slate-200"),children:e.jsxs("div",{className:"flex items-center justify-end gap-3",children:[e.jsxs("select",{value:l,onChange:c=>u(c.target.value),className:s("px-4 py-2 rounded-lg border text-sm",t?"bg-slate-700 border-slate-600 text-slate-100":"bg-white border-slate-300 text-slate-900"),children:[e.jsx("option",{value:"7d",children:"Last 7 Days"}),e.jsx("option",{value:"30d",children:"Last 30 Days"}),e.jsx("option",{value:"90d",children:"Last 90 Days"}),e.jsx("option",{value:"ytd",children:"Year to Date"}),e.jsx("option",{value:"all",children:"All Time"})]}),e.jsxs(U,{variant:"outline",size:"sm",children:[e.jsx(R,{className:"w-4 h-4 mr-2"}),"Export Report"]})]})}),e.jsxs("div",{className:"flex-1 overflow-auto p-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-6",children:[e.jsx(m,{icon:T,title:"Total Matters",value:x.totalMatters.toString(),change:`${l} period`,isDark:t}),e.jsx(m,{icon:z,title:"Revenue",value:`$${(x.revenue/1e6).toFixed(1)}M`,change:"From invoices",isDark:t}),e.jsx(m,{icon:E,title:"Avg Resolution Time",value:`${x.avgResolution} days`,change:"Closed matters",isDark:t}),e.jsx(m,{icon:S,title:"Team Utilization",value:`${Math.round(x.utilization)}%`,change:"Based on time entries",isDark:t})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs(j,{className:"p-6",children:[e.jsx("h3",{className:s("text-lg font-semibold mb-4",t?"text-slate-100":"text-slate-900"),children:"Revenue Trend"}),e.jsxs("div",{className:s("h-64 flex items-center justify-center rounded border",t?"border-slate-700 bg-slate-800/50":"border-slate-200 bg-slate-50"),children:[e.jsx($,{className:s("w-12 h-12",t?"text-slate-600":"text-slate-300")}),e.jsx("span",{className:s("ml-3 text-sm",t?"text-slate-500":"text-slate-400"),children:"Chart will be rendered here"})]})]}),e.jsxs(j,{className:"p-6",children:[e.jsx("h3",{className:s("text-lg font-semibold mb-4",t?"text-slate-100":"text-slate-900"),children:"Practice Area Distribution"}),e.jsxs("div",{className:s("h-64 flex items-center justify-center rounded border",t?"border-slate-700 bg-slate-800/50":"border-slate-200 bg-slate-50"),children:[e.jsx(B,{className:s("w-12 h-12",t?"text-slate-600":"text-slate-300")}),e.jsx("span",{className:s("ml-3 text-sm",t?"text-slate-500":"text-slate-400"),children:"Chart will be rendered here"})]})]})]})]})]})},m=({icon:t,title:l,value:u,change:d,trend:i,isDark:r})=>e.jsx(j,{className:"p-6",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:s("text-sm font-medium mb-1",r?"text-slate-400":"text-slate-600"),children:l}),e.jsx("div",{className:s("text-2xl font-bold",r?"text-slate-100":"text-slate-900"),children:u}),e.jsxs("div",{className:s("flex items-center gap-1 text-sm mt-2",i==="up"?"text-emerald-500":i==="down"?"text-red-500":r?"text-slate-400":"text-slate-600"),children:[i&&(i==="up"?e.jsx(L,{className:"w-3 h-3"}):e.jsx(F,{className:"w-3 h-3"})),d]})]}),e.jsx("div",{className:s("p-3 rounded-lg",r?"bg-slate-700":"bg-slate-100"),children:e.jsx(t,{className:s("w-5 h-5",r?"text-blue-400":"text-blue-600")})})]})});export{V as CaseAnalyticsDashboard};
