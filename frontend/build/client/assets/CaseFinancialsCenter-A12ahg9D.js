import{r as f,j as e,ae as S,a8 as B,q as E,t as D,bV as T,bI as F}from"./vendor-core-V-oW58GW.js";import{u as w,b as y,c as s}from"./useQueryHooks-BdeOvP9e.js";import{B as V}from"./Badge-B08w10nz.js";import{B as R}from"./Button-PaGqeZoR.js";import{C as j}from"./Card-D56KNEnI.js";import{u as z}from"./ThemeContext-OPG61qw5.js";import"./vendor-misc-Dwkhvdtg.js";import"./vendor-charts-KZIdMATq.js";const Q=()=>{const{isDark:t}=z(),[i,o]=f.useState("30d"),[a,r]=f.useState("overview"),{data:l}=w(["billing","invoices"],()=>y.billing.getInvoices()),{data:h}=w(["billing","time-entries"],()=>y.billing.getTimeEntries()),{data:$}=w(["matters","all"],()=>y.cases.getAll()),v=f.useMemo(()=>{const u=new Date,m=new Date;i==="30d"?m.setDate(u.getDate()-30):i==="90d"?m.setDate(u.getDate()-90):i==="ytd"&&m.setMonth(0,1);const c=l?.filter(n=>n.createdAt&&new Date(n.createdAt)>=m)||[],x=h?.filter(n=>{const d=n.date||(n.createdAt?n.createdAt:new Date().toISOString());return new Date(d)>=m})||[],p=c.reduce((n,d)=>n+(d.totalAmount||d.amount||0),0),b=x.reduce((n,d)=>n+(d.duration||0),0),g=x.reduce((n,d)=>n+(d.duration||0)*(d.rate||150),0),C=g>0?p/g*100:0,M=l?.filter(n=>n.status==="PENDING"||n.status==="OVERDUE").reduce((n,d)=>n+(d.totalAmount||d.amount||0),0)||0;return{totalRevenue:p,billableHours:Math.round(b),realizationRate:Math.round(C*10)/10,outstandingAR:M}},[l,h,i]);return e.jsxs("div",{className:s("h-full flex flex-col",t?"bg-slate-900":"bg-slate-50"),children:[e.jsx("div",{className:s("border-b px-6 py-4",t?"bg-slate-800 border-slate-700":"bg-white border-slate-200"),children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("select",{value:i,onChange:u=>o(u.target.value),className:s("px-4 py-2 rounded-lg border text-sm",t?"bg-slate-700 border-slate-600 text-slate-100":"bg-white border-slate-300 text-slate-900"),children:[e.jsx("option",{value:"30d",children:"Last 30 Days"}),e.jsx("option",{value:"90d",children:"Last 90 Days"}),e.jsx("option",{value:"ytd",children:"Year to Date"}),e.jsx("option",{value:"all",children:"All Time"})]}),e.jsxs(R,{variant:"outline",size:"sm",children:[e.jsx(S,{className:"w-4 h-4 mr-2"}),"Export"]})]})}),e.jsxs("div",{className:s("flex items-center gap-2 p-1 rounded-lg",t?"bg-slate-700":"bg-slate-100"),children:[e.jsx("button",{onClick:()=>r("overview"),className:s("px-4 py-2 rounded text-sm font-medium transition-colors",a==="overview"?t?"bg-slate-600 text-slate-100":"bg-white text-slate-900 shadow-sm":t?"text-slate-400":"text-slate-600"),children:"Overview"}),e.jsx("button",{onClick:()=>r("billing"),className:s("px-4 py-2 rounded text-sm font-medium transition-colors",a==="billing"?t?"bg-slate-600 text-slate-100":"bg-white text-slate-900 shadow-sm":t?"text-slate-400":"text-slate-600"),children:"Billing"}),e.jsx("button",{onClick:()=>r("expenses"),className:s("px-4 py-2 rounded text-sm font-medium transition-colors",a==="expenses"?t?"bg-slate-600 text-slate-100":"bg-white text-slate-900 shadow-sm":t?"text-slate-400":"text-slate-600"),children:"Expenses"}),e.jsx("button",{onClick:()=>r("budget"),className:s("px-4 py-2 rounded text-sm font-medium transition-colors",a==="budget"?t?"bg-slate-600 text-slate-100":"bg-white text-slate-900 shadow-sm":t?"text-slate-400":"text-slate-600"),children:"Budget"})]}),e.jsxs("div",{className:"flex-1 overflow-auto p-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-6",children:[e.jsx(N,{icon:B,title:"Total Revenue",value:`$${(v.totalRevenue/1e6).toFixed(1)}M`,change:i,isDark:t}),e.jsx(N,{icon:E,title:"Billable Hours",value:v.billableHours.toLocaleString(),change:`${i} period`,isDark:t}),e.jsx(N,{icon:D,title:"Realization Rate",value:`${v.realizationRate}%`,change:"Revenue vs billed",isDark:t}),e.jsx(N,{icon:T,title:"Outstanding AR",value:`$${(v.outstandingAR/1e3).toFixed(0)}K`,change:"Pending invoices",isDark:t})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6 mb-6",children:[e.jsxs(j,{className:"lg:col-span-2 p-6",children:[e.jsx("h3",{className:s("text-lg font-semibold mb-4",t?"text-slate-100":"text-slate-900"),children:"Revenue Trend"}),e.jsxs("div",{className:s("h-64 flex items-center justify-center rounded border",t?"border-slate-700 bg-slate-800/50":"border-slate-200 bg-slate-50"),children:[e.jsx(F,{className:s("w-12 h-12",t?"text-slate-600":"text-slate-300")}),e.jsx("span",{className:s("ml-3 text-sm",t?"text-slate-500":"text-slate-400"),children:"Revenue chart will be rendered here"})]})]}),e.jsxs(j,{className:"p-6",children:[e.jsx("h3",{className:s("text-lg font-semibold mb-4",t?"text-slate-100":"text-slate-900"),children:"Top Matters by Revenue"}),e.jsx("div",{className:"space-y-3",children:$&&(()=>{const u=$.map(c=>{const p=(l?.filter(b=>b.caseId===c.id)||[]).reduce((b,g)=>b+(g.totalAmount||g.amount||0),0);return{matter:c,revenue:p}}).sort((c,x)=>x.revenue-c.revenue).slice(0,5),m=u.reduce((c,x)=>c+x.revenue,0);return u.map(({matter:c,revenue:x})=>e.jsx(K,{matter:c.title,revenue:x,percentage:m>0?Math.round(x/m*100):0,isDark:t},c.id))})()})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs(j,{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:s("text-lg font-semibold",t?"text-slate-100":"text-slate-900"),children:"Budget Performance"}),e.jsx(R,{variant:"ghost",size:"sm",children:"View All"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx(A,{matter:"Smith v. Acme Corp",budget:15e4,spent:178e3,remaining:-28e3,isDark:t}),e.jsx(A,{matter:"Tech Startup M&A",budget:2e5,spent:195e3,remaining:5e3,isDark:t}),e.jsx(A,{matter:"Johnson Estate",budget:5e4,spent:45e3,remaining:5e3,isDark:t})]})]}),e.jsxs(j,{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:s("text-lg font-semibold",t?"text-slate-100":"text-slate-900"),children:"Recent Invoices"}),e.jsx(R,{variant:"ghost",size:"sm",children:"View All"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(I,{invoiceNumber:"INV-2025-0234",matter:"Smith v. Acme Corp",amount:25e3,status:"paid",date:"Dec 15, 2025",isDark:t}),e.jsx(I,{invoiceNumber:"INV-2025-0235",matter:"Tech Startup M&A",amount:18500,status:"pending",date:"Dec 18, 2025",isDark:t}),e.jsx(I,{invoiceNumber:"INV-2025-0236",matter:"Johnson Estate",amount:8200,status:"overdue",date:"Dec 1, 2025",isDark:t})]})]})]})]})]})},N=({icon:t,title:i,value:o,change:a,trend:r="up",isDark:l})=>e.jsx(j,{className:"p-6",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:s("text-sm font-medium mb-1",l?"text-slate-400":"text-slate-600"),children:i}),e.jsx("div",{className:s("text-2xl font-bold",l?"text-slate-100":"text-slate-900"),children:o}),e.jsx("div",{className:s("text-sm mt-2",r==="up"?"text-emerald-500":"text-red-500"),children:a})]}),e.jsx("div",{className:s("p-3 rounded-lg",l?"bg-slate-700":"bg-slate-100"),children:e.jsx(t,{className:s("w-5 h-5",l?"text-blue-400":"text-blue-600")})})]})}),K=({matter:t,revenue:i,percentage:o,isDark:a})=>e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:s("text-sm font-medium",a?"text-slate-300":"text-slate-700"),children:t}),e.jsxs("span",{className:s("text-sm font-semibold",a?"text-slate-100":"text-slate-900"),children:["$",(i/1e3).toFixed(0),"K"]})]}),e.jsx("div",{className:s("h-2 rounded-full",a?"bg-slate-700":"bg-slate-200"),children:e.jsx("div",{className:"h-full rounded-full bg-gradient-to-r from-blue-500 to-emerald-500",style:{width:`${o}%`}})})]}),A=({matter:t,budget:i,spent:o,remaining:a,isDark:r})=>{const l=o/i*100,h=a<0;return e.jsxs("div",{className:s("p-4 rounded-lg border",r?"border-slate-700 bg-slate-800/50":"border-slate-200 bg-white"),children:[e.jsx("div",{className:s("font-medium mb-2",r?"text-slate-100":"text-slate-900"),children:t}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsxs("span",{className:s(r?"text-slate-400":"text-slate-600"),children:["Budget: $",(i/1e3).toFixed(0),"K"]}),e.jsxs("span",{className:s(r?"text-slate-400":"text-slate-600"),children:["Spent: $",(o/1e3).toFixed(0),"K"]})]}),e.jsx("div",{className:s("h-2 rounded-full",r?"bg-slate-700":"bg-slate-200"),children:e.jsx("div",{className:s("h-full rounded-full",h?"bg-red-500":"bg-emerald-500"),style:{width:`${Math.min(l,100)}%`}})}),e.jsx("div",{className:s("text-sm font-semibold",h?"text-red-500":"text-emerald-500"),children:a>=0?`$${(a/1e3).toFixed(0)}K remaining`:`$${Math.abs(a/1e3).toFixed(0)}K over budget`})]})]})},I=({invoiceNumber:t,matter:i,amount:o,status:a,date:r,isDark:l})=>e.jsxs("div",{className:s("p-4 rounded-lg border",l?"border-slate-700 bg-slate-800/50":"border-slate-200 bg-white"),children:[e.jsxs("div",{className:"flex items-start justify-between mb-2",children:[e.jsxs("div",{children:[e.jsx("div",{className:s("font-medium",l?"text-slate-100":"text-slate-900"),children:t}),e.jsx("div",{className:s("text-sm mt-1",l?"text-slate-400":"text-slate-600"),children:i})]}),e.jsx(V,{variant:a==="paid"?"success":a==="pending"?"warning":"error",children:a})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("span",{className:s("text-lg font-semibold",l?"text-slate-100":"text-slate-900"),children:["$",o.toLocaleString()]}),e.jsx("span",{className:s("text-sm","text-slate-500"),children:r})]})]});export{Q as CaseFinancialsCenter};
