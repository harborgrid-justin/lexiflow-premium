import{r as o,j as e,m as U,N as M,F as J,bW as L,bn as F,X as I,p as $,v as G,bA as _,al as q}from"./vendor-core-V-oW58GW.js";import{u as R}from"./ThemeContext-OPG61qw5.js";import{f as P,c as r,b as w,q as X}from"./useQueryHooks-BdeOvP9e.js";import{B as x}from"./Button-PaGqeZoR.js";import"./vendor-misc-Dwkhvdtg.js";import"./schemas-B2_dy3tf.js";import"./vendor-charts-KZIdMATq.js";const B=()=>{if(typeof localStorage>"u")return"gemini";const a=P.getItem("ai_provider");return a==="openai"||a==="gemini"?a:"gemini"},z=a=>{typeof localStorage<"u"&&(P.setItem("ai_provider",a),console.log(`[AIProvider] Switched to ${a.toUpperCase()}`))},ee=()=>{const{theme:a}=R(),[p,h]=o.useState(""),[t,u]=o.useState(null),[f,m]=o.useState(!1),[y,i]=o.useState(null),[N,l]=o.useState(null),[b,C]=o.useState(!1),[c,A]=o.useState(!0),[g,D]=o.useState(B()),k=s=>{z(s),D(s),i(null),l(`Switched to ${s.toUpperCase()} API`),setTimeout(()=>l(null),3e3)},O=async()=>{m(!0),i(null),l(null),u(null);try{const s=p.trim();if(!s){i("Please paste some content to parse"),m(!1);return}const n=g==="gemini"?localStorage.getItem("gemini_api_key")||void 0:localStorage.getItem("openai_api_key")||void 0,d=await w.cases.parse(s,{useAI:c,provider:g,apiKey:n||void 0});d&&Object.keys(d).length>0?(u(d),d.title&&d.caseNumber&&d.description?l("Successfully extracted case data using AI!"):(l("Extracted partial data. Please review and fill in missing fields."),c&&(i("AI extraction may have been limited. Switched to fallback parsing."),setTimeout(()=>i(null),5e3)))):i("Could not extract any case data. Please check the format and try again.")}catch(s){i(`Parsing error: ${s instanceof Error?s.message:"Unknown error"}`)}finally{m(!1)}},T=async()=>{if(t){m(!0),i(null),l(null);try{if(!t.title||!t.caseNumber){i("Title and Case Number are required fields"),m(!1);return}const s=await w.cases.add({title:t.title,caseNumber:t.caseNumber,description:t.description,type:t.type,matterType:t.type,status:t.status,isArchived:!1,practiceArea:t.practiceArea,jurisdiction:t.jurisdiction,court:t.court,judge:t.judge,referredJudge:t.referredJudge,magistrateJudge:t.magistrateJudge,filingDate:t.filingDate?new Date(t.filingDate).toISOString():new Date().toISOString(),trialDate:t.trialDate?new Date(t.trialDate).toISOString():void 0,closeDate:t.closeDate?new Date(t.closeDate).toISOString():void 0,dateTerminated:t.dateTerminated?new Date(t.dateTerminated).toISOString():void 0,juryDemand:t.juryDemand,causeOfAction:t.causeOfAction,natureOfSuit:t.natureOfSuit,natureOfSuitCode:t.natureOfSuitCode,relatedCases:t.relatedCases,assignedTeamId:t.assignedTeamId,leadAttorneyId:t.leadAttorneyId,clientId:t.clientId,client:"Unknown Client",parties:[],citations:[],arguments:[],defenses:[],metadata:t.metadata});l(`Case "${s.title}" created successfully!`),X.invalidate(["cases"]),setTimeout(()=>{h(""),u(null),l(null)},3e3)}catch(s){i(`Failed to create case: ${s instanceof Error?s.message:"Unknown error"}`)}finally{m(!1)}}},E=(s,n)=>{t&&u({...t,[s]:n})},v=t?.title&&t?.caseNumber;return e.jsxs("div",{className:r("space-y-6",a.background),children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("h2",{className:r("text-2xl font-bold",a.text.primary),children:"Import Case Data"}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:c,onChange:s=>A(s.target.checked),className:"w-4 h-4 rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),e.jsx(U,{className:r("h-4 w-4",c?"text-purple-600":"text-gray-400")}),e.jsx("span",{className:r("text-sm font-medium",c?a.text.primary:a.text.secondary),children:"AI-Powered Extraction"})]}),c&&e.jsxs("div",{className:"flex items-center gap-2 ml-4 pl-4 border-l border-slate-300",children:[e.jsx(M,{className:"h-4 w-4 text-slate-500"}),e.jsx("span",{className:"text-xs text-slate-500",children:"Provider:"}),e.jsxs("select",{value:g,onChange:s=>k(s.target.value),className:r("text-xs px-2 py-1 rounded border font-medium cursor-pointer",a.background,a.border.default,"focus:outline-none focus:ring-2 focus:ring-blue-500"),children:[e.jsx("option",{value:"gemini",children:"Google Gemini"}),e.jsx("option",{value:"openai",children:"OpenAI GPT-4"})]})]})]})]}),e.jsx("p",{className:r("text-sm",a.text.secondary),children:c?`Using ${g==="gemini"?"Google Gemini":"OpenAI GPT-4"} AI for intelligent data extraction from any format.`:"Using rule-based extraction for XML (PACER, CourtListener) and structured text."})]}),e.jsxs("div",{className:r("rounded-lg border p-6 space-y-4",a.surface.default,a.border.default),children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("label",{className:r("text-sm font-semibold",a.text.primary),children:[e.jsx(J,{className:"inline h-4 w-4 mr-2"}),"Paste Document Content"]}),e.jsx("div",{className:"text-xs text-slate-500",children:"Supports: XML, PACER, CourtListener, structured text"})]}),e.jsx("textarea",{value:p,onChange:s=>h(s.target.value),placeholder:`Paste your XML or text document here...

Example (text):
Title: Smith v. Jones Corp
Case Number: 1:23-cv-12345
Court: U.S. District Court, Northern District of California
Filing Date: 2023-01-15
Judge: Hon. Jane Smith

Or paste XML directly from PACER/CourtListener...`,className:r("w-full h-64 px-4 py-3 rounded-md border font-mono text-sm resize-y",a.background,a.border.default,a.text.primary,"focus:outline-none focus:ring-2 focus:ring-blue-500")}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(x,{onClick:O,disabled:f||!p.trim(),icon:f?L:F,variant:"primary",children:f?"Processing...":"Parse Document"}),p&&e.jsx(x,{onClick:()=>{h(""),u(null),i(null),l(null)},icon:I,variant:"outline",children:"Clear"})]})]}),y&&e.jsxs("div",{className:r("flex items-start gap-3 p-4 rounded-lg border","bg-red-50 border-red-200"),children:[e.jsx($,{className:"h-5 w-5 text-red-600 mt-0.5 shrink-0"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold text-red-900",children:"Error"}),e.jsx("p",{className:"text-sm text-red-700",children:y})]})]}),N&&e.jsxs("div",{className:r("flex items-start gap-3 p-4 rounded-lg border","bg-emerald-50 border-emerald-200"),children:[e.jsx(G,{className:"h-5 w-5 text-emerald-600 mt-0.5 shrink-0"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold text-emerald-900",children:"Success"}),e.jsx("p",{className:"text-sm text-emerald-700",children:N})]})]}),t&&e.jsxs("div",{className:r("rounded-lg border p-6 space-y-4",a.surface.default,a.border.default),children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:r("text-lg font-bold",a.text.primary),children:"Extracted Case Data"}),e.jsx(x,{onClick:()=>C(!b),icon:_,variant:"outline",size:"sm",children:b?"View Mode":"Edit Mode"})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:Object.entries(t).map(([s,n])=>{if(!n||s==="metadata")return null;const d=s.replace(/([A-Z])/g," $1").replace(/^./,j=>j.toUpperCase()),S=s==="title"||s==="caseNumber";return e.jsxs("div",{className:"space-y-1",children:[e.jsxs("label",{className:r("text-xs font-semibold",a.text.secondary),children:[d,S&&e.jsx("span",{className:"text-red-500 ml-1",children:"*"})]}),b?e.jsx("input",{type:s.includes("Date")?"date":"text",value:typeof n=="string"?n:JSON.stringify(n),onChange:j=>E(s,j.target.value),className:r("w-full px-3 py-2 rounded-md border text-sm",a.background,a.border.default,a.text.primary)}):e.jsx("div",{className:r("px-3 py-2 rounded-md border text-sm",a.surface.highlight,a.border.default),children:typeof n=="string"?n:JSON.stringify(n)})]},s)})}),e.jsxs("div",{className:"flex gap-2 pt-4 border-t",children:[e.jsx(x,{onClick:T,disabled:!v||f,icon:q,variant:"primary",children:"Create Case"}),e.jsx(x,{onClick:()=>{u(null),C(!1)},icon:I,variant:"outline",children:"Cancel"})]}),!v&&e.jsx("p",{className:"text-xs text-amber-600",children:"⚠️ Title and Case Number are required to create a case"})]})]})};export{ee as CaseImporter};
