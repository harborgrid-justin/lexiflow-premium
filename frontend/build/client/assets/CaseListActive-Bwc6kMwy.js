import{r as u,l as R,j as e,a6 as K,a7 as U,a_ as _,b4 as G,af as J,bR as Q,bS as W,b3 as Z}from"./vendor-core-V-oW58GW.js";import{V as B}from"./VirtualList-r2WXvtCD.js";import{u as k}from"./ThemeContext-OPG61qw5.js";import{c as a,d as V,q as D}from"./useQueryHooks-Oyt-TMLP.js";import{B as ee}from"./Button-CDQlLg6j.js";import{C as L,F as te}from"./FilterPanel-BteidCPx.js";import{I as F}from"./Input-Dmln04Yk.js";import{B as O}from"./Badge-bF-hTHJZ.js";import{E as se}from"./RefactoredCommon-Bm7nW6og.js";import{C as re}from"./ConfirmDialog--jvbqDAw.js";import{u as ae}from"./useNotify-DdRjm5G5.js";import{u as ne}from"./useToggle-CjLp2PQ4.js";import{u as ie}from"./useModalState-Cst_3NmK.js";import{D as I}from"./dataService-BWLMkXM4.js";import{q as oe}from"./queryKeys-BBVgMz36.js";import{C as b}from"./type-mappings-DEPYyX4d.js";import"./vendor-misc-Dwkhvdtg.js";import"./vendor-charts-KZIdMATq.js";import"./formatters-stMuSkc6.js";import"./Modal-Rns91qFF.js";import"./SyncContext-B5_p5hCg.js";import"./preload-helper-BXl3LOEh.js";function le(t,n,o="asc"){const[r,f]=u.useState({key:n,direction:o});return{items:u.useMemo(()=>{const l=[...t];return r!==null&&l.sort((d,m)=>{const p=d[r.key],v=m[r.key];return p<v?r.direction==="asc"?-1:1:p>v?r.direction==="asc"?1:-1:0}),l},[t,r]),requestSort:l=>{let d="asc";r.key===l&&r.direction==="asc"&&(d="desc"),f({key:l,direction:d})},sortConfig:r}}const ce=R.memo(({children:t,onSwipeLeft:n,onSwipeRight:o,leftActionLabel:r="Archive",rightActionLabel:f="Action",leftActionColor:c="bg-rose-500 dark:bg-rose-600",rightActionColor:h="bg-emerald-500 dark:bg-emerald-600",disabled:l=!1})=>{const{theme:d}=k(),[m,p]=u.useState(0),v=u.useRef(0),w=u.useRef(0),i=u.useRef(0),g=u.useRef(!1),j=u.useRef(!1),S=x=>{l||(v.current=x.touches[0].clientX,w.current=x.touches[0].clientY,i.current=0,g.current=!0,j.current=!1)},N=x=>{if(!g.current||l||j.current)return;const A=x.touches[0].clientX,M=x.touches[0].clientY,y=A-v.current,T=M-w.current;if(Math.abs(T)>Math.abs(y)&&Math.abs(T)>5){j.current=!0;return}x.cancelable&&x.preventDefault(),Math.abs(y)<150&&(p(y),i.current=y)},C=()=>{if(!g.current||l||j.current){g.current=!1;return}g.current=!1,i.current>80&&o?(o(),p(0)):(i.current<-80&&n&&n(),p(0))};return e.jsxs("div",{className:"relative overflow-hidden rounded-xl touch-pan-y",children:[e.jsxs("div",{className:a("absolute inset-0 flex justify-between items-center px-4 font-bold text-xs z-0",d.text.inverse),children:[e.jsxs("div",{className:a("absolute left-0 top-0 bottom-0 w-full flex items-center justify-start pl-4 transition-opacity",h,m>0?"opacity-100":"opacity-0"),children:[e.jsx(K,{className:"h-5 w-5 mr-2"})," ",f]}),e.jsxs("div",{className:a("absolute right-0 top-0 bottom-0 w-full flex items-center justify-end pr-4 transition-opacity",c,m<0?"opacity-100":"opacity-0"),children:[r," ",e.jsx(U,{className:"h-5 w-5 ml-2"})]})]}),e.jsx("div",{className:a("relative z-10 transition-transform duration-200 ease-out",d.surface.default),style:{transform:`translateX(${m}px)`},onTouchStart:S,onTouchMove:N,onTouchEnd:C,children:t})]})});function ue(t){const{theme:n}=k(),o=u.useId(),r=t.id||o;return e.jsxs("div",{className:"relative",children:[e.jsx(_,{className:a("absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 pointer-events-none",n.text.tertiary)}),e.jsx(F,{...t,id:r,className:a("pl-10",t.className)})]})}const de={active:"success",online:"success",paid:"success",cleared:"success",success:"success",completed:"success",good:"success",healthy:"success",connected:"success",admitted:"success",served:"success",final:"success",verified:"success",approved:"success",retained:"success",preferred:"success",pending:"warning",away:"warning",warning:"warning",review:"warning",draft:"warning","in progress":"warning",syncing:"warning",marked:"warning",scheduled:"warning",staging:"warning",trial:"warning","at risk":"warning",challenged:"warning",error:"error",offline:"error",overdue:"error",breached:"error",critical:"error",rejected:"error",disconnected:"error",failed:"error",excluded:"error",blocked:"error",revoked:"error",suspended:"error",degraded:"error",appeal:"error",processing:"info",info:"info",open:"info",discovery:"info",litigation:"info",appealing:"info","out for service":"info","new lead":"info"},me={getVariant:t=>{if(!t)return"neutral";const n=String(t).toLowerCase().trim();return de[n]||"neutral"}},X=R.memo(({status:t,className:n,variantOverride:o})=>{const r=o||me.getVariant(t);return e.jsx(O,{variant:r,className:a("whitespace-nowrap",n),children:t})}),P=u.memo(({caseData:t,onSelect:n,onPrefetch:o})=>{const{theme:r}=k(),f=c=>{(c.key==="Enter"||c.key===" ")&&(c.preventDefault(),n(t))};return e.jsxs("div",{role:"button",tabIndex:0,className:a("flex items-center border-b hover:bg-slate-50 transition-colors h-16 px-6 group outline-none focus:bg-slate-50 focus:ring-1 focus:ring-inset focus:ring-blue-500",r.border.default),onMouseEnter:()=>o(t.id),onClick:()=>n(t),onKeyDown:f,style:{contentVisibility:"auto",containIntrinsicSize:"0 64px"},children:[e.jsxs("div",{className:"w-[35%] flex flex-col items-start pr-4 min-w-0",children:[e.jsx("span",{className:a("font-bold text-sm transition-colors flex items-center hover:underline cursor-pointer truncate w-full",r.primary.text),title:t.title,children:t.title}),e.jsx("span",{className:a("text-xs font-mono mt-0.5 opacity-70",r.text.secondary),children:t.id})]}),e.jsx("div",{className:"w-[15%]",children:e.jsx(X,{status:t.matterType})}),e.jsxs("div",{className:"w-[20%] flex items-center text-sm text-slate-500 min-w-0 pr-2",children:[e.jsx(G,{className:"h-3.5 w-3.5 mr-2 text-slate-400 shrink-0"}),e.jsx("span",{className:"truncate",title:t.client,children:t.client})]}),e.jsx("div",{className:"w-[15%]",children:e.jsx(L,{value:t.value||0,className:a("font-medium text-sm",r.text.primary)})}),e.jsx("div",{className:"w-[10%]",children:e.jsx(X,{status:t.status})}),e.jsx("div",{className:"w-[5%] flex justify-end items-center gap-1 opacity-0 group-hover:opacity-100 group-focus:opacity-100 transition-opacity",children:e.jsx("button",{onClick:c=>{c.stopPropagation(),n(t)},className:a("p-1.5 rounded-md transition-colors",r.text.secondary,`hover:${r.surface.highlight}`,`hover:${r.primary.text}`),title:"View Details",tabIndex:-1,children:e.jsx(J,{className:"h-4 w-4"})})})]})},(t,n)=>t.caseData===n.caseData);P.displayName="CaseRow";const fe=({filteredCases:t,sortedCases:n,requestSort:o,sortConfig:r,onSelectCase:f,prefetchCaseDetails:c})=>{const{theme:h}=k(),l=({column:m})=>r.key!==m?e.jsx("div",{className:"w-4 h-4 ml-1 opacity-0 group-hover:opacity-25"}):r.direction==="asc"?e.jsx(Q,{className:a("h-4 w-4 ml-1",h.primary.text)}):e.jsx(W,{className:a("h-4 w-4 ml-1",h.primary.text)}),d=u.useCallback(m=>e.jsx(P,{caseData:m,onSelect:f,onPrefetch:c}),[f,c]);return e.jsxs("div",{className:"hidden md:flex flex-1 min-h-0 flex-col border rounded-lg overflow-hidden shadow-sm bg-white",children:[e.jsxs("div",{className:a("flex items-center px-6 py-3 border-b font-bold text-xs uppercase tracking-wider bg-slate-50 shrink-0",h.border.default,h.text.secondary),children:[e.jsxs("div",{className:"w-[35%] cursor-pointer flex items-center group",onClick:()=>o("title"),children:["Matter ",e.jsx(l,{column:"title"})]}),e.jsxs("div",{className:"w-[15%] cursor-pointer flex items-center group",onClick:()=>o("matterType"),children:["Type ",e.jsx(l,{column:"matterType"})]}),e.jsxs("div",{className:"w-[20%] cursor-pointer flex items-center group",onClick:()=>o("client"),children:["Client ",e.jsx(l,{column:"client"})]}),e.jsxs("div",{className:"w-[15%] cursor-pointer flex items-center group",onClick:()=>o("value"),children:["Value ",e.jsx(l,{column:"value"})]}),e.jsx("div",{className:"w-[10%]",children:"Status"}),e.jsx("div",{className:"w-[5%] text-right"})]}),e.jsx("div",{className:"flex-1 bg-white relative",children:t.length===0?e.jsx("div",{className:"p-8 h-full",children:e.jsx(se,{title:"No Matters Found",message:"No cases match your current filter criteria. Try broadening your search or resetting the filters."})}):e.jsx(B,{items:n,height:"100%",itemHeight:64,renderItem:d})})]})},xe=t=>{switch(t){case b.Settled:case b.Closed:return"success";case b.Trial:return"warning";case b.Appeal:return"error";case b.Discovery:return"info";default:return"neutral"}},Le=({filteredCases:t,statusFilter:n,setStatusFilter:o,typeFilter:r,setTypeFilter:f,searchTerm:c,setSearchTerm:h,dateFrom:l,setDateFrom:d,dateTo:m,setDateTo:p,resetFilters:v,onSelectCase:w})=>{const{theme:i}=k(),g=ae(),{isOpen:j,toggle:S}=ne(!1),N=ie(),[C,x]=R.useState(null),{items:A,requestSort:M,sortConfig:y}=le(t,"filingDate","desc"),{mutate:T}=V(I.cases.archive,{onSuccess:()=>{g.success("Case archived successfully"),D.invalidate(oe.cases.all())}}),{mutate:Y}=V(I.cases.flag,{onSuccess:()=>{g.warning("Case flagged for risk review")}}),E=u.useCallback(s=>{try{I.documents?.getByCaseId&&D.fetch(["documents",s],()=>I.documents.getByCaseId(s))}catch{}},[]),q=s=>{x(s),N.open()},z=()=>{C&&(T(C.id),x(null))},$=s=>{Y(s.id)},H=s=>e.jsx("div",{className:"px-1 py-1.5 h-[120px]",children:e.jsx(ce,{onSwipeLeft:()=>q(s),onSwipeRight:()=>$(s),leftActionLabel:"Archive",rightActionLabel:"Flag",children:e.jsxs("div",{onClick:()=>w(s),onMouseEnter:()=>E(s.id),className:a("p-4 shadow-sm border active:bg-slate-50 transition-colors cursor-pointer relative overflow-hidden h-full flex flex-col justify-between rounded-lg",i.surface.default,i.border.default),children:[e.jsx("div",{className:a("absolute left-0 top-0 bottom-0 w-1",s.status==="Trial"?"bg-amber-500":s.status==="Discovery"?"bg-blue-500":"bg-slate-300")}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-start mb-1 pl-2",children:[e.jsx("span",{className:a("text-xs font-mono opacity-70",i.text.secondary),children:s.id}),e.jsx("span",{className:a("text-[10px] uppercase font-bold text-slate-400"),children:s.matterType})]}),e.jsx("h4",{className:a("font-bold text-base leading-snug line-clamp-2 pl-2",i.text.primary),children:s.title})]}),e.jsxs("div",{className:a("flex items-center justify-between pl-2 pt-2 border-t",i.border.default),children:[e.jsx(O,{variant:xe(s.status),className:"text-[10px] px-2 py-0.5",children:s.status}),e.jsx(L,{value:s.value||0,className:"font-bold text-sm"})]})]})})},s.id);return e.jsxs("div",{className:"space-y-4 h-full flex flex-col",children:[e.jsxs("div",{className:a("flex justify-between items-center shrink-0 px-1"),children:[e.jsx("h2",{className:a("text-2xl font-bold tracking-tight",i.text.primary),children:"Active Matters"}),e.jsx(ee,{variant:"outline",icon:Z,onClick:S,children:j?"Hide Filters":"Show Filters"})]}),e.jsxs(te,{isOpen:j,onClose:S,onClear:v,children:[e.jsx(ue,{placeholder:"Search title, client, ID...",value:c,onChange:s=>h(s.target.value),className:"md:col-span-2"}),e.jsxs("div",{children:[e.jsx("label",{className:a("block text-xs font-semibold uppercase mb-1.5",i.text.secondary),children:"Status"}),e.jsxs("select",{className:a("w-full px-3 py-2 border rounded-md text-sm outline-none",i.surface.default,i.border.default,i.text.primary),value:n,onChange:s=>o(s.target.value),"aria-label":"Status Filter",children:[e.jsx("option",{value:"All",children:"All Statuses"}),Object.values(b).map(s=>e.jsx("option",{value:s,children:s},s))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:a("block text-xs font-semibold uppercase mb-1.5",i.text.secondary),children:"Type"}),e.jsxs("select",{className:a("w-full px-3 py-2 border rounded-md text-sm outline-none",i.surface.default,i.border.default,i.text.primary),value:r,onChange:s=>f(s.target.value),"aria-label":"Type Filter",children:[e.jsx("option",{value:"All",children:"All Types"}),e.jsx("option",{value:"Litigation",children:"Litigation"}),e.jsx("option",{value:"Appeal",children:"Appeal"}),e.jsx("option",{value:"M&A",children:"M&A"}),e.jsx("option",{value:"IP",children:"IP"})]})]}),e.jsx(F,{type:"date",label:"Filed After",value:l,onChange:s=>d(s.target.value)}),e.jsx(F,{type:"date",label:"Filed Before",value:m,onChange:s=>p(s.target.value)})]}),e.jsx(fe,{filteredCases:t,sortedCases:A,requestSort:M,sortConfig:y,onSelectCase:w,prefetchCaseDetails:E}),e.jsx("div",{className:"md:hidden flex-1 min-h-0 relative -mx-2",children:e.jsx(B,{items:A,height:"100%",itemHeight:120,renderItem:H,emptyMessage:"No cases found."})}),e.jsx(re,{isOpen:N.isOpen,onClose:N.close,onConfirm:z,title:"Archive Case",message:`Archive ${C?.title||"this case"}? This will move it to the archived cases list.`,confirmText:"Archive",variant:"warning"})]})};export{Le as CaseListActive};
