import{r as C,j as e,al as E,a2 as D,bh as P,aC as L,V as A,F as O}from"./vendor-core-V-oW58GW.js";import{B as S}from"./Badge-B08w10nz.js";import{T as I}from"./TaskCreationModal-B2VECu1_.js";import{V as H}from"./VirtualList-B1zORm91.js";import{L as B}from"./useSessionStorage-HC9RvMcM.js";import{u as F}from"./ThemeContext-OPG61qw5.js";import{u as R,d as x,c as a,q as p}from"./useQueryHooks-BdeOvP9e.js";import{D as n,T as r}from"./dataService-75QCl8KS.js";import"./SyncContext-DYD5yPAv.js";import{q as h}from"./queryKeys-BBVgMz36.js";import{u as q}from"./useModalState-Cst_3NmK.js";import"./type-mappings-DEPYyX4d.js";import"./vendor-misc-Dwkhvdtg.js";import"./vendor-charts-KZIdMATq.js";import"./useNotify-Bhb3OIEg.js";import"./Modal-BlJFylOy.js";import"./Input-JNgj1Ekc.js";import"./TextArea-BMpffac7.js";import"./Button-PaGqeZoR.js";import"./search.config-B6mvIgDA.js";import"./UserAvatar-lVqVFNPb.js";import"./preload-helper-BXl3LOEh.js";const de=({onSelectCase:c})=>{const o=q(),[l,f]=C.useState("All"),{theme:t}=F(),{data:m=[],isLoading:j,error:g}=R(["tasks","all"],()=>n.tasks.getAll()),{mutate:y}=x(n.tasks.add,{onSuccess:()=>p.invalidate(h.tasks.all())}),{mutate:b}=x(s=>n.tasks.update(s.id,s.updates),{onSuccess:()=>p.invalidate(h.tasks.all())}),k=s=>{switch(s){case"Documents":return e.jsx(O,{className:a("h-3 w-3 mr-1",t.text.tertiary)});case"Discovery":return e.jsx(A,{className:"h-3 w-3 mr-1 text-purple-500"});case"Evidence":return e.jsx(L,{className:"h-3 w-3 mr-1 text-amber-500"});case"Motions":return e.jsx(P,{className:"h-3 w-3 mr-1 text-blue-500"});default:return null}},u=Array.isArray(m)?m:[],N=u.filter(s=>l==="All"?!0:l==="Pending"?s.status===r.TODO||s.status===r.IN_PROGRESS:l==="High Priority"?s.priority==="High":!0),v=async s=>{await y(s)},T=async s=>{const i=u.find(d=>d.id===s);if(i){const d=i.status===r.COMPLETED?r.TODO:r.COMPLETED;await b({id:s,updates:{status:d}})}},w=async s=>{if(s.caseId&&c){const i=await n.cases.getById(s.caseId);i&&c(i)}},M=s=>e.jsxs("div",{className:a("p-4 flex items-start transition-colors group h-[90px] border-b",t.border.default,`hover:${t.surface.highlight}`),children:[e.jsx("div",{className:"pt-0.5 mr-4",children:e.jsx("input",{type:"checkbox",className:"h-5 w-5 text-blue-600 rounded border-slate-300 cursor-pointer",checked:s.status===r.COMPLETED,onChange:()=>T(s.id),"aria-label":`Mark ${s.title} as ${s.status===r.COMPLETED?"incomplete":"complete"}`})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsx("p",{className:a("text-sm font-bold truncate pr-2",s.status===r.COMPLETED?"text-slate-400 line-through":t.text.primary),children:s.title}),e.jsxs("div",{className:"flex items-center gap-2 shrink-0",children:[e.jsx(S,{variant:s.priority==="High"?"error":s.priority==="Medium"?"warning":"neutral",children:s.priority}),s.caseId&&e.jsxs("button",{onClick:()=>w(s),className:a("flex items-center px-2 py-1 rounded text-[10px] font-medium transition-colors border border-transparent","text-blue-600 bg-blue-50 hover:bg-blue-100 hover:border-blue-200"),title:"Go to Case",children:["Case ",e.jsx(D,{className:"h-3 w-3 ml-1"})]})]})]}),e.jsxs("p",{className:a("text-xs mt-1 flex items-center",t.text.secondary),children:[s.relatedModule&&e.jsxs("span",{className:a("flex items-center mr-3 px-1.5 py-0.5 rounded",t.surface.highlight),children:[k(s.relatedModule)," ",s.relatedModule]}),e.jsxs("span",{className:"mr-3",children:["Due: ",s.dueDate]}),e.jsxs("span",{children:["Assignee: ",s.assignee]})]}),s.relatedItemTitle&&e.jsxs("p",{className:a("text-xs mt-1 pl-2 border-l-2 truncate opacity-80",t.primary.text,t.primary.border),children:["Linked: ",s.relatedItemTitle]})]})]},s.id);return e.jsxs("div",{className:"space-y-4 h-full flex flex-col",children:[o.isOpen&&e.jsx(I,{isOpen:!0,onClose:o.close,onSave:v}),e.jsxs("div",{className:a("flex flex-col sm:flex-row justify-between items-center gap-4 p-4 rounded-lg border shadow-sm",t.surface.default,t.border.default),children:[e.jsxs("div",{children:[e.jsx("h3",{className:a("font-bold",t.text.primary),children:"Task Manager"}),e.jsx("p",{className:a("text-sm",t.text.secondary),children:"Cross-module workflow & assignments"})]}),e.jsxs("div",{className:"flex gap-2 w-full sm:w-auto",children:[e.jsxs("select",{className:a("border text-sm rounded-md px-3 py-1.5 outline-none",t.surface.default,t.border.default,t.text.primary),value:l,onChange:s=>f(s.target.value),"aria-label":"Filter Tasks",children:[e.jsx("option",{value:"All",children:"All Tasks"}),e.jsx("option",{value:"Pending",children:"Pending"}),e.jsx("option",{value:"High Priority",children:"High Priority"})]}),e.jsxs("button",{onClick:o.open,className:a("flex items-center justify-center px-4 py-2 rounded-md text-sm font-medium transition-colors",t.primary.DEFAULT,t.text.inverse,t.primary.hover),children:[e.jsx(E,{className:"h-4 w-4 mr-2"})," Add Task"]})]})]}),e.jsx("div",{className:a("rounded-lg border shadow-sm flex-1 overflow-hidden",t.surface.default,t.border.default),children:j?e.jsx(B,{}):g?e.jsx("div",{className:"flex items-center justify-center h-full p-8",children:e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:a("text-sm mb-2",t.text.secondary),children:"Unable to load tasks. Please ensure the backend is running."}),e.jsx("p",{className:a("text-xs",t.text.tertiary),children:"Working in offline mode with cached data."})]})}):e.jsx(H,{items:N,height:"100%",itemHeight:90,renderItem:M,emptyMessage:"No tasks found."})})]})};export{de as CaseListTasks};
