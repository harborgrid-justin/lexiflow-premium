import{d as n,g as o}from"./dataService-75QCl8KS.js";import"./preload-helper-BXl3LOEh.js";import"./useQueryHooks-BdeOvP9e.js";import"./vendor-core-V-oW58GW.js";import"./vendor-misc-Dwkhvdtg.js";import"./vendor-charts-KZIdMATq.js";import"./type-mappings-DEPYyX4d.js";const a="workspaces",i="comments",c="shares",g={getAll:async()=>n.getAll(a),getById:async e=>n.get(a,e),add:async e=>{const t=e&&typeof e=="object"?e:{};return n.put(a,{...t,createdAt:new Date().toISOString(),members:Array.isArray(t.members)?t.members:[]})},update:async(e,t)=>{const r=await n.get(a,e);return n.put(a,{...r&&typeof r=="object"?r:{},...t&&typeof t=="object"?t:{}})},delete:async e=>n.delete(a,e),getWorkspaces:async e=>{const t=await n.getAll(a);return e?t.filter(r=>r.ownerId===e||r.members.includes(e)):t},createWorkspace:async e=>{const t={id:`workspace-${Date.now()}`,name:e.name||"New Workspace",description:e.description,ownerId:e.ownerId||"",members:e.members||[],createdAt:new Date().toISOString(),settings:e.settings||{visibility:"private"}};return await n.put(a,t),t},inviteUser:async(e,t)=>{await o(100);try{const r=await n.get(a,e);return r?(r.members.includes(t)||(r.members.push(t),await n.put(a,r)),console.log(`[CollaborationService] Invited user ${t} to workspace ${e}`),!0):!1}catch{return!1}},getComments:async e=>(await o(50),(await n.getAll(i)).filter(r=>r.resourceId===e).sort((r,s)=>new Date(r.createdAt).getTime()-new Date(s.createdAt).getTime())),addComment:async(e,t)=>{const r={id:`comment-${Date.now()}`,resourceId:e,resourceType:t.resourceType||"document",userId:t.userId||"",content:t.content||"",parentId:t.parentId,createdAt:new Date().toISOString(),mentions:t.mentions};return await n.put(i,r),r},shareResource:async(e,t,r)=>{await o(100);try{const s={id:`share-${Date.now()}`,resourceId:e,resourceType:r?.resourceType||"document",sharedWith:[t],permissions:r?.permissions||"view",sharedBy:"current-user",sharedAt:new Date().toISOString()};return await n.put(c,s),console.log(`[CollaborationService] Shared ${e} with ${t}`),!0}catch{return!1}}};export{g as CollaborationService};
