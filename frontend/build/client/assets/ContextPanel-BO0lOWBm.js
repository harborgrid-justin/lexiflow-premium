import{r as l,F as E,a$ as k,aj as D,V as F,j as t,ab as $,a_ as B,a1 as T,al as A}from"./vendor-core-V-oW58GW.js";import{B as M}from"./Button-CDQlLg6j.js";import{u as x,c as i}from"./useQueryHooks-Oyt-TMLP.js";import{u as P}from"./ThemeContext-OPG61qw5.js";import{D as p}from"./dataService-BWLMkXM4.js";import{u as R,a as _}from"./search.config-B6mvIgDA.js";import"./vendor-misc-Dwkhvdtg.js";import"./vendor-charts-KZIdMATq.js";import"./preload-helper-BXl3LOEh.js";import"./type-mappings-DEPYyX4d.js";const I=({caseId:c,onInsertFact:b})=>{const{theme:a}=P(),[h,v]=l.useState(""),[d,g]=l.useState("facts"),m=R(h,_),{data:n,isLoading:j}=x(["cases",c],async()=>p.cases.getById(c)),{data:f=[],isLoading:N}=x(["evidence",c],async()=>p.evidence.getByCaseId(c)),{data:y=[],isLoading:S}=x(["docket",c],async()=>p.docket.getByCaseId(c)),w=!1,u=l.useMemo(()=>{const e=[];return y.forEach(r=>{const s=r;e.push({id:s.id,content:`${s.title||s.description||"Docket Entry"} - Filed on ${s.dateFiled?new Date(s.dateFiled).toLocaleDateString():"N/A"}`,source:`Docket Entry #${s.sequenceNumber||s.id}`,category:"fact"})}),f.forEach(r=>{const s=r;e.push({id:String(s.id||""),content:String(s.description||s.title||"Evidence item"),source:`Exhibit ${s.exhibitNumber||s.id}`,category:"evidence"})}),n&&typeof n=="object"&&"parties"in n&&Array.isArray(n.parties)&&n.parties.forEach(r=>{const s=r;e.push({id:`party-${s.id||s.name}`,content:`${s.name} - ${s.role}`,source:"Party List",category:"witness"})}),n&&typeof n=="object"&&"description"in n&&n.description&&e.push({id:"legal-case-summary",content:String(n.description),source:"Case Summary",category:"legal"}),e},[y,f,n]),o=l.useMemo(()=>{if(!m)return u;const e=m.toLowerCase();return u.filter(r=>r.content.toLowerCase().includes(e)||r.source.toLowerCase().includes(e))},[u,m]),C=j||N||S||w,L=l.useMemo(()=>[{id:"facts",label:"Key Facts",icon:E,items:o.filter(e=>e.category==="fact")},{id:"evidence",label:"Evidence",icon:k,items:o.filter(e=>e.category==="evidence")},{id:"witnesses",label:"Witnesses",icon:D,items:o.filter(e=>e.category==="witness")},{id:"legal",label:"Legal Standards",icon:F,items:o.filter(e=>e.category==="legal")}],[o]);return C?t.jsx("div",{className:"flex items-center justify-center h-full p-4",children:t.jsxs("div",{className:"text-center",children:[t.jsx($,{className:"h-6 w-6 animate-spin text-blue-600 mx-auto mb-2"}),t.jsx("p",{className:i("text-xs",a.text.secondary),children:"Loading case context..."})]})}):t.jsxs("div",{className:"flex flex-col h-full",children:[t.jsxs("div",{className:i("p-4 border-b",a.border.default),children:[t.jsx("h3",{className:i("font-bold text-sm mb-3",a.text.primary),children:"Case Context"}),t.jsxs("div",{className:"relative",children:[t.jsx(B,{className:i("absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4",a.text.tertiary)}),t.jsx("input",{type:"text",placeholder:"Search facts...",value:h,onChange:e=>v(e.target.value),className:i("w-full pl-9 pr-3 py-2 text-sm rounded-md border",a.surface.input,a.border.default,a.text.primary,"focus:outline-none focus:ring-2 focus:ring-blue-500/20 focus:border-blue-500")})]})]}),t.jsx("div",{className:"flex-1 overflow-y-auto p-2",children:L.map(e=>t.jsxs("div",{className:"mb-2",children:[t.jsxs("button",{onClick:()=>g(d===e.id?null:e.id),className:i("w-full flex items-center justify-between p-2 rounded-md text-sm font-medium transition-colors",d===e.id?a.surface.active:"hover:bg-slate-100 dark:hover:bg-slate-800",a.text.primary),children:[t.jsxs("span",{className:"flex items-center gap-2",children:[t.jsx(e.icon,{className:"h-4 w-4 text-blue-600"}),e.label,t.jsx("span",{className:i("text-xs px-1.5 py-0.5 rounded",a.surface.highlight,a.text.secondary),children:e.items.length})]}),t.jsx(T,{className:i("h-4 w-4 transition-transform",d===e.id&&"rotate-90")})]}),d===e.id&&t.jsxs("div",{className:"mt-1 space-y-1 pl-2",children:[e.items.map(r=>t.jsxs("div",{className:i("p-2 rounded-md border text-xs group cursor-pointer transition-all",a.surface.default,a.border.subtle,"hover:border-blue-300 hover:shadow-sm"),children:[t.jsx("p",{className:i("mb-1 leading-relaxed",a.text.primary),children:r.content}),t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsx("span",{className:i("text-[10px]",a.text.tertiary),children:r.source}),t.jsx(M,{size:"sm",variant:"ghost",icon:A,onClick:()=>b(r.content),className:"opacity-0 group-hover:opacity-100 transition-opacity h-6 text-[10px]",children:"Insert"})]})]},r.id)),e.items.length===0&&t.jsx("p",{className:i("text-xs italic p-2",a.text.tertiary),children:"No items found."})]})]},e.id))})]})};export{I as ContextPanel,I as default};
