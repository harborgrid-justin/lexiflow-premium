import{d as r,g as o}from"./dataService-75QCl8KS.js";import"./preload-helper-BXl3LOEh.js";import"./useQueryHooks-BdeOvP9e.js";import"./vendor-core-V-oW58GW.js";import"./vendor-misc-Dwkhvdtg.js";import"./vendor-charts-KZIdMATq.js";import"./type-mappings-DEPYyX4d.js";const c="data_sources",S={getAll:async()=>r.getAll(c),getById:async t=>r.get(c,t),add:async t=>r.put(c,{...t&&typeof t=="object"?t:{},connected:!1,createdAt:new Date().toISOString()}),update:async(t,e)=>{const n=await r.get(c,t);return r.put(c,{...n&&typeof n=="object"?n:{},...e&&typeof e=="object"?e:{}})},delete:async t=>r.delete(c,t),getDataSources:async t=>{let e=await r.getAll(c);return t?.type&&(e=e.filter(n=>n.type===t.type)),t?.connected!==void 0&&(e=e.filter(n=>n.connected===t.connected)),e},connect:async t=>{await o(300);try{const e=await r.get(c,t);if(!e)throw new Error("Source not found");return await r.put(c,{...e,connected:!0,lastSync:new Date().toISOString()}),console.log(`[DataSourceService] Connected to ${e.name}`),!0}catch(e){return console.error("[DataSourceService] Connection failed:",e),!1}},disconnect:async t=>{await o(100);try{const e=await r.get(c,t);return e?(await r.put(c,{...e,connected:!1}),console.log(`[DataSourceService] Disconnected from ${e.name}`),!0):!1}catch{return!1}},sync:async(t,e)=>{await o(500);try{const n=await r.get(c,t);if(!n||!n.connected)throw new Error("Source not connected");return await r.put(c,{...n,lastSync:new Date().toISOString()}),console.log(`[DataSourceService] Synced ${n.name} (${e?.fullSync?"full":"incremental"})`),!0}catch(n){return console.error("[DataSourceService] Sync failed:",n),!1}},testConnection:async t=>{await o(200);try{return await r.get(c,t)?{connected:!0,latency:Math.floor(Math.random()*100)+20,version:"14.5"}:{connected:!1,error:"Source not found"}}catch(e){return{connected:!1,error:e instanceof Error?e.message:"Connection failed"}}}};export{S as DataSourceService};
