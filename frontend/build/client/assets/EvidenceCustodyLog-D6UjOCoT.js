import{r as l,j as e,a_ as h,b3 as p,ae as j}from"./vendor-core-V-oW58GW.js";import{B as x}from"./Button-CDQlLg6j.js";import{T as y,a as b,b as i,c as w,d as g,e as n}from"./Table-C_bcd1kC.js";import{u as T}from"./ThemeContext-OPG61qw5.js";import{u as C,c as r}from"./useQueryHooks-Oyt-TMLP.js";import{D as N}from"./dataService-BWLMkXM4.js";import"./vendor-misc-Dwkhvdtg.js";import"./vendor-charts-KZIdMATq.js";import"./preload-helper-BXl3LOEh.js";import"./type-mappings-DEPYyX4d.js";const $=()=>{const{theme:t}=T(),[o,u]=l.useState(""),{data:a}=C(["evidence","all"],()=>N.evidence.getAll()),d=l.useMemo(()=>a?Array.isArray(a)?a:typeof a=="object"&&"data"in a&&Array.isArray(a.data)?a.data:typeof a=="object"&&"items"in a&&Array.isArray(a.items)?a.items:(console.warn("[EvidenceCustodyLog] Data is not an array:",a),[]):[],[a]),m=l.useMemo(()=>d.flatMap(s=>(s.chainOfCustody||[]).map(c=>({...c,itemId:s.id,itemTitle:s.title,caseId:s.caseId}))).sort((s,c)=>new Date(c.date).getTime()-new Date(s.date).getTime()),[d]),f=l.useMemo(()=>m.filter(s=>s.itemTitle.toLowerCase().includes(o.toLowerCase())||s.actor.toLowerCase().includes(o.toLowerCase())||s.action.toLowerCase().includes(o.toLowerCase())),[m,o]);return e.jsxs("div",{className:"space-y-4 animate-fade-in",children:[e.jsxs("div",{className:r("flex flex-col md:flex-row justify-between items-center gap-4 p-4 rounded-lg border shadow-sm",t.surface.default,t.border.default),children:[e.jsxs("div",{children:[e.jsx("h3",{className:r("font-bold",t.text.primary),children:"Master Chain of Custody"}),e.jsx("p",{className:r("text-sm",t.text.secondary),children:"Audit trail for all evidence transfers across the firm."})]}),e.jsxs("div",{className:"flex gap-2 w-full md:w-auto",children:[e.jsxs("div",{className:"relative flex-1 md:w-64",children:[e.jsx(h,{className:r("absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4",t.text.tertiary)}),e.jsx("input",{className:r("w-full pl-9 pr-4 py-2 border rounded-md text-sm outline-none focus:ring-2 focus:ring-blue-500",t.surface.highlight,t.border.default,t.text.primary),placeholder:"Search logs...",value:o,onChange:s=>u(s.target.value)})]}),e.jsx(x,{variant:"secondary",icon:p,children:"Filter"}),e.jsx(x,{variant:"outline",icon:j,children:"Export"})]})]}),e.jsxs(y,{children:[e.jsxs(b,{children:[e.jsx(i,{children:"Date / Time"}),e.jsx(i,{children:"Evidence Item"}),e.jsx(i,{children:"Action"}),e.jsx(i,{children:"Actor"}),e.jsx(i,{children:"Case Ref"}),e.jsx(i,{children:"Notes"})]}),e.jsx(w,{children:f.map((s,c)=>e.jsxs(g,{children:[e.jsx(n,{className:r("font-mono text-xs",t.text.secondary),children:s.date}),e.jsx(n,{className:r("font-medium",t.text.primary),children:s.itemTitle}),e.jsx(n,{children:e.jsx("span",{className:`px-2 py-1 rounded text-xs font-bold ${s.action.includes("Collected")?r(t.status.success.bg,t.status.success.text):s.action.includes("Transfer")?r(t.status.info.bg,t.status.info.text):r(t.surface.highlight,t.text.secondary)}`,children:s.action})}),e.jsx(n,{className:t.text.primary,children:s.actor}),e.jsx(n,{className:"text-xs text-blue-600 font-mono",children:s.caseId}),e.jsx(n,{className:r("text-xs italic truncate max-w-xs",t.text.tertiary),children:s.notes||"-"})]},`${s.id}-${c}`))})]})]})};export{$ as EvidenceCustodyLog};
