import{l as d,j as e,aC as u,G as g,T as y,ad as j,A as f}from"./vendor-core-V-oW58GW.js";import{C as m}from"./Card-CDOiP5UM.js";import{B as b}from"./Button-CDQlLg6j.js";import{M as o}from"./MetricCard-BH_9X7pi.js";import{u as v}from"./ThemeContext-OPG61qw5.js";import{u as N,c as r}from"./useQueryHooks-Oyt-TMLP.js";import{D as A}from"./dataService-BWLMkXM4.js";import{q as C}from"./queryKeys-BBVgMz36.js";import{R as D,P as T,c as w,b as E,T as R,L as k}from"./vendor-charts-KZIdMATq.js";import"./vendor-misc-Dwkhvdtg.js";import"./preload-helper-BXl3LOEh.js";import"./type-mappings-DEPYyX4d.js";const O=({onNavigate:x})=>{const{theme:t,mode:h}=v(),{data:s}=N(C.evidence.all(),()=>A.evidence.getAll()),l=d.useMemo(()=>s?Array.isArray(s)?s:typeof s=="object"&&"data"in s&&Array.isArray(s.data)?s.data:typeof s=="object"&&"items"in s&&Array.isArray(s.items)?s.items:(console.warn("[EvidenceDashboard] Data is not an array:",s),[]):[],[s]),i=d.useMemo(()=>({total:l.length,digital:l.filter(a=>a.type==="Digital").length,physical:l.filter(a=>a.type==="Physical").length,challenged:l.filter(a=>a.admissibility==="Challenged").length}),[l]),p=d.useMemo(()=>l.flatMap(a=>a.chainOfCustody.map(c=>({...c,itemTitle:a.title,itemId:a.id}))).sort((a,c)=>new Date(c.date).getTime()-new Date(a.date).getTime()).slice(0,5),[l]),n=[{name:"Physical",value:i.physical,color:t.chart.colors.warning},{name:"Digital",value:i.digital,color:t.chart.colors.primary},{name:"Document",value:i.total-i.digital-i.physical,color:t.chart.colors.neutral}];return e.jsxs("div",{className:"space-y-6 animate-fade-in",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsx(o,{label:"Total Evidence",value:i.total,icon:u,className:"border-l-4 border-l-blue-600"}),e.jsx(o,{label:"Digital Assets",value:i.digital,icon:g,className:"border-l-4 border-l-purple-600"}),e.jsx(o,{label:"Admissibility Risk",value:i.challenged,icon:y,className:"border-l-4 border-l-amber-500"}),e.jsx(o,{label:"Chain Integrity",value:100,icon:j,className:"border-l-4 border-l-emerald-600"})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsx(m,{title:"Evidence Type Distribution",children:e.jsx(D,{width:"100%",height:256,children:e.jsxs(T,{children:[e.jsx(w,{data:n,cx:"50%",cy:"50%",innerRadius:60,outerRadius:80,paddingAngle:5,dataKey:"value",children:n.map((a,c)=>e.jsx(E,{fill:a.color},`cell-${c}`))}),e.jsx(R,{}),e.jsx(k,{verticalAlign:"bottom",height:36})]})})}),e.jsx(m,{title:"Recent Custody Transfers",children:e.jsxs("div",{className:"space-y-4",children:[p.map((a,c)=>e.jsxs("div",{className:r("flex items-start pb-3 border-b last:border-0 last:pb-0",t.border.default),children:[e.jsx("div",{className:r("p-2 rounded-full mr-3 shrink-0",t.primary.light),children:e.jsx(f,{className:r("h-4 w-4",t.primary.text)})}),e.jsxs("div",{children:[e.jsx("p",{className:r("text-sm font-medium",t.text.primary),children:a.action}),e.jsxs("p",{className:r("text-xs",t.text.secondary),children:[e.jsx("span",{className:r("font-semibold",t.text.primary),children:a.itemTitle})," â€¢ ",a.actor]}),e.jsx("p",{className:r("text-[10px] mt-0.5",t.text.tertiary),children:a.date})]})]},c)),e.jsx("div",{className:"pt-2",children:e.jsx(b,{variant:"ghost",size:"sm",className:r("w-full",t.primary.text),onClick:()=>x("custody"),children:"View Full Chain of Custody Log"})})]})})]}),e.jsxs("div",{className:r("rounded-lg p-6 flex flex-col md:flex-row justify-between items-center shadow-lg",h==="dark"?"bg-slate-800":"bg-slate-900 text-white"),children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-bold text-lg mb-1",children:"Secure Evidence Storage"}),e.jsx("p",{className:"opacity-80 text-sm",children:"All digital assets are encrypted at rest (AES-256) and anchored to the Ethereum blockchain."})]}),e.jsxs("div",{className:"flex gap-4 mt-4 md:mt-0",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-xs opacity-60 uppercase",children:"Storage Used"}),e.jsx("p",{className:"text-xl font-mono font-bold text-emerald-400",children:"4.2 TB"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-xs opacity-60 uppercase",children:"Retention Policy"}),e.jsx("p",{className:"text-xl font-mono font-bold text-blue-400",children:"7 Years"})]})]})]})]})};export{O as EvidenceDashboard};
