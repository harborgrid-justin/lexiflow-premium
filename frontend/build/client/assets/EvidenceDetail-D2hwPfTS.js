import{r as f,j as e,aG as U,al as O,v as E,V as B,bg as _,by as y,cg as M,ad as A,k as z,m as D,b4 as G,A as Q,b9 as q,ci as T,F as $,bd as J,aV as K,aN as X,bi as Y,aT as W}from"./vendor-core-V-oW58GW.js";import{B as m}from"./Button-CDQlLg6j.js";import{T as Z}from"./Tabs-7xONCRTX.js";import{B as L}from"./Badge-bF-hTHJZ.js";import{C as h}from"./Card-CDOiP5UM.js";import{M as P}from"./Modal-Rns91qFF.js";import{R as I}from"./TaskCreationModal-D5xiqN6m.js";import{c as t,d as F,q as w}from"./useQueryHooks-Oyt-TMLP.js";import{D as k,C as ee}from"./dataService-BWLMkXM4.js";import{u as v}from"./ThemeContext-OPG61qw5.js";import"./SyncContext-B5_p5hCg.js";import{u as H}from"./useModalState-Cst_3NmK.js";import{I as S}from"./Input-Dmln04Yk.js";import{T as se}from"./TextArea-DrtcCAyn.js";import{S as te,n as ie,E as ae,g as re}from"./case-detail-q84K17Pa.js";import{u as V}from"./useNotify-DdRjm5G5.js";import{getTodayString as ne}from"./dateUtils-rLIRMrtk.js";import{e as p}from"./queryKeys-Dex4MaB7.js";import{v as ce}from"./evidenceSchemas-BfC4WNg8.js";import{d as R}from"./type-mappings-DEPYyX4d.js";import{G as le}from"./geminiService-_CYFbtO8.js";import"./vendor-misc-Dwkhvdtg.js";import"./vendor-charts-KZIdMATq.js";import"./queryKeys-BBVgMz36.js";import"./search.config-B6mvIgDA.js";import"./UserAvatar-BPVf-Spq.js";import"./preload-helper-BXl3LOEh.js";import"./schemas-B2_dy3tf.js";import"./VirtualList-r2WXvtCD.js";import"./AppShell-Cug-APl3.js";import"./tabs.config-D59pmwVC.js";import"./PageHeader-C4TFe3Td.js";import"./formatters-stMuSkc6.js";import"./Table-C_bcd1kC.js";import"./EmptyState-7A4cJUVU.js";import"./MetricCard-BH_9X7pi.js";import"./useSessionStorage-D_292xEY.js";import"./ErrorState-WL3az5ve.js";import"./ConfirmDialog--jvbqDAw.js";import"./Kanban-BI78PbzY.js";import"./FilterPanel-BteidCPx.js";import"./AdaptiveLoader-D5wOoiN1.js";import"./useToggle-CjLp2PQ4.js";import"./sanitize-k_Tw3ej1.js";import"./scheduler-BERajRBE.js";import"./RouteErrorBoundary-Nha8Il06.js";import"./meta-utils-lVs9HXG9.js";const de=({selectedItem:i})=>{const{theme:s}=v(),a=H(),[c,l]=f.useState(i.linkedRules||["FRE 401","FRE 901"]);return e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsx(P,{isOpen:a.isOpen,onClose:a.close,title:"Manage Applicable Rules",children:e.jsxs("div",{className:"p-6 space-y-4",children:[e.jsx(I,{selectedRules:c,onRulesChange:l}),e.jsx("div",{className:t("flex justify-end pt-4 border-t mt-4",s.border.default),children:e.jsx(m,{onClick:a.close,children:"Done"})})]})}),e.jsxs(h,{title:"Admissibility Assessment",children:[e.jsxs("div",{className:t("border rounded-lg p-4 mb-6 flex items-start",s.status.warning.bg,s.status.warning.border),children:[e.jsx(U,{className:t("h-5 w-5 mr-3 mt-0.5 shrink-0",s.status.warning.text)}),e.jsxs("div",{children:[e.jsxs("h5",{className:t("text-sm font-bold",s.status.warning.text),children:["Current Status: ",i.admissibility]}),e.jsx("p",{className:t("text-xs mt-1",s.status.warning.text),children:i.admissibility==="Challenged"?"Opposing counsel has filed a Motion in Limine based on FRE 901 (Authentication).":"Standard foundation required. No current challenges."})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h4",{className:t("font-bold text-sm",s.text.primary),children:"Rules of Evidence Checklist"}),e.jsxs("button",{onClick:a.open,className:t("text-xs hover:underline flex items-center",s.primary.text),children:[e.jsx(O,{className:"h-3 w-3 mr-1"})," Add Rule"]})]}),e.jsxs("div",{className:"space-y-2",children:[c.map(n=>e.jsxs("div",{className:t("flex items-center justify-between p-3 border rounded",s.surface.highlight,s.border.default),children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:t("w-5 h-5 rounded-full border-2 flex items-center justify-center mr-3",s.status.success.border),children:e.jsx(E,{className:t("h-3 w-3",s.status.success.text)})}),e.jsx("span",{className:t("text-sm font-medium",s.text.primary),children:n})]}),e.jsx(L,{variant:n.includes("901")?"warning":"success",children:n.includes("901")?"Pending":"Pass"})]},n)),c.length===0&&e.jsx("p",{className:t("text-xs italic",s.text.tertiary),children:"No rules linked."})]})]})]}),e.jsx(h,{title:"Motions & Challenges",children:e.jsxs("div",{className:t("text-center py-8",s.text.tertiary),children:[e.jsx(B,{className:"h-12 w-12 mx-auto mb-3 opacity-20"}),e.jsx("p",{children:"No active motions filed against this evidence ID."}),e.jsx(m,{variant:"outline",size:"sm",className:"mt-4",children:"Log Anticipated Challenge"})]})})]})},oe=({selectedItem:i,onCustodyUpdate:s})=>{const{theme:a}=v(),c=V(),l=H(),[n,d]=f.useState({date:ne(),action:R.TRANSFER_TO_STORAGE,actor:"Current User"}),[o,g]=f.useState(!1),{mutate:j,isLoading:x}=F(async r=>{const u={...r.item,chainOfCustody:[r.event,...r.item.chainOfCustody]};await k.evidence.update(r.item.id,u);const b=i.chainOfCustody.length>0?i.chainOfCustody[0].curr_hash||"0":"0000000000000000000000000000000000000000000000000000000000000000",N=await ee.createEntry({timestamp:r.event.date,userId:"current-user",user:r.event.actor,action:`CUSTODY_UPDATE_${r.event.action.toUpperCase().replace(/\s/g,"_")}`,resource:`Evidence/${i.id}`,ip:"127.0.0.1",previousValue:i.chainOfCustody[0]?.id||"",newValue:r.event.id},b);return{updatedItem:u,chainedLog:N}},{onMutate:async r=>{await w.cancelQueries(p.evidence.detail(r.item.id));const u=w.getQueryState(p.evidence.all)?.data;return w.setQueryData(p.evidence.all,b=>b?.map(N=>N.id===r.item.id?{...N,chainOfCustody:[r.event,...N.chainOfCustody]}:N)||[]),{previousEvidence:u}},onSuccess:(r,u)=>{if(s){const b={...u.event,hash:r.chainedLog.hash};s(b)}c.success("Custody log updated and immutably recorded."),l.close(),d({date:new Date().toISOString().split("T")[0],action:R.TRANSFER_TO_STORAGE,actor:"Current User"}),g(!1)},onError:(r,u,b)=>{b?.previousEvidence&&w.setQueryData(p.evidence.all,b.previousEvidence),c.error("Failed to update custody log. Changes rolled back.")},invalidateKeys:[p.evidence.all,p.evidence.detail(i.id),p.evidence.custody(i.id)]}),C=()=>{if(!o){c.warning("Digital signature is required.");return}if(!n.action||!n.actor)return;const r={id:`cc-${Date.now()}`,date:n.date||new Date().toISOString(),action:n.action,actor:n.actor,notes:n.notes},u=ce(r);if(!u.success){c.error(`Validation failed: ${u.error.errors[0].message}`);return}j({item:i,event:r})};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:t("p-4 rounded-lg border flex justify-between items-center",a.surface.default,a.border.default),children:[e.jsxs("div",{children:[e.jsx("h3",{className:t("font-bold",a.text.primary),children:"Chain of Custody Log"}),e.jsx("p",{className:t("text-sm",a.text.secondary),children:"Immutable audit trail of evidence handling."})]}),e.jsx(m,{variant:"primary",icon:O,onClick:l.open,children:"Log New Event"})]}),e.jsxs("div",{className:t("rounded-lg border shadow-sm overflow-hidden",a.surface.default,a.border.default),children:[e.jsxs("div",{className:t("p-4 border-b font-bold text-xs uppercase tracking-wider",a.surface.highlight,a.border.default,a.text.secondary),children:["Event History (",i.chainOfCustody.length,")"]}),e.jsxs("div",{className:"divide-y max-h-96 overflow-y-auto custom-scrollbar",children:[i.chainOfCustody.length===0&&e.jsx("div",{className:t("text-center py-8 italic",a.text.tertiary),children:"No custody events recorded."}),i.chainOfCustody.map(r=>e.jsxs("div",{className:t("p-4 flex items-start gap-4",a.surface.default,a.border.default),children:[e.jsx("div",{className:t("p-2 rounded-full shrink-0",a.primary.light),children:e.jsx(_,{className:t("h-5 w-5",a.primary.text)})}),e.jsxs("div",{children:[e.jsx("p",{className:t("text-sm font-bold",a.text.primary),children:r.action}),e.jsxs("p",{className:t("text-xs text-slate-500 mt-1"),children:[e.jsx("span",{className:"font-medium",children:r.actor})," on ",r.date]}),r.notes&&e.jsx("p",{className:t("text-xs italic mt-2",a.text.secondary),children:r.notes}),r.hash?e.jsxs("div",{className:t("mt-2 p-2 rounded text-[10px] font-mono border break-all",a.surface.highlight,a.border.default,a.text.secondary),children:[e.jsx(y,{className:t("h-3 w-3 inline mr-1",a.text.tertiary)}),"Hash: ",String(r.hash).substring(0,12),"..."]}):null]})]},r.id))]})]}),e.jsx(P,{isOpen:l.isOpen,onClose:l.close,title:"Log Custody Event",size:"sm",children:e.jsxs("div",{className:"p-6 space-y-4",children:[e.jsx(S,{label:"Date of Event",type:"date",value:n.date,onChange:r=>d({...n,date:r.target.value})}),e.jsx(S,{label:"Action Performed",value:n.action||"",onChange:r=>d({...n,action:r.target.value}),placeholder:"e.g. Transferred to Lab, Returned to Client"}),e.jsx(S,{label:"Actor / Recorder",value:n.actor||"",onChange:r=>d({...n,actor:r.target.value}),placeholder:"Name of person performing action"}),e.jsx(se,{label:"Notes (Optional)",value:n.notes||"",onChange:r=>d({...n,notes:r.target.value}),rows:3,placeholder:"Additional details regarding the transfer/event..."}),e.jsx("div",{className:t("p-4 rounded-lg border flex items-center justify-between",a.status.warning.bg,a.status.warning.border),children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(M,{className:t("h-5 w-5 mt-0.5 shrink-0",a.status.warning.text)}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-bold text-sm text-amber-800",children:"Digital Signature Required"}),e.jsx("p",{className:"text-xs text-amber-700 mt-1",children:"All custody changes must be digitally signed to ensure immutability."})]})]})}),e.jsx(te,{value:o,onChange:g,isSigning:x,label:"Digital Signature",subtext:"I certify this event is accurate and occurred as logged."}),e.jsxs("div",{className:t("pt-4 flex justify-end gap-3 border-t mt-4",a.border.default),children:[e.jsx(m,{variant:"secondary",onClick:l.close,children:"Cancel"}),e.jsx(m,{variant:"primary",onClick:C,disabled:x||!o,children:x?"Logging...":"Save Event"})]})]})})]})};class xe{queue=[];processing=!1;concurrency=2;activeJobs=0;async add(s){this.queue.push(s),this.processing||await this.processQueue()}async processQueue(){for(this.processing=!0;this.queue.length>0||this.activeJobs>0;){if(this.activeJobs>=this.concurrency||this.queue.length===0){await new Promise(a=>setTimeout(a,100));continue}const s=this.queue.shift();s&&(this.activeJobs++,this.executeJob(s).finally(()=>{this.activeJobs--}))}this.processing=!1}async executeJob(s){try{await new Promise(l=>setTimeout(l,ie+500));const a=Math.floor(Math.random()*1e3),c={verified:!0,timestamp:new Date().toISOString(),blockHeight:"18452"+a};s.resolve(c)}catch(a){s.reject(a)}}}const me=new xe,he=({selectedItem:i})=>{const{theme:s,mode:a}=v(),[c,l]=f.useState("idle"),[n,d]=f.useState(null),o=f.useRef(!1);f.useEffect(()=>{(async()=>{const x=w.getQueryState(p.evidence.verification(i.id));x?.data&&x.data.expiresAt>Date.now()&&(d(x.data.data),l("verified"))})()},[i.id]);const g=async()=>{if(!o.current){o.current=!0,l("verifying");try{const j=await new Promise((x,C)=>{me.add({evidenceId:i.id,hash:i.blockchainHash||"",resolve:x,reject:C})});d(j),l("verified"),w.setQueryData(p.evidence.verification(i.id),{data:j,expiresAt:Date.now()+864e5})}catch{l("failed")}finally{o.current=!1}}};return e.jsxs("div",{className:"space-y-6",children:[e.jsx(h,{title:"Digital Forensics Report",children:e.jsxs("div",{className:t("p-4 font-mono text-xs rounded-md overflow-x-auto shadow-inner",a==="dark"?"bg-slate-800 text-slate-300":"bg-slate-900 text-slate-200"),children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"opacity-50 mb-1",children:"FILE ATTRIBUTES"}),e.jsxs("p",{children:["File: ",e.jsx("span",{className:"text-blue-400",children:i.title})]}),e.jsxs("p",{children:["Size: ",i.fileSize||"2,405 KB"]}),e.jsxs("p",{children:["Type: ",i.fileType||"application/pdf"]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"opacity-50 mb-1",children:"CRYPTOGRAPHIC HASHES"}),e.jsx("p",{children:"MD5: 5d41402abc4b2a76b9719d911017c592"}),e.jsx("p",{children:"SHA1: 7b502c3a1f48bb8615d947119951b689a9416597"}),e.jsxs("p",{children:["SHA256: ",i.blockchainHash?i.blockchainHash.substring(0,32)+"...":"Pending"]})]})]}),e.jsxs("div",{className:"mt-4 pt-4 border-t border-white/10",children:[e.jsx("p",{className:"opacity-50 mb-1",children:"METADATA EXTRACTION"}),e.jsx("p",{children:"-- Author: h.smith@techcorp.com"}),e.jsx("p",{children:"-- Created: 2023-11-14 14:30:22 UTC"}),e.jsx("p",{children:"-- Modified: 2023-11-15 09:12:00 UTC"}),e.jsx("p",{children:"-- Software: Microsoft Word for Office 365"})]})]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsx(h,{title:"Blockchain Anchor Verification",children:e.jsxs("div",{className:"flex flex-col items-center justify-center py-6",children:[c==="idle"&&e.jsxs(e.Fragment,{children:[e.jsx(A,{className:t("h-16 w-16 mb-4",s.text.tertiary)}),e.jsx("p",{className:t("text-sm mb-4 text-center",s.text.secondary),children:"Verify this file's integrity against the public ledger."}),e.jsx(m,{onClick:g,icon:y,children:"Verify Integrity"})]}),c==="verifying"&&e.jsxs(e.Fragment,{children:[e.jsx(z,{className:"h-16 w-16 text-blue-500 animate-spin mb-4"}),e.jsx("p",{className:"text-blue-600 font-bold text-sm",children:"Querying Ethereum Mainnet..."})]}),c==="verified"&&n&&e.jsxs("div",{className:"w-full",children:[e.jsxs("div",{className:"flex flex-col items-center mb-6",children:[e.jsx(E,{className:"h-16 w-16 text-green-500 mb-2"}),e.jsx("h3",{className:t("text-xl font-bold",s.text.primary),children:"INTEGRITY CONFIRMED"}),e.jsx("p",{className:t("text-sm",s.text.secondary),children:"Hash Match Found"})]}),e.jsxs("div",{className:t("border rounded p-4 text-sm",s.status.success.bg,s.status.success.border),children:[e.jsxs("div",{className:"flex justify-between mb-2",children:[e.jsx("span",{className:t("font-bold",s.status.success.text),children:"Block Height:"}),e.jsx("span",{className:t("font-mono",s.status.success.text),children:n.blockHeight||"18452XXX"})]}),e.jsxs("div",{className:"flex justify-between mb-2",children:[e.jsx("span",{className:t("font-bold",s.status.success.text),children:"Timestamp:"}),e.jsx("span",{className:t("font-mono",s.status.success.text),children:new Date(n.timestamp).toLocaleString()})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:t("font-bold",s.status.success.text),children:"Network:"}),e.jsx("span",{className:t("font-mono",s.status.success.text),children:"ETH Mainnet"})]})]}),e.jsx("div",{className:"mt-4 text-center",children:e.jsx(m,{variant:"outline",size:"sm",onClick:()=>l("idle"),children:"Run Again"})})]}),c==="failed"&&e.jsxs("div",{className:"flex flex-col items-center text-red-600",children:[e.jsx(M,{className:"h-16 w-16 mb-4"}),e.jsx("p",{className:"font-bold",children:"Verification Failed"}),e.jsx("p",{className:"text-sm mb-4",children:"Hash mismatch or network error."}),e.jsx(m,{variant:"outline",onClick:()=>l("idle"),children:"Retry"})]})]})}),e.jsx(h,{title:"Custody Certification",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-start",children:[e.jsx("div",{className:"bg-blue-100 p-2 rounded-full mr-3",children:e.jsx(A,{className:"h-5 w-5 text-blue-600"})}),e.jsxs("div",{children:[e.jsx("h4",{className:t("font-bold text-sm",s.text.primary),children:"Chain of Custody Intact"}),e.jsx("p",{className:t("text-xs mt-1",s.text.secondary),children:"No gaps detected in custody logs since ingestion."})]})]}),e.jsxs("div",{className:"flex items-start",children:[e.jsx("div",{className:"bg-purple-100 p-2 rounded-full mr-3",children:e.jsx(y,{className:"h-5 w-5 text-purple-600"})}),e.jsxs("div",{children:[e.jsx("h4",{className:t("font-bold text-sm",s.text.primary),children:"UUID Tracking Active"}),e.jsxs("p",{className:t("text-xs mt-1",s.text.secondary),children:["Asset ID: ",e.jsx("span",{className:t("font-mono px-1 rounded",s.surface.highlight),children:i.trackingUuid})]})]})]}),e.jsx("div",{className:t("pt-4 mt-4 border-t",s.border.default),children:e.jsx(m,{variant:"secondary",className:"w-full",onClick:()=>k.evidence.generateReport(i.id),children:"Generate Forensic Report"})})]})})]})]})},ue=({selectedItem:i})=>{const{theme:s}=v(),[a,c]=f.useState(null),[l,n]=f.useState(!1),d=async()=>{n(!0);const o=await le.analyzeDocument(i.description);c(o.summary),n(!1)};return e.jsx(h,{className:"lg:col-span-2",title:"Evidence Particulars",children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsx("label",{className:t("block text-xs font-semibold uppercase",s.text.secondary),children:"Description"}),e.jsxs("button",{onClick:d,disabled:l,className:t("text-xs flex items-center px-2 py-1 rounded transition-colors","text-purple-600 hover:bg-purple-50"),children:[l?e.jsx("span",{className:"animate-spin mr-1",children:"â³"}):e.jsx(D,{className:"h-3 w-3 mr-1"}),"AI Analyze"]})]}),e.jsx("p",{className:t("p-4 rounded-md border leading-relaxed text-sm",s.surface.highlight,s.border.default,s.text.primary),children:i.description}),a&&e.jsxs("div",{className:"mt-4 p-4 bg-purple-50 border border-purple-100 rounded-md animate-fade-in",children:[e.jsxs("h5",{className:"text-xs font-bold text-purple-700 mb-1 flex items-center",children:[e.jsx(D,{className:"h-3 w-3 mr-1"})," AI Summary"]}),e.jsx("p",{className:t("text-sm",s.text.primary),children:a})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:t("block text-xs font-semibold uppercase mb-1",s.text.secondary),children:"Item Type"}),e.jsxs("div",{className:t("flex items-center text-sm font-medium",s.text.primary),children:[e.jsx(ae,{type:i.type,className:"h-5 w-5 mr-2"})," ",i.type]})]}),e.jsxs("div",{children:[e.jsx("label",{className:t("block text-xs font-semibold uppercase mb-1",s.text.secondary),children:"Current Status"}),e.jsx(L,{variant:"info",children:"Secure Storage"})]}),e.jsxs("div",{children:[e.jsx("label",{className:t("block text-xs font-semibold uppercase mb-1",s.text.secondary),children:"Original Custodian"}),e.jsxs("div",{className:t("flex items-center text-sm",s.text.primary),children:[e.jsx(G,{className:t("h-4 w-4 mr-2",s.text.tertiary)})," ",i.custodian]})]}),e.jsxs("div",{children:[e.jsx("label",{className:t("block text-xs font-semibold uppercase mb-1",s.text.secondary),children:"Collection Date"}),e.jsx("div",{className:t("text-sm",s.text.primary),children:i.collectionDate})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx("label",{className:t("block text-xs font-semibold uppercase mb-2",s.text.secondary),children:"Blockchain Verification"}),e.jsxs("div",{className:"flex items-center p-3 bg-slate-900 rounded-md text-white font-mono text-xs",children:[e.jsx(y,{className:"h-4 w-4 text-green-400 mr-3 shrink-0"}),e.jsx("span",{className:"truncate",children:i.blockchainHash||"0x7f83b1657ff1fc53b92dc18148a1d65dfc2d4b1fa3d677284addd200126d9069"})]}),e.jsx("p",{className:t("text-[10px] mt-1",s.text.tertiary),children:"Immutable record anchored on-chain. Last verified: 2 mins ago."})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:t("block text-xs font-semibold uppercase mb-2",s.text.secondary),children:"Tags & Metadata"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:i.tags.map(o=>e.jsxs("span",{className:t("px-2 py-1 rounded text-xs border flex items-center",s.surface.highlight,s.border.default,s.text.secondary),children:[e.jsx(Q,{className:t("h-3 w-3 mr-1 opacity-50",s.text.tertiary)})," ",o]},o))})]})]})})},pe=({location:i})=>{const{theme:s}=v();return e.jsxs(h,{title:"Current Location",children:[e.jsxs("div",{className:"flex flex-col items-center text-center p-4",children:[e.jsx("div",{className:t("h-16 w-16 rounded-full flex items-center justify-center mb-4",s.primary.light),children:e.jsx(q,{className:t("h-8 w-8",s.primary.text)})}),e.jsx("h3",{className:t("font-bold",s.text.primary),children:i}),e.jsx("p",{className:t("text-xs mt-1",s.text.secondary),children:"Last Verified: Today, 09:00 AM"})]}),e.jsx("div",{className:t("border-t pt-4 mt-4",s.border.subtle),children:e.jsx(m,{variant:"outline",size:"sm",className:"w-full",children:"Request Transfer"})})]})},fe=()=>{const{theme:i}=v();return e.jsxs(h,{title:"FRCP 26(a) Status",children:[e.jsxs("div",{className:"flex items-center mb-4",children:[e.jsx(E,{className:t("h-5 w-5 mr-2",i.status.success.text)}),e.jsx("span",{className:t("text-sm font-medium",i.text.primary),children:"Disclosed to Opposing Counsel"})]}),e.jsx("div",{className:t("text-xs p-3 rounded border",i.surface.highlight,i.text.secondary,i.border.default),children:"Included in Initial Disclosures Packet v2 sent on 2024-02-01. Bates Range: 00145-00152."})]})},je=({selectedItem:i})=>e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsx(ue,{selectedItem:i}),e.jsxs("div",{className:"space-y-6",children:[e.jsx(pe,{location:i.location}),e.jsx(fe,{})]})]}),be=({selectedItem:i})=>{const{theme:s}=v();return e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsx(h,{title:"Parsed Document Structure",children:e.jsxs("div",{className:"space-y-4",children:[e.jsx("p",{className:t("text-sm",s.text.secondary),children:"This document has been parsed and split into individual immutable chunks. Each chunk is hashed and tracked independently."}),e.jsx("div",{className:"space-y-3",children:i.chunks&&i.chunks.length>0?i.chunks.map((a,c)=>e.jsxs("div",{className:t("flex flex-col p-3 border rounded-lg transition-colors group",s.surface.default,s.border.default,`hover:${s.surface.highlight}`),children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:t("p-2 rounded mr-3",s.primary.light),children:e.jsx(T,{className:t("h-4 w-4",s.primary.text)})}),e.jsxs("div",{children:[e.jsxs("p",{className:t("font-bold text-sm",s.text.primary),children:["Page ",a.pageNumber]}),e.jsxs("p",{className:t("text-[10px] font-mono",s.text.tertiary),children:["ID: ",a.id]})]})]}),e.jsx(m,{size:"sm",variant:"ghost",className:"text-xs",children:"View Content"})]}),e.jsxs("div",{className:t("p-2 rounded border text-xs font-mono flex items-center",s.surface.highlight,s.border.default,s.text.secondary),children:[e.jsx(y,{className:t("h-3 w-3 mr-2",s.text.tertiary)}),"Hash: ",a.hash]}),e.jsxs("div",{className:t("mt-2 text-xs italic line-clamp-2 pl-2 border-l-2",s.text.secondary,s.border.default),children:['"',a.contentPreview,'"']})]},a.id||c)):e.jsxs("div",{className:t("text-center py-8 border-2 border-dashed rounded-lg",s.border.default),children:[e.jsx($,{className:t("h-8 w-8 mx-auto mb-2",s.text.tertiary)}),e.jsx("p",{className:t("text-sm",s.text.secondary),children:"No structural chunks available for this file type."})]})})]})}),e.jsxs("div",{className:"space-y-6",children:[e.jsx(h,{title:"Lifecycle Tracking",children:e.jsxs("div",{className:t("relative pl-6 border-l-2 ml-4 space-y-8 py-2",s.border.default),children:[e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:t("absolute -left-[33px] h-6 w-6 rounded-full border-4 border-transparent flex items-center justify-center",s.primary.DEFAULT),children:e.jsx("div",{className:"h-2 w-2 bg-white rounded-full"})}),e.jsx("h4",{className:t("font-bold text-sm",s.text.primary),children:"Ingestion & Hashing"}),e.jsx("p",{className:t("text-xs mt-1",s.text.secondary),children:"Master file uploaded and SHA-256 hash generated."}),e.jsxs("div",{className:t("mt-2 p-2 rounded text-[10px] font-mono border break-all",s.surface.highlight,s.border.default,s.text.secondary),children:["UUID: ",i.trackingUuid]})]}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute -left-[33px] bg-indigo-500 h-6 w-6 rounded-full border-4 border-transparent flex items-center justify-center",children:e.jsx(T,{className:"h-3 w-3 text-white"})}),e.jsx("h4",{className:t("font-bold text-sm",s.text.primary),children:"Parsing & Splitting"}),e.jsxs("p",{className:t("text-xs mt-1",s.text.secondary),children:["File split into ",i.chunks?.length||0," logical units for granular analysis."]})]}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute -left-[33px] bg-emerald-500 h-6 w-6 rounded-full border-4 border-transparent flex items-center justify-center",children:e.jsx(y,{className:"h-3 w-3 text-white"})}),e.jsx("h4",{className:t("font-bold text-sm",s.text.primary),children:"Blockchain Anchoring"}),e.jsx("p",{className:t("text-xs mt-1",s.text.secondary),children:"All chunk hashes committed to immutable ledger."})]})]})}),e.jsx(h,{title:"Integrity Check",children:e.jsxs("div",{className:t("p-4 border rounded-lg flex items-center justify-between",s.status.success.bg,s.status.success.border),children:[e.jsxs("div",{children:[e.jsx("span",{className:t("block text-sm font-bold",s.status.success.text),children:"Structure Verified"}),e.jsx("span",{className:t("text-xs",s.status.success.text),children:"All chunks match master parent hash."})]}),e.jsx("div",{className:"h-8 w-8 bg-white/20 rounded-full flex items-center justify-center",children:e.jsx(y,{className:t("h-4 w-4",s.status.success.text)})})]})})]})]})},ms=({selectedItem:i,handleBack:s,activeTab:a,setActiveTab:c,onNavigateToCase:l,onCustodyUpdate:n})=>{const{theme:d}=v(),o=V();re([{key:"l",ctrlOrCmd:!0,action:()=>c("custody"),description:"Log custody transfer"},{key:"v",ctrlOrCmd:!0,action:()=>c("forensics"),description:"View forensics"},{key:"o",ctrlOrCmd:!0,action:()=>c("overview"),description:"View overview"},{key:"Escape",action:s,description:"Go back to inventory"}]);const{mutate:g,isLoading:j}=F(async()=>{const x={id:`ex-${Date.now()}`,caseId:i.caseId,exhibitNumber:`PX-${Date.now().toString().slice(-3)}`,title:i.title,description:i.description,type:"Document",fileType:i.fileType||"PDF",party:"Plaintiff",status:"Marked",dateMarked:new Date().toISOString().split("T")[0],tags:i.tags,uploadedBy:"Current User"};await k.exhibits.add(x);const C={...i,admissibility:"Admissible"};return await k.evidence.update(i.id,C),x},{invalidateKeys:[["evidence","all"],["exhibits","all"]],onSuccess:x=>{o.success(`Evidence promoted to Exhibit ${x.exhibitNumber}. Admissibility updated.`)}});return e.jsxs("div",{className:"h-full flex flex-col space-y-6 animate-in slide-in-from-right-4 duration-300",children:[e.jsxs("div",{className:"flex flex-col md:flex-row md:justify-between md:items-start gap-4",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("button",{title:"Go back",onClick:s,className:t("p-2 rounded-full transition-colors",d.text.secondary,`hover:${d.surface.highlight}`),children:e.jsx(J,{className:"h-6 w-6"})}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("h1",{className:t("text-2xl font-bold",d.text.primary),children:i.title}),e.jsx("span",{className:t("font-mono text-sm px-2 py-0.5 rounded border",d.surface.highlight,d.border.default,d.text.secondary),children:i.id})]}),e.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[e.jsxs("p",{className:t("text-sm",d.text.secondary),children:["Associated Case: ",e.jsx("span",{className:t("font-medium",d.primary.text),children:i.caseId})]}),l&&e.jsxs("button",{onClick:()=>l(i.caseId),className:t("text-xs flex items-center px-2 py-0.5 rounded hover:underline",d.primary.text,d.primary.light),children:[e.jsx(K,{className:"h-3 w-3 mr-1"})," View Case"]})]})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(m,{variant:"secondary",icon:X,onClick:()=>g(void 0),disabled:j||i.admissibility==="Admissible",children:i.admissibility==="Admissible"?"Marked as Exhibit":"Promote to Exhibit"}),e.jsx(m,{variant:"outline",icon:Y,children:"Generate Report"}),e.jsx(m,{variant:"primary",icon:W,onClick:()=>c("custody"),children:"Log Transfer"})]})]}),e.jsx("div",{children:e.jsx(Z,{tabs:["overview","structure","custody","admissibility","forensics"],activeTab:a,onChange:c,variant:"underline"})}),e.jsxs("div",{className:"flex-1 overflow-y-auto pb-8",children:[a==="overview"&&e.jsx(je,{selectedItem:i}),a==="structure"&&e.jsx(be,{selectedItem:i}),a==="custody"&&e.jsx(oe,{selectedItem:i,onCustodyUpdate:n}),a==="admissibility"&&e.jsx(de,{selectedItem:i}),a==="forensics"&&e.jsx(he,{selectedItem:i})]})]})};export{ms as EvidenceDetail};
