import{m as n,f as a}from"./useQueryHooks-Oyt-TMLP.js";import"./vendor-core-V-oW58GW.js";import"./vendor-misc-Dwkhvdtg.js";import"./vendor-charts-KZIdMATq.js";const r="lexiflow_notification_subscriptions",c={getAll:async()=>n.notifications?.getAll?.()||[],getById:async t=>n.notifications?.getById?.(t)||null,add:async t=>{const e=t&&typeof t=="object"?t:{},i={...e,timestamp:e.timestamp||new Date().toISOString(),read:!1};return n.notifications?.create?.(i)||i},update:async(t,e)=>{const i=e&&typeof e=="object"?e:{};return i.read===!0?n.notifications?.markAsRead?.(t)||{id:t,...i}:{id:t,...i}},delete:async t=>(await n.notifications?.delete?.(t),!0),getNotifications:async t=>{let i=await n.notifications?.getAll?.()||[];return t?.read!==void 0&&(i=i.filter(o=>o.read===t.read)),t?.type&&(i=i.filter(o=>o.type===t.type)),i.sort((o,s)=>new Date(s.timestamp).getTime()-new Date(o.timestamp).getTime()),t?.limit&&(i=i.slice(0,t.limit)),i},markAsRead:async t=>{try{return await c.update(t,{read:!0}),!0}catch{return!1}},markAllAsRead:async()=>{try{const i=(await n.notifications?.getAll?.()||[]).filter(o=>!o.read);return await Promise.all(i.map(o=>n.notifications?.markAsRead?.(o.id))),!0}catch{return!1}},getUnreadCount:async()=>(await n.notifications?.getAll?.()||[]).filter(i=>!i.read).length,subscribe:async t=>{try{const e=a.getItem(r),i=e?JSON.parse(e):[];return i.includes(t)||(i.push(t),a.setItem(r,JSON.stringify(i))),console.log(`[NotificationService] Subscribed to channel: ${t}`),!0}catch{return!1}},unsubscribe:async t=>{try{const e=a.getItem(r),o=(e?JSON.parse(e):[]).filter(s=>s!==t);return a.setItem(r,JSON.stringify(o)),console.log(`[NotificationService] Unsubscribed from channel: ${t}`),!0}catch{return!1}}};export{c as NotificationService};
