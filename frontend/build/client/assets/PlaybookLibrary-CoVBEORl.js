import{r as f,j as e,bf as L,bg as g,V as A,F as T,q as $,v as j,a$ as D,aV as W,ah as P,a_ as R,bG as M}from"./vendor-core-V-oW58GW.js";import{c as r,u as B}from"./useQueryHooks-Oyt-TMLP.js";import{D as E}from"./dataService-BWLMkXM4.js";import{q as H}from"./queryKeys-BBVgMz36.js";import{u as y}from"./ThemeContext-OPG61qw5.js";import{a as v}from"./SyncContext-B5_p5hCg.js";import{W as F,R as I,V}from"./case-detail-q84K17Pa.js";import{B as b}from"./Button-CDQlLg6j.js";import{T as q}from"./Tabs-7xONCRTX.js";import"./Card-CDOiP5UM.js";import"./MetricCard-BH_9X7pi.js";import"./AppShell-Cug-APl3.js";import"./tabs.config-D59pmwVC.js";import"./PageHeader-C4TFe3Td.js";import"./Badge-bF-hTHJZ.js";import"./vendor-misc-Dwkhvdtg.js";import"./schemas-B2_dy3tf.js";import"./Table-C_bcd1kC.js";import"./EmptyState-7A4cJUVU.js";import"./VirtualList-r2WXvtCD.js";import"./ErrorState-WL3az5ve.js";import"./ConfirmDialog--jvbqDAw.js";import"./Kanban-BI78PbzY.js";import"./type-mappings-DEPYyX4d.js";import"./vendor-charts-KZIdMATq.js";import"./preload-helper-BXl3LOEh.js";import"./useNotify-DdRjm5G5.js";import"./useSessionStorage-D_292xEY.js";import"./dateUtils-rLIRMrtk.js";import"./FilterPanel-BteidCPx.js";import"./formatters-stMuSkc6.js";import"./AdaptiveLoader-D5wOoiN1.js";import"./Modal-Rns91qFF.js";import"./UserAvatar-BPVf-Spq.js";import"./Input-Dmln04Yk.js";import"./TextArea-DrtcCAyn.js";import"./geminiService-_CYFbtO8.js";import"./TaskCreationModal-D5xiqN6m.js";import"./search.config-B6mvIgDA.js";import"./useToggle-CjLp2PQ4.js";import"./sanitize-k_Tw3ej1.js";import"./useModalState-Cst_3NmK.js";import"./scheduler-BERajRBE.js";import"./RouteErrorBoundary-Nha8Il06.js";import"./meta-utils-lVs9HXG9.js";const G=a=>{switch(a){case"Low":return"text-green-600 bg-green-50 border-green-200";case"Medium":return"text-blue-600 bg-blue-50 border-blue-200";case"High":return"text-purple-600 bg-purple-50 border-purple-200";default:return"text-slate-600"}},K=a=>{switch(a){case"High":return"bg-purple-500";case"Medium":return"bg-blue-500";case"Low":return"bg-green-500";default:return"bg-slate-500"}},O=(a,t,i,d)=>a.filter(o=>{const p=o.title.toLowerCase().includes(t.toLowerCase())||o.tags.some(l=>l.toLowerCase().includes(t.toLowerCase())),n=i==="All"||o.category===i,u=d==="All"||o.difficulty===d;return p&&n&&u}),Q=a=>["All",...Array.from(new Set(a.map(t=>t.category)))],_=({playbook:a,onApply:t})=>{const{theme:i}=y(),{openWindow:d}=v(),[o,p]=f.useState("workflow"),n=l=>{const c=`research-${Date.now()}`;d(c,`Research: ${l}`,e.jsx("div",{className:"h-full bg-white dark:bg-slate-900",children:e.jsx(I,{initialTab:"active"})}))},u=()=>{const l=`warroom-preview-${a.id}`;d(l,`War Room Template: ${a.title}`,e.jsx("div",{className:"h-full bg-white dark:bg-slate-900",children:e.jsx(F,{initialTab:"command"})}))};return e.jsxs("div",{className:r("h-full flex flex-col bg-white dark:bg-slate-900",i.text.primary),children:[e.jsxs("div",{className:r("p-6 border-b flex justify-between items-start shrink-0",i.border.default),children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx("span",{className:r("px-2 py-0.5 rounded text-xs font-bold border",i.primary.light,i.primary.border,i.primary.text),children:a.category}),e.jsx("span",{className:r("px-2 py-0.5 rounded text-xs font-bold border",i.surface.highlight,i.border.default),children:a.jurisdiction})]}),e.jsx("h2",{className:"text-2xl font-bold",children:a.title}),e.jsx("p",{className:r("text-sm mt-1 max-w-2xl",i.text.secondary),children:a.description})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(b,{variant:"secondary",onClick:u,icon:L,children:"Preview War Room"}),e.jsx(b,{variant:"primary",onClick:()=>t(a),children:"Apply to Canvas"})]})]}),e.jsx("div",{className:r("px-6 border-b",i.border.default),children:e.jsx(q,{tabs:[{id:"workflow",label:"Workflow Stages",icon:g},{id:"strategy",label:"Legal Strategy & Authority",icon:A},{id:"assets",label:"Documents & Evidence",icon:T}],activeTab:o,onChange:p})}),e.jsxs("div",{className:"flex-1 overflow-y-auto p-6",children:[o==="workflow"&&e.jsxs("div",{className:"space-y-6 max-w-4xl mx-auto",children:[e.jsx("div",{className:"flex items-center justify-between p-4 bg-blue-50 dark:bg-blue-900/20 border border-blue-100 dark:border-blue-800 rounded-lg",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx($,{className:"h-5 w-5 text-blue-600 dark:text-blue-400"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-bold text-blue-900 dark:text-blue-200",children:"Estimated Lifecycle"}),e.jsxs("p",{className:"text-xs text-blue-700 dark:text-blue-300",children:["Total Duration: ~18 Months â€¢ ",a.stages?.length||0," Phases"]})]})]})}),e.jsx("div",{className:"relative border-l-2 border-slate-200 dark:border-slate-700 ml-4 space-y-8 py-2",children:a.stages?.map((l,c)=>e.jsxs("div",{className:"relative pl-8",children:[e.jsx("div",{className:r("absolute -left-[9px] top-0 w-4 h-4 rounded-full border-2 bg-white dark:bg-slate-900",c===0?"border-green-500":"border-slate-300")}),e.jsx("h4",{className:"text-lg font-bold mb-1",children:l.name}),e.jsx("p",{className:"text-xs text-slate-500 mb-3 uppercase tracking-wide font-bold",children:l.duration}),e.jsx("div",{className:"grid grid-cols-1 gap-2",children:l.criticalTasks.map((h,m)=>e.jsxs("div",{className:r("p-3 rounded border flex items-center gap-3",i.surface.default,i.border.default),children:[e.jsx(j,{className:"h-4 w-4 text-slate-400"}),e.jsx("span",{className:"text-sm",children:h})]},m))})]},`stage-${l.name}-${c}`))})]}),o==="strategy"&&e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("h3",{className:"font-bold text-lg flex items-center gap-2",children:[e.jsx(D,{className:"h-5 w-5 text-purple-600"})," Key Authorities"]}),e.jsx("div",{className:"space-y-3",children:a.authorities?.map((l,c)=>e.jsxs("div",{className:r("p-4 rounded-lg border group hover:border-purple-300 transition-all cursor-pointer",i.surface.default,i.border.default),onClick:()=>n(l.citation),children:[e.jsxs("div",{className:"flex justify-between items-start mb-1",children:[e.jsx("span",{className:"text-xs font-bold uppercase text-purple-600",children:l.type}),e.jsx(W,{className:"h-3 w-3 text-slate-400 opacity-0 group-hover:opacity-100"})]}),e.jsx("h4",{className:"font-bold text-sm text-blue-700 hover:underline",children:l.citation}),e.jsx("p",{className:"text-sm font-medium",children:l.title}),e.jsx("p",{className:"text-xs text-slate-500 mt-2 italic",children:l.relevance})]},`auth-${l.citation}-${c}`))})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("h3",{className:"font-bold text-lg flex items-center gap-2",children:[e.jsx(P,{className:"h-5 w-5 text-amber-600"})," Strategic Notes"]}),e.jsx("div",{className:r("p-6 rounded-lg border bg-amber-50 dark:bg-amber-900/10 border-amber-100 dark:border-amber-800 text-sm leading-relaxed",i.text.primary),children:a.strategyNotes})]})]})]})]})},Fe=({onApply:a})=>{const{theme:t}=y(),{openWindow:i,closeWindow:d}=v(),[o,p]=f.useState(""),[n,u]=f.useState("All"),[l,c]=f.useState("All"),{data:h=[],isLoading:m}=B(H.playbooks.all(),()=>E.playbooks.getAll()),N=Q(h),w=f.useMemo(()=>O(h,o,n,l),[h,o,n,l]),k=s=>{const x=`playbook-${s.id}`;i(x,`Strategy: ${s.title}`,e.jsx(_,{playbook:s,onClose:()=>d(x),onApply:S=>{a(S),d(x)}}))},C=s=>e.jsx("div",{className:"p-3 h-full",children:e.jsxs("div",{className:r("group flex flex-col h-full rounded-xl border shadow-sm transition-all hover:shadow-lg cursor-pointer bg-white dark:bg-slate-900 relative overflow-hidden",t.border.default),onClick:()=>k(s),children:[e.jsx("div",{className:r("absolute top-0 left-0 w-1 h-full transition-colors",K(s.difficulty))}),e.jsxs("div",{className:"p-5 flex-1 flex flex-col",children:[e.jsxs("div",{className:"flex justify-between items-start mb-3",children:[e.jsx("span",{className:r("text-[10px] font-bold uppercase tracking-wider px-2 py-0.5 rounded border",t.surface.highlight,t.text.secondary),children:s.category}),e.jsx("span",{className:r("text-[10px] font-bold px-2 py-0.5 rounded border",G(s.difficulty)),children:s.difficulty})]}),e.jsx("h3",{className:r("font-bold text-lg mb-2 line-clamp-2",t.text.primary),children:s.title}),e.jsx("p",{className:r("text-sm line-clamp-3 mb-4 flex-1",t.text.secondary),children:s.description}),e.jsx("div",{className:"flex flex-wrap gap-2 mb-4",children:s.tags.slice(0,3).map(x=>e.jsxs("span",{className:r("text-[10px] px-1.5 py-0.5 rounded bg-slate-100 dark:bg-slate-800 text-slate-500 dark:text-slate-400"),children:["#",x]},x))}),s.readiness&&e.jsxs("div",{className:"mb-4",children:[e.jsxs("div",{className:"flex justify-between items-center text-[10px] font-bold mb-1",children:[e.jsxs("span",{className:"text-green-600 flex items-center gap-1",children:[e.jsx(j,{className:"h-3 w-3"})," ",s.status||"Ready"]}),e.jsxs("span",{className:t.text.primary,children:[s.readiness,"%"]})]}),e.jsx("div",{className:r("w-full h-1.5 rounded-full overflow-hidden bg-slate-100 dark:bg-slate-800"),children:e.jsx("div",{className:"h-full bg-green-500",style:{width:`${s.readiness}%`}})})]}),e.jsx("div",{className:r("flex items-center justify-between pt-4 border-t",t.border.default),children:e.jsxs("div",{className:r("flex items-center gap-3 text-xs",t.text.tertiary),children:[e.jsxs("span",{className:"flex items-center",children:[e.jsx(M,{className:"h-3 w-3 mr-1"})," ",s.jurisdiction]}),e.jsxs("span",{className:"flex items-center",children:[e.jsx(g,{className:"h-3 w-3 mr-1"})," ",s.phases," Phs"]})]})})]})]})});return e.jsxs("div",{className:"flex flex-col h-full",children:[e.jsx("div",{className:r("p-4 border-b space-y-4 shrink-0",t.surface.default,t.border.default),children:e.jsxs("div",{className:"flex flex-col md:flex-row justify-between gap-4",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx(R,{className:r("absolute left-3 top-1/2 -translate-y-1/2 h-5 w-5",t.text.tertiary)}),e.jsx("input",{className:r("w-full pl-10 pr-4 py-2.5 rounded-lg border text-sm outline-none focus:ring-2 focus:ring-blue-500",t.surface.highlight,t.border.default,t.text.primary),placeholder:"Search 50+ litigation strategies...",value:o,onChange:s=>p(s.target.value),disabled:m})]}),e.jsxs("div",{className:"flex gap-2 overflow-x-auto pb-2 md:pb-0",children:[e.jsx("select",{title:"Filter by category",className:r("px-3 py-2 rounded-lg border text-sm outline-none min-w-[140px]",t.surface.default,t.border.default,t.text.primary),value:n,onChange:s=>u(s.target.value),disabled:m,children:N.map(s=>e.jsx("option",{value:s,children:s},s))}),e.jsxs("select",{title:"Filter by difficulty",className:r("px-3 py-2 rounded-lg border text-sm outline-none min-w-[140px]",t.surface.default,t.border.default,t.text.primary),value:l,onChange:s=>c(s.target.value),disabled:m,children:[e.jsx("option",{value:"All",children:"All Difficulties"}),e.jsx("option",{value:"Low",children:"Low Complexity"}),e.jsx("option",{value:"Medium",children:"Medium Complexity"}),e.jsx("option",{value:"High",children:"High Complexity"})]})]})]})}),e.jsx("div",{className:"flex-1 overflow-hidden p-4 bg-slate-50 dark:bg-black/20",children:m?e.jsx("div",{className:r("flex items-center justify-center h-full",t.text.secondary),children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),e.jsx("p",{children:"Loading playbooks..."})]})}):e.jsx(V,{items:w,itemHeight:340,itemWidth:320,height:"100%",gap:16,renderItem:s=>C(s),emptyMessage:"No playbooks match your criteria."})})]})};export{Fe as PlaybookLibrary,Fe as default};
