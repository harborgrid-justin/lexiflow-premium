import{r as d,j as e,ab as N,v as y,cG as w,ba as v}from"./vendor-core-V-oW58GW.js";import{u as T,c as a}from"./useQueryHooks-BdeOvP9e.js";import{D as C}from"./dataService-75QCl8KS.js";import{u as F}from"./useNotify-Bhb3OIEg.js";import{u as k}from"./ThemeContext-OPG61qw5.js";import{B}from"./Button-PaGqeZoR.js";import{C as u}from"./Card-D56KNEnI.js";import"./vendor-misc-Dwkhvdtg.js";import"./vendor-charts-KZIdMATq.js";import"./preload-helper-BXl3LOEh.js";import"./type-mappings-DEPYyX4d.js";import"./SyncContext-DYD5yPAv.js";class f{children=new Map}class D{root=new f;text;constructor(n){this.text=n+"$";for(let t=0;t<this.text.length;t++)this.insertSuffix(this.text.substring(t))}insertSuffix(n){let t=this.root;for(const r of n)t.children.has(r)||t.children.set(r,new f),t=t.children.get(r)}hasSubstring(n){let t=this.root;for(const r of n){if(!t.children.has(r))return!1;t=t.children.get(r)}return!0}}const Q=()=>{const{theme:s}=k(),n=F(),[t,r]=d.useState(!1),[m,x]=d.useState(null),[i,g]=d.useState(""),{data:p=[]}=T(["malware-signatures","all"],C.security.getMalwareSignatures),j=async l=>{if(!l.target.files||l.target.files.length===0)return;const o=l.target.files[0];g(o.name),r(!0),x(null);const b=await o.text(),S=new D(b);await new Promise(c=>setTimeout(c,1500));let h=!1;for(const c of p)if(S.hasSubstring(c)){h=!0;break}x(h?"infected":"clean"),r(!1),n.info(`Scan complete for ${o.name}`)};return e.jsxs("div",{className:"space-y-6",children:[e.jsx(u,{title:"Threat Intelligence Center",children:e.jsxs("div",{className:"flex items-center justify-between p-4 bg-red-50 border border-red-200 rounded-lg",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-bold text-red-800",children:"Threat Level: Elevated"}),e.jsx("p",{className:"text-xs text-red-700",children:"Increased phishing activity detected targeting legal sector."})]}),e.jsx(B,{variant:"danger",children:"View Intel Brief"})]})}),e.jsx(u,{title:"Malware Signature Scanner (Suffix Tree)",children:e.jsxs("div",{className:a("p-8 border-2 border-dashed rounded-lg text-center cursor-pointer relative",s.border.default,`hover:${s.primary.border}`),children:[e.jsx("input",{type:"file",title:"Select file to scan",className:"absolute inset-0 opacity-0 cursor-pointer",onChange:j}),t?e.jsxs(e.Fragment,{children:[e.jsx(N,{className:a("h-12 w-12 mx-auto mb-4 animate-spin",s.primary.text)}),e.jsxs("h3",{className:a("font-bold text-lg",s.text.primary),children:["Scanning: ",i]}),e.jsx("p",{className:a("text-sm",s.text.secondary),children:"Using Suffix Tree for O(L) substring search..."})]}):m?m==="clean"?e.jsxs(e.Fragment,{children:[e.jsx(y,{className:"h-12 w-12 mx-auto mb-4 text-green-500"}),e.jsx("h3",{className:"font-bold text-lg text-green-700",children:"File is Clean"}),e.jsxs("p",{className:a("text-sm",s.text.secondary),children:["No known malware signatures found in ",i,"."]})]}):e.jsxs(e.Fragment,{children:[e.jsx(w,{className:"h-12 w-12 mx-auto mb-4 text-red-500"}),e.jsx("h3",{className:"font-bold text-lg text-red-700",children:"Threat Detected!"}),e.jsxs("p",{className:a("text-sm",s.text.secondary),children:["Malicious signature found in ",i,". File has been quarantined."]})]}):e.jsxs(e.Fragment,{children:[e.jsx(v,{className:a("h-12 w-12 mx-auto mb-4",s.text.tertiary)}),e.jsx("h3",{className:a("font-bold text-lg",s.text.primary),children:"Scan Document for Threats"}),e.jsx("p",{className:a("text-sm",s.text.secondary),children:"Click or drop file to analyze against signature database."})]})]})})]})};export{Q as SecurityOps};
