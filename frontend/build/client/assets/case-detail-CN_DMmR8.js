const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/DocumentExplorer-CnTnI11N.js","assets/vendor-core-V-oW58GW.js","assets/vendor-misc-Dwkhvdtg.js","assets/vendor-charts-KZIdMATq.js","assets/dataService-75QCl8KS.js","assets/preload-helper-BXl3LOEh.js","assets/useQueryHooks-BdeOvP9e.js","assets/type-mappings-DEPYyX4d.js","assets/queryKeys-BBVgMz36.js","assets/useNotify-Bhb3OIEg.js","assets/ThemeContext-OPG61qw5.js","assets/SyncContext-DYD5yPAv.js","assets/VirtualList-B1zORm91.js","assets/Button-PaGqeZoR.js","assets/Modal-BlJFylOy.js","assets/Badge-B08w10nz.js","assets/schemas-B2_dy3tf.js","assets/AppShell-Z1zGEOCG.js","assets/tabs.config-F85gN5xx.js","assets/PageHeader-os9pD5mt.js","assets/formatters-stMuSkc6.js","assets/Table-C8OsWLsz.js","assets/EmptyState-BwtZeBY5.js","assets/dateUtils-rLIRMrtk.js","assets/Card-D56KNEnI.js","assets/MetricCard-CDV5joW_.js","assets/useSessionStorage-HC9RvMcM.js","assets/ErrorState-BA0dmAVI.js","assets/ConfirmDialog-CTAXMvML.js","assets/Kanban-BbECSZhC.js","assets/FilterPanel-C0WYx6xs.js","assets/AdaptiveLoader-gvY3s3Bs.js","assets/UserAvatar-lVqVFNPb.js","assets/Tabs-BTz8yyZK.js","assets/Input-JNgj1Ekc.js","assets/TextArea-BMpffac7.js","assets/geminiService-DjDdWyh4.js","assets/TaskCreationModal-B2VECu1_.js","assets/search.config-B6mvIgDA.js","assets/useToggle-CjLp2PQ4.js","assets/sanitize-k_Tw3ej1.js","assets/useModalState-Cst_3NmK.js","assets/scheduler-BERajRBE.js","assets/RouteErrorBoundary-Nha8Il06.js","assets/meta-utils-lVs9HXG9.js","assets/DocumentTemplates-CJpDiW86.js","assets/RecentFiles-e-6oaoLM.js","assets/PDFEditorView-CpbmaJYK.js","assets/RedactionStudioView-DEw-tXIs.js","assets/BatchProcessingView-C7j-ellx.js","assets/BillingInvoices-D8jr0qzb.js","assets/queryKeys-Dex4MaB7.js","assets/BillingWIP-hxyeZS_n.js","assets/WikiView-Cb-5G1sT.js","assets/useFilterAndSearch-B2zKLOlA.js","assets/PrecedentsView-DqklS0za.js","assets/QAView-Tr_YiqVM.js","assets/KnowledgeAnalytics-BAoB0LnD.js","assets/ActiveResearch-v-ACdYqa.js","assets/ResearchHistory-CaEcD8ze.js","assets/SavedAuthorities-Ck3Kioy1.js","assets/JurisdictionSettings-xKWXhLAA.js","assets/ShepardizingTool-DpmNh5Si.js","assets/ClauseLibrary-DAisxU19.js","assets/ClauseHistoryModal-tbMW-2a5.js","assets/CitationLibrary-B-Ba-HYx.js","assets/utils-DPkCh2_M.js","assets/BriefAnalyzer-mg_EjD84.js","assets/JurisdictionFederal-BkHmr8Ju.js","assets/JurisdictionState-Dv3nI_dD.js","assets/filterHelpers-Bh0_NiHX.js","assets/JurisdictionRegulatory-CJ27ZRPI.js","assets/JurisdictionInternational-CQxnAtp-.js","assets/JurisdictionArbitration-DFQo1Ggp.js","assets/JurisdictionLocalRules-Bme-yx_Z.js","assets/JurisdictionGeoMap-CB_sYjbA.js","assets/RulesDashboard-B0aNFB9O.js","assets/RuleBookViewer-n9RMmH3h.js","assets/StandingOrders-D4JLXpB_.js","assets/LocalRulesMap-9POWM-WB.js","assets/HRManager-CdnpEfGf.js","assets/useDomainData-DVGIWLUf.js","assets/FinancialCenter-B6RNAu7B.js","assets/MarketingDashboard-BTb-ydvc.js","assets/AssetManager-cEkGfdsk.js","assets/KnowledgeCenter-kfvCUqNT.js","assets/VendorProcurement-BhGvnNUk.js","assets/FacilitiesManager-DGVZOa5g.js","assets/RefactoredCommon-C4VrRajq.js","assets/SecurityOps-CWAuYJLv.js","assets/StrategyBoard-pxNyrQ06.js","assets/ProgressBar-ysLhgZvu.js","assets/CRMDashboard-CLEhLzSW.js","assets/chartColorService-Dq1XQNFk.js","assets/chartConfig-DG5fYqz9.js","assets/ClientDirectory-DHCcbzBr.js","assets/CRMPipeline-fOBdLT84.js","assets/ClientAnalytics-CUxRlzq7.js","assets/ClientPortalDocuments-DmsP4pu0.js","assets/ClientPortalMessages-s3uwdTTM.js","assets/ClientPortalSecurity-CxIGDYaA.js","assets/ClientPortalActivity-DM7Q0_UC.js","assets/StrategyCanvas-BBt76zo3.js","assets/BuilderToolbar-BrBSlilU.js","assets/PlaybookLibrary-D1a1fex9.js","assets/OutcomeSimulator-cfffWpMn.js","assets/LitigationScheduleView-CBIjPhRw.js","assets/CommandCenter-DN6bEOxi.js","assets/EvidenceWall-D8VJd9rR.js","assets/WitnessPrep-C2Pw4det.js","assets/TrialBinder-Bv01NOcT.js","assets/AdvisoryBoard-B2YVw2cV.js","assets/useSelectionState-DfTDWAAj.js","assets/OppositionManager-Bc2SW7dn.js","assets/WarRoomSidebar-woW1ITC-.js","assets/EvidenceDashboard-_t9vysT3.js","assets/EvidenceCustodyLog-DQfdchh_.js","assets/EvidenceIntake-BKyDZ84K.js","assets/useWizard-C5deA0UI.js","assets/evidenceSchemas-BfC4WNg8.js","assets/EvidenceDetail-BeGC3Tls.js","assets/DiscoveryDashboard-D_znYq9M.js","assets/PrivilegeLog-CJKAEtyb.js","assets/LegalHolds-dzt5ONiz.js","assets/DiscoveryDocumentViewer-CZSbRo-r.js","assets/DiscoveryResponse-7z1Cl_mA.js","assets/discoverySchemas-nx9p4LOg.js","assets/DiscoveryProduction-W8-aaZ6R.js","assets/DiscoveryProductions-Di82MD_p.js","assets/DiscoveryDepositions-B8kkgiCu.js","assets/DiscoveryESI-DIFdAqVw.js","assets/DiscoveryInterviews-Dl49KfuM.js","assets/InitialDisclosureWizard-BTNlSaqB.js","assets/MotionToCompelBuilder-DaSA2i_T.js","assets/DiscoveryStipulations-zpeTLweA.js","assets/RequestForAdmission-BwsLboYW.js","assets/Examinations-BY0L3o6C.js","assets/TranscriptManager-BK-bb49J.js","assets/VendorManagement-AezQQ3hs.js","assets/PerpetuateTestimony-C-VYmdCX.js","assets/Custodians-DgOpVbj5.js","assets/PleadingDrafts-CGBToQS4.js","assets/PleadingTemplates-DuCtb3mU.js","assets/PleadingFilingQueue-D6NaIK-N.js","assets/PleadingAnalytics-BSACt7lv.js","assets/PleadingPaper-CbogjtHk.js","assets/PleadingCanvas-CsbKMzBI.js","assets/AIDraftingAssistant-B2lmoIdD.js","assets/ContextPanel-DxWvC-6x.js","assets/ComplianceHUD-nty1NNzQ.js","assets/LogicOverlay-CiIVJL8I.js","assets/DocumentAssembly-CbSNSniz.js"])))=>i.map(i=>d[i]);
import{r as c,l as z,j as e,ap as ja,aq as ba,ar as va,as as _t,at as ya,au as Na,av as wa,aw as Dt,an as es,ax as oe,ay as Tt,az as Ca,aA as ka,aB as Sa,ah as Pe,aC as Vs,F as Q,ac as Ae,q as ce,aD as _a,aE as Da,ae as $e,af as Be,aF as Ta,aG as Me,aH as Ea,T as be,ab as re,p as je,aI as Aa,v as ie,aJ as ss,X as Se,aK as Ia,aL as Pa,aM as Ra,aN as La,aa as pe,aO as Ma,a1 as Fs,aP as Oa,aQ as za,aR as $a,aS as Va,K as ts,aT as Oe,aU as Fa,aV as fs,aW as Ba,aX as Wa,aY as Ha,aZ as Ua,a_ as Et,a$ as as,a6 as Bs,b0 as Ga,b1 as qa,al as J,a8 as Ce,b2 as et,aj as de,b3 as ps,b4 as Ws,A as Hs,a0 as fe,b5 as Ka,b6 as At,a5 as Us,b7 as Ja,b8 as Za,b9 as Gs,a3 as st,ba as Ya,bb as qs,ad as Ds,D as Ts,bc as Qa,bd as It,a9 as Pt,be as tt,bf as ze,bg as gs,ai as Xa,bh as ve,bi as at,bj as js,bk as er,bl as sr,a2 as Ks,bm as Rt,V as Ee,a7 as Ze,t as bs,bn as Es,bo as Js,bp as tr,bq as ar,br as rr,bs as As,ag as lr,bt as ir,k as Is,am as nr,bu as or,bv as cr,bw as dr,bx as mr,by as ds,bz as Lt,bA as Mt,bB as ur,Z as Ot,bC as zt,m as xr,bD as hr,bE as fr,bF as rt,bG as pr,bH as $t,bI as gr,e as jr,f as br,_ as vr,bJ as lt}from"./vendor-core-V-oW58GW.js";import{B as _}from"./Button-PaGqeZoR.js";import{B as K}from"./Badge-B08w10nz.js";import{a5 as yr,a6 as Nr,a7 as Vt,a8 as it,a9 as q,aa as nt,ab as Ft,ac as Ps,ad as wr}from"./vendor-misc-Dwkhvdtg.js";import"./schemas-B2_dy3tf.js";import{u as D}from"./ThemeContext-OPG61qw5.js";import{c as t,N as Cr,V as he,O as is,d as le,q as Y,u as F,P as kr,C as Sr,W as _r}from"./useQueryHooks-BdeOvP9e.js";import{a as _e,b as Dr}from"./SyncContext-DYD5yPAv.js";import{d as ws,B as Tr,S as xs,y as ot,D as I,a as Rs,V as Er,I as Ar,b as Ir,T as ue}from"./dataService-75QCl8KS.js";import{V as rs}from"./VirtualList-B1zORm91.js";import{b as Pr,c as Rr,d as Lr,a as Bt,S as ct,N as Mr,u as Or}from"./AppShell-Z1zGEOCG.js";import{_ as k}from"./preload-helper-BXl3LOEh.js";import{R as dt,T as zr,D as $r}from"./tabs.config-F85gN5xx.js";import{P as Vr}from"./PageHeader-os9pD5mt.js";import{T as We,a as He,b as B,c as Ue,d as Ie,e as V}from"./Table-C8OsWLsz.js";import{E as Wt}from"./EmptyState-BwtZeBY5.js";import{u as De}from"./useNotify-Bhb3OIEg.js";import{getTodayString as Zs}from"./dateUtils-rLIRMrtk.js";import{C as ye}from"./Card-D56KNEnI.js";import{M as ne}from"./MetricCard-CDV5joW_.js";import{q as U}from"./queryKeys-BBVgMz36.js";import{u as Ht,L as ke}from"./useSessionStorage-HC9RvMcM.js";import{E as mt}from"./ErrorState-BA0dmAVI.js";import{C as Fr}from"./ConfirmDialog-CTAXMvML.js";import"./Kanban-BbECSZhC.js";import{C as Br,F as Wr}from"./FilterPanel-C0WYx6xs.js";import{R as Ls,B as Hr,C as Ur,X as Gr,Y as qr,T as Ms,L as Os,a as ut,P as Ut,c as Gt,b as qt}from"./vendor-charts-KZIdMATq.js";import{A as Kr}from"./AdaptiveLoader-gvY3s3Bs.js";import{M as Ne}from"./Modal-BlJFylOy.js";import{b as ms,S as Je,C as Jr,c as Zr,A as Cs,D as xt}from"./type-mappings-DEPYyX4d.js";import{U as Kt}from"./UserAvatar-lVqVFNPb.js";import{T as Jt}from"./Tabs-BTz8yyZK.js";import{I as Z}from"./Input-JNgj1Ekc.js";import{T as Ge}from"./TextArea-BMpffac7.js";import{G as qe}from"./geminiService-DjDdWyh4.js";import{T as Ke,R as Yr}from"./TaskCreationModal-B2VECu1_.js";import{u as Ys}from"./useToggle-CjLp2PQ4.js";import{b as Qr}from"./search.config-B6mvIgDA.js";import{F as ht}from"./formatters-stMuSkc6.js";import{s as ft}from"./sanitize-k_Tw3ej1.js";import{u as hs}from"./useModalState-Cst_3NmK.js";import{S as Xr}from"./scheduler-BERajRBE.js";import{N as el,R as sl}from"./RouteErrorBoundary-Nha8Il06.js";import{b as tl}from"./meta-utils-lVs9HXG9.js";const cc={NODE_WIDTH_HALF:75,NODE_HEIGHT_HALF:40,PHASE_WIDTH:300,PHASE_HEIGHT:200,DECISION_NODE_SIZE:56,PIXELS_PER_DAY:20,DEFAULT_TASK_DURATION:7,DECISION_DURATION:14,EVENT_DURATION:1},ge={COPY:"Ctrl+C",PASTE:"Ctrl+V",DUPLICATE:"Ctrl+D",UNDO:"Ctrl+Z",REDO:"Ctrl+Y",SELECT_ALL:"Ctrl+A",SAVE:"Ctrl+S",ZOOM_IN:"Ctrl+=",ZOOM_OUT:"Ctrl+-",ZOOM_RESET:"Ctrl+0"};var Ye=(s=>(s.LOW="Low",s.MEDIUM="Medium",s.HIGH="High",s.CRITICAL="Critical",s))(Ye||{}),Qe=(s=>(s.LOW="Low",s.MEDIUM="Medium",s.HIGH="High",s))(Qe||{}),Le=(s=>(s.OPEN="Open",s.MONITORING="Monitoring",s.MITIGATED="Mitigated",s.CLOSED="Closed",s.IDENTIFIED="IDENTIFIED",s))(Le||{});function al({initialState:s,maxHistory:a=50,onStateChange:r}){const[l,o]=c.useState(s),i=c.useRef([]),n=c.useRef(-1);c.useEffect(()=>{r?.(l)},[l,r]);const d=c.useCallback(j=>{o(j)},[]),m=c.useCallback(j=>{o(N=>{const y=j.execute(N);return i.current=i.current.slice(0,n.current+1),i.current.push(j),i.current.length>a?i.current.shift():n.current++,y})},[a]),f=c.useCallback(()=>{if(n.current>=0){const j=i.current[n.current];o(N=>j.undo(N)),n.current--}},[]),u=c.useCallback(()=>{if(n.current<i.current.length-1){n.current++;const j=i.current[n.current];o(N=>j.execute(N))}},[]),x=c.useCallback(()=>{i.current=[],n.current=-1},[]),p=n.current>=0,h=n.current<i.current.length-1;return{state:l,canUndo:p,canRedo:h,undo:f,redo:u,execute:m,clear:x,setState:d}}const rl=2e3;class ll extends Error{cause;context;constructor(a,r,l){super(a,{cause:r}),this.name="AutoSaveError",this.context=l}}function il(s){const a=c.useRef(!1),r=c.useRef(!1),l=c.useRef(s.data),o=c.useRef(!0),{data:i,onSave:n,delay:d=rl,enabled:m=!0,onSuccess:f,onError:u}=s;c.useEffect(()=>(o.current=!0,()=>{o.current=!1}),[]);const x=c.useCallback(async j=>{if(a.current){r.current=!0;return}if(JSON.stringify(j)!==JSON.stringify(l.current)){a.current=!0,r.current=!1;try{await n(j),o.current&&(l.current=j,f?.())}catch(N){if(o.current){const y=new ll("Failed to auto-save data",N,{dataToSave:j});u?.(y)}}finally{a.current=!1,r.current&&o.current&&await x(i)}}},[n,i,f,u]),p=Qr(j=>{x(j)},d);return c.useEffect(()=>{m&&p(i)},[i,m,p]),{forceSave:c.useCallback(()=>{m&&x(i)},[m,i,x]),isSaving:a.current}}const nl=z.memo(({wordCount:s,onCmd:a,onSave:r})=>{const{theme:l}=D(),o=c.useId(),i=t("p-1.5 rounded transition-colors border border-transparent",l.text.primary,`hover:${l.surface.default}`,`hover:${l.primary.text}`,`hover:${l.border.default}`);return e.jsxs("div",{className:t("flex items-center gap-1 p-2 border-b flex-wrap",l.surface.highlight,l.border.default),children:[e.jsx("div",{className:t("flex items-center gap-0.5 border-r pr-2 mr-2",l.border.default),children:e.jsxs("select",{id:o,"aria-label":"Text Format",className:t("bg-transparent text-sm font-medium h-8 border-none outline-none cursor-pointer rounded px-1 transition-colors",l.text.primary,`hover:${l.surface.default}`),onChange:n=>a("formatBlock",n.target.value),children:[e.jsx("option",{value:"p",children:"Normal"}),e.jsx("option",{value:"h2",children:"Heading 1"}),e.jsx("option",{value:"h3",children:"Heading 2"}),e.jsx("option",{value:"h4",children:"Heading 3"})]})}),e.jsxs("div",{className:t("flex items-center gap-0.5 border-r pr-2 mr-2",l.border.default),children:[e.jsx("button",{onClick:()=>a("bold"),className:i,title:"Bold",children:e.jsx(ja,{className:"h-4 w-4"})}),e.jsx("button",{onClick:()=>a("italic"),className:i,title:"Italic",children:e.jsx(ba,{className:"h-4 w-4"})}),e.jsx("button",{onClick:()=>a("underline"),className:i,title:"Underline",children:e.jsx(va,{className:"h-4 w-4"})}),e.jsx("button",{onClick:()=>a("hiliteColor","#fef08a"),className:i,title:"Highlight",children:e.jsx(_t,{className:"h-4 w-4"})})]}),e.jsxs("div",{className:t("flex items-center gap-0.5 border-r pr-2 mr-2",l.border.default),children:[e.jsx("button",{onClick:()=>a("justifyLeft"),className:i,children:e.jsx(ya,{className:"h-4 w-4"})}),e.jsx("button",{onClick:()=>a("justifyCenter"),className:i,children:e.jsx(Na,{className:"h-4 w-4"})}),e.jsx("button",{onClick:()=>a("justifyRight"),className:i,children:e.jsx(wa,{className:"h-4 w-4"})}),e.jsx("button",{onClick:()=>a("insertUnorderedList"),className:i,children:e.jsx(Dt,{className:"h-4 w-4"})})]}),e.jsx("div",{className:"flex-1"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("span",{className:t("text-xs font-mono mr-2",l.text.tertiary),children:[s," words"]}),r&&e.jsxs("button",{onClick:r,className:t("flex items-center gap-2 px-3 py-1.5 rounded text-sm font-medium shadow-sm transition-all border border-transparent",l.primary.DEFAULT,l.text.inverse,l.primary.hover),children:[e.jsx(es,{className:"h-3.5 w-3.5"})," Save"]})]})]})}),ol=({initialContent:s,onSave:a,placeholder:r})=>{const l=c.useRef(null),{theme:o}=D(),i=Ys(),[n,d]=c.useState(null),[m,f]=c.useState(""),[u,x]=c.useState(!1),[p,h]=c.useState(0),j=c.useRef(null),N=c.useRef(!1);c.useEffect(()=>{if(l.current){const w=l.current.innerHTML,g=document.activeElement===l.current;if(s!==w&&(!g||!N.current)){const T=s.includes("<")?s:`<p>${s.replace(/\n/g,"<br/>")}</p>`;l.current.innerHTML=ft(T),y()}N.current=!1}},[s]);const y=c.useCallback(()=>{j.current&&clearTimeout(j.current),j.current=setTimeout(()=>{if(l.current){const w=l.current.innerText||"";h(w.trim().split(/\s+/).filter(g=>g.length>0).length)}},300)},[]),v=c.useCallback(()=>{N.current=!0,y(),a&&l.current&&a(l.current.innerHTML)},[a,y]),S=c.useCallback((w,g=void 0)=>{document.execCommand(w,!1,g),l.current?.focus(),v()},[v]),C=c.useCallback(()=>{const w=window.getSelection();if(w&&w.rangeCount>0&&!w.isCollapsed){const g=w.getRangeAt(0),T=l.current;if(T&&T.contains(g.commonAncestorContainer)){d(g.cloneRange()),i.open();return}}i.isOpen&&(i.close(),d(null))},[i]),b=async()=>{if(!(!n||!m)){x(!0);try{const w=n.toString(),g=await qe.generateDraft(`Rewrite this legal text: "${w}". Instruction: ${m}`,"Text Fragment"),T=window.getSelection();if(T){T.removeAllRanges(),T.addRange(n),n.deleteContents();const E=document.createElement("div");E.innerHTML=ft(g);let L;for(;E.firstChild;)L=E.firstChild,n.insertNode(L);T.removeAllRanges(),d(null),v()}}catch(w){console.error("AI Edit failed",w)}finally{x(!1),i.close(),f("")}}};return c.useEffect(()=>()=>{j.current&&clearTimeout(j.current)},[]),e.jsxs("div",{className:t("flex flex-col h-full border rounded-lg shadow-sm overflow-hidden",o.border.default,o.surface.default),children:[e.jsx(nl,{wordCount:p,onCmd:S,onSave:a?()=>a(l.current?.innerHTML||""):void 0}),e.jsxs("div",{className:"relative flex-1 overflow-hidden group",children:[e.jsx("div",{ref:l,className:t("h-full w-full p-8 outline-none overflow-y-auto prose prose-slate max-w-none transition-colors",`focus:${o.surface.highlight}`),contentEditable:!0,onMouseUp:C,onKeyUp:C,onInput:v,spellCheck:!1,suppressContentEditableWarning:!0}),!p&&r&&e.jsx("div",{className:t("absolute top-8 left-8 pointer-events-none text-lg",o.text.tertiary),children:r}),i.isOpen&&e.jsxs("div",{className:"absolute bottom-6 left-1/2 -translate-x-1/2 w-96 bg-white rounded-lg shadow-2xl border border-slate-200 p-2 flex gap-2 animate-in fade-in slide-in-from-bottom-2 z-20",children:[e.jsxs("div",{className:"flex-1 relative",children:[e.jsx(oe,{className:"absolute left-2.5 top-1/2 -translate-y-1/2 h-4 w-4 text-purple-600"}),e.jsx("input",{className:"w-full pl-9 pr-3 py-2 text-sm border border-slate-200 rounded bg-slate-50 focus:bg-white focus:ring-2 focus:ring-purple-500 focus:border-transparent outline-none transition-all",placeholder:"Ask AI to rewrite selection...",value:m,onChange:w=>f(w.target.value),onKeyDown:w=>w.key==="Enter"&&b(),autoFocus:!0})]}),e.jsx("button",{onClick:b,disabled:u,className:"px-4 py-2 bg-gradient-to-r from-purple-600 to-indigo-600 text-white rounded text-xs font-bold hover:shadow-lg disabled:opacity-50 transition-all flex items-center",children:u?e.jsx(Tt,{className:"h-3 w-3 animate-spin"}):"Refine"})]})]})]})};new Cr;const pt=64*1024;function ns(s){const a=new Uint8Array(s);return Array.from(a).map(r=>r.toString(16).padStart(2,"0")).join("")}async function cl(s,a){const r=[];let l=0;for(;l<s.size;){const i=await s.slice(l,l+a).arrayBuffer();r.push(new Uint8Array(i)),l+=a}return r}class dl{validateFile(a,r){if(!a||!(a instanceof File))throw new he(`[CryptoService.${r}] Invalid file parameter`);if(a.size===0)throw new he(`[CryptoService.${r}] File is empty: ${a.name}`)}validateString(a,r){if(a.length===0)throw new he(`[CryptoService.${r}] String is empty`)}validateBuffer(a,r){if(!a)throw new he(`[CryptoService.${r}] Invalid buffer parameter`);if(a.byteLength===0)throw new he(`[CryptoService.${r}] Buffer is empty`)}validateByteCount(a,r){if(a<=0||a>65536)throw new he(`[CryptoService.${r}] Invalid byte count (must be 1-65536)`)}async hashFile(a){this.validateFile(a,"hashFile");const r=performance.now();try{let l;if(a.size<pt){const i=await a.arrayBuffer(),n=await crypto.subtle.digest("SHA-256",i);l=ns(n)}else{const i=await cl(a,pt),n=i.reduce((u,x)=>u+x.length,0),d=new Uint8Array(n);let m=0;for(const u of i)d.set(u,m),m+=u.length;const f=await crypto.subtle.digest("SHA-256",d);l=ns(f)}const o=performance.now()-r;return console.debug(`[CryptoService] Hashed ${a.name} (${a.size} bytes) in ${o.toFixed(2)}ms`),{hash:l,fileName:a.name,size:a.size,processingTime:o}}catch(l){const o=`Failed to hash file ${a.name}: ${l instanceof Error?l.message:"Unknown error"}`;throw console.error(`[CryptoService.hashFile] ${o}`),new is("CryptoService.hashFile",o)}}async hashFiles(a){if(!Array.isArray(a))throw new he("[CryptoService.hashFiles] Invalid files parameter (must be array)");if(a.length===0)return console.warn("[CryptoService.hashFiles] Empty file array provided"),[];const r=[];for(const l of a)try{const o=await this.hashFile(l);r.push(o)}catch(o){r.push({error:o instanceof Error?o.message:"Unknown error",fileName:l.name})}return console.log(`[CryptoService] Batch hashed ${a.length} files (${r.filter(l=>"hash"in l).length} succeeded)`),r}async hashString(a){this.validateString(a,"hashString");try{const l=new TextEncoder().encode(a),o=await crypto.subtle.digest("SHA-256",l);return ns(o)}catch(r){throw console.error("[CryptoService.hashString] Error:",r),new is("CryptoService.hashString",`Failed to hash string: ${r instanceof Error?r.message:"Unknown error"}`)}}async hashBuffer(a){this.validateBuffer(a,"hashBuffer");try{const r=await crypto.subtle.digest("SHA-256",a);return ns(r)}catch(r){throw console.error("[CryptoService.hashBuffer] Error:",r),new is("CryptoService.hashBuffer",`Failed to hash buffer: ${r instanceof Error?r.message:"Unknown error"}`)}}async generateRandomHex(a=32){this.validateByteCount(a,"generateRandomHex");try{const r=new Uint8Array(a);return crypto.getRandomValues(r),Array.from(r).map(l=>l.toString(16).padStart(2,"0")).join("")}catch(r){throw console.error("[CryptoService.generateRandomHex] Error:",r),new is("CryptoService.generateRandomHex",`Failed to generate random hex: ${r instanceof Error?r.message:"Unknown error"}`)}}constantTimeCompare(a,r){if(a.length!==r.length)return!1;let l=0;for(let o=0;o<a.length;o++)l|=a.charCodeAt(o)^r.charCodeAt(o);return l===0}terminate(){console.debug("[CryptoService] Terminate called (no-op for native crypto)")}}const ml=new dl,ks=()=>new Promise(s=>setTimeout(s,0)),Zt={async uploadDocument(s,a){const r=`doc-${Date.now()}`,l={id:r,caseId:a.caseId||"General",title:s.name,type:a.type||s.type.split("/")[1]?.toUpperCase()||"FILE",content:"Binary content stored in secure blob storage.",uploadDate:new Date().toISOString().split("T")[0],lastModified:new Date().toISOString().split("T")[0],tags:["Uploaded","Local"],versions:[],fileSize:ht.fileSize(s.size),sourceModule:a.sourceModule||"General",status:"Draft",isEncrypted:!1};return await ws.put(xs.DOCUMENTS,l),await ws.putFile(r,s),l},async getDocumentUrl(s){try{const a=await ws.getFile(s);return a?Tr.create(a,`document-${s}`):null}catch(a){return console.error("Failed to load file blob",a),null}},async processFile(s){const a=crypto.randomUUID();await ks();const l="0x"+(await ml.hashFile(s)).hash;await ks();const o=Math.floor(Math.random()*5)+2,i=[];for(let d=1;d<=o;d++)await ks(),i.push({id:`${a}-p${d}`,pageNumber:d,contentPreview:`Extracted content from page ${d} of ${s.name}. This section contains key definitions and clauses verified against the master record.`,hash:"0x"+Math.floor(Math.random()*1e7).toString(16)+"..."});const n=["Uploaded",s.type.split("/")[1]||"Unknown"];return s.name.toLowerCase().includes("contract")&&n.push("Contract"),s.name.toLowerCase().includes("email")&&n.push("Correspondence"),{hash:l,uuid:a,chunks:i,tags:n,summary:`Auto-generated summary for ${s.name}. Parsed ${o} pages. Verified clean of malware. Authenticated source.`}},formatBytes:ht.fileSize,async verifyIntegrity(){return new Promise(s=>{setTimeout(()=>{s({verified:!0,timestamp:new Date().toISOString(),block:18452e3+Math.floor(Math.random()*5e3)})},2e3)})}},dc=Object.freeze(Object.defineProperty({__proto__:null,DocumentService:Zt},Symbol.toStringTag,{value:"Module"}));function ul(s){const{items:a,query:r,fields:l,idKey:o="id"}=s,i=c.useMemo(()=>a,[a.map(N=>String(N[o])).join(",")]),[n,d]=c.useState(i),[m,f]=c.useState(!1),u=c.useRef(null),x=c.useRef(0),p=c.useRef(null),h=c.useRef(i);c.useEffect(()=>(u.current=Pr.create(),u.current.onmessage=N=>{const{results:y,requestId:v}=N.data;v===x.current&&v===p.current&&(d(y),f(!1))},()=>{u.current?.terminate(),p.current!==null&&(p.current=null)}),[]);const j=JSON.stringify(l);return c.useEffect(()=>{const N=u.current;if(!(!N||!(h.current!==i)))if(h.current=i,N.postMessage({type:"UPDATE",payload:{items:a,fields:l,idKey:o}}),!r)d(i);else{const v=++x.current;p.current=v,f(!0),N.postMessage({type:"SEARCH",payload:{query:r,requestId:v}})}},[i,j,o]),c.useEffect(()=>{const N=u.current;if(!N)return;if(p.current!==null&&(p.current=null),!r){d(v=>v===i?v:i),f(!1);return}f(!0);const y=++x.current;p.current=y,N.postMessage({type:"SEARCH",payload:{query:r,requestId:y}})},[r,i]),{filteredItems:n,isSearching:m}}const mc=z.memo(({oldText:s,newText:a,oldLabel:r="Original",newLabel:l="Modified"})=>{const{theme:o}=D();return e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 h-full",children:[e.jsxs("div",{className:t("flex flex-col h-full border rounded-lg overflow-hidden",o.status.error.bg,o.status.error.border),children:[e.jsx("div",{className:t("px-4 py-2 border-b font-bold text-xs uppercase flex justify-between items-center",o.status.error.border,o.status.error.text),children:e.jsx("span",{children:r})}),e.jsx("div",{className:t("p-4 flex-1 overflow-y-auto text-sm font-mono whitespace-pre-wrap leading-relaxed",o.text.primary),children:s})]}),e.jsxs("div",{className:t("flex flex-col h-full border rounded-lg overflow-hidden",o.status.success.bg,o.status.success.border),children:[e.jsx("div",{className:t("px-4 py-2 border-b font-bold text-xs uppercase flex justify-between items-center",o.status.success.border,o.status.success.text),children:e.jsx("span",{children:l})}),e.jsx("div",{className:t("p-4 flex-1 overflow-y-auto text-sm font-mono whitespace-pre-wrap leading-relaxed",o.text.primary),children:a})]})]})}),Ve={image:"text-purple-600",video:"text-rose-600",audio:"text-pink-600",evidence:"text-amber-600",physical:"text-slate-600",default:"text-blue-600"},Fe=(s,a)=>t(s,a),vs=z.memo(({type:s,className:a="h-5 w-5"})=>{const r=s.toLowerCase();return r.includes("image")||r.includes("jpg")||r.includes("png")?e.jsx(Ca,{className:Fe(Ve.image,a)}):r.includes("video")||r.includes("mp4")?e.jsx(ka,{className:Fe(Ve.video,a)}):r.includes("audio")?e.jsx(Sa,{className:Fe(Ve.audio,a)}):r.includes("evidence")?e.jsx(Pe,{className:Fe(Ve.evidence,a)}):r.includes("physical")?e.jsx(Vs,{className:Fe(Ve.physical,a)}):e.jsx(Q,{className:Fe(Ve.default,a)})}),Qs=z.memo(({tags:s,limit:a=3})=>{const{theme:r}=D();return e.jsxs("div",{className:"flex flex-wrap gap-1.5",children:[s.slice(0,a).map(l=>e.jsx("span",{className:t("px-2 py-0.5 rounded text-[10px] font-medium border",r.surface.highlight,r.text.secondary,r.border.default),children:l},l)),s.length>a&&e.jsxs("span",{className:t("px-2 py-0.5 rounded text-[10px] font-medium opacity-70",r.surface.highlight,r.text.secondary),children:["+",s.length-a]})]})}),xl=z.memo(({doc:s,isSelected:a,toggleSelection:r,setSelectedDocForHistory:l,setTaggingDoc:o,onRowClick:i,theme:n})=>{const d=x=>{x.stopPropagation(),r(s.id,x)},m=x=>{x.stopPropagation(),l(s)},f=x=>{x.stopPropagation(),o(s)},u=x=>{x.shiftKey?r(s.id,x):i?i(s):r(s.id,x)};return e.jsxs("div",{className:t("flex items-center h-full cursor-pointer select-none",a?n.primary.light:""),onClick:u,children:[e.jsx("div",{className:"w-10 flex-shrink-0 flex justify-center",onClick:d,children:e.jsx("input",{type:"checkbox",checked:a,onChange:d,className:"rounded text-blue-600 focus:ring-blue-500 cursor-pointer"})}),e.jsxs("div",{className:"flex-1 min-w-0 flex items-center pr-4",children:[e.jsx("div",{className:t("p-2 rounded-lg mr-3 border transition-colors",n.surface.highlight,n.border.default,`group-hover:${n.border.default}`),children:e.jsx(vs,{type:s.type,className:"h-5 w-5"})}),e.jsxs("div",{className:"min-w-0",children:[e.jsx("div",{className:t("text-sm font-bold transition-colors truncate max-w-xs",n.text.primary,`group-hover:${n.primary.text}`),children:s.title}),e.jsxs("div",{className:t("text-xs mt-0.5",n.text.secondary),children:[s.type," • ",s.fileSize]})]})]}),e.jsx("div",{className:"w-28 flex-shrink-0",children:e.jsx(K,{variant:s.sourceModule==="Evidence"?"warning":s.sourceModule==="Discovery"?"info":"neutral",children:s.sourceModule})}),e.jsx("div",{className:"w-28 flex-shrink-0",children:s.status==="Signed"?e.jsxs("span",{className:t("flex items-center text-xs font-bold px-2 py-1 rounded w-fit",n.status.success.bg,n.status.success.text),children:[e.jsx(Ae,{className:"h-3 w-3 mr-1"})," Signed"]}):s.status==="Draft"?e.jsxs("span",{className:t("flex items-center text-xs px-2 py-1 rounded w-fit",n.status.neutral.bg,n.status.neutral.text),children:[e.jsx(ce,{className:"h-3 w-3 mr-1"})," Draft"]}):e.jsx("span",{className:t("flex items-center text-xs font-medium px-2 py-1 rounded w-fit",n.primary.light,n.primary.text),children:"Final"})}),e.jsx("div",{className:"w-48 flex-shrink-0",children:e.jsxs("div",{className:"flex flex-col gap-1.5",children:[e.jsxs("div",{className:"flex gap-1 items-center",children:[e.jsx(Qs,{tags:[...s.tags],limit:2}),e.jsx("button",{onClick:f,className:t("opacity-0 group-hover:opacity-100 transition-opacity p-0.5 rounded",n.text.secondary,`hover:${n.surface.highlight}`,`hover:${n.primary.text}`),children:e.jsx(_a,{className:"h-3 w-3"})})]}),s.linkedRules&&s.linkedRules.length>0&&e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(Da,{className:"h-3 w-3 text-purple-400"}),e.jsx("span",{className:"text-[10px] text-purple-600 font-medium truncate max-w-[100px]",children:s.linkedRules.join(", ")})]})]})}),e.jsx("div",{className:t("w-32 flex-shrink-0 whitespace-nowrap text-sm",n.text.secondary),children:s.lastModified}),e.jsx("div",{className:"w-24 flex-shrink-0 flex justify-end",children:e.jsxs("div",{className:"flex justify-end space-x-1 opacity-0 group-hover:opacity-100 transition-opacity",onClick:x=>x.stopPropagation(),children:[e.jsx("button",{className:t("p-1.5 rounded",n.text.secondary,`hover:${n.primary.text}`,`hover:${n.primary.light}`),children:e.jsx($e,{className:"h-4 w-4"})}),e.jsx("button",{onClick:m,className:t("p-1.5 rounded",n.text.secondary,`hover:${n.primary.text}`,`hover:${n.primary.light}`),title:"View History",children:e.jsx(Be,{className:"h-4 w-4"})}),e.jsx("button",{className:t("p-1.5 rounded",n.text.secondary,`hover:${n.primary.text}`,`hover:${n.primary.light}`),children:e.jsx(Ta,{className:"h-4 w-4"})})]})})]})},(s,a)=>s.doc===a.doc&&s.isSelected===a.isSelected);xl.displayName="DocumentRow";function xe(s,a){const r=a.toLowerCase().split("+"),l=r[r.length-1],o=r.includes("ctrl"),i=r.includes("shift"),n=r.includes("alt"),d=s.ctrlKey||s.metaKey;return s.key.toLowerCase()===l&&(!o||d)&&(!i||s.shiftKey)&&(!n||s.altKey)&&o===d&&i===s.shiftKey&&n===s.altKey}function ys(s,a=!0){const r=c.useCallback(l=>{if(!a)return;const o=l.target;if(o.tagName==="INPUT"||o.tagName==="TEXTAREA"||o.isContentEditable)return;if(Array.isArray(s)){for(const n of s){const d=(!n.cmd||l.ctrlKey||l.metaKey)&&(!n.ctrl||l.ctrlKey)&&(!n.ctrlOrCmd||l.ctrlKey||l.metaKey)&&(!n.shift||l.shiftKey)&&(!n.alt||l.altKey),m=l.key.toLowerCase()===n.key.toLowerCase();if(d&&m){l.preventDefault();const f=n.callback||n.action;f&&f();return}}return}if((n=>typeof n=="object"&&n!==null&&!Array.isArray(n))(s)){if(xe(l,ge.UNDO)&&s.onUndo){l.preventDefault(),s.onUndo();return}if(xe(l,ge.REDO)&&s.onRedo){l.preventDefault(),s.onRedo();return}if((l.key==="Delete"||l.key==="Backspace")&&s.onDelete&&!l.ctrlKey&&!l.metaKey){l.preventDefault(),s.onDelete();return}if(xe(l,ge.COPY)&&s.onCopy){l.preventDefault(),s.onCopy();return}if(xe(l,ge.PASTE)&&s.onPaste){l.preventDefault(),s.onPaste();return}if(xe(l,ge.DUPLICATE)&&s.onDuplicate){l.preventDefault(),s.onDuplicate();return}if(xe(l,ge.SELECT_ALL)&&s.onSelectAll){l.preventDefault(),s.onSelectAll();return}if(xe(l,ge.ZOOM_IN)&&s.onZoomIn){l.preventDefault(),s.onZoomIn();return}if(xe(l,ge.ZOOM_OUT)&&s.onZoomOut){l.preventDefault(),s.onZoomOut();return}if(xe(l,ge.ZOOM_RESET)&&s.onZoomReset){l.preventDefault(),s.onZoomReset();return}if(xe(l,ge.SAVE)&&s.onSave){l.preventDefault(),s.onSave();return}}if(typeof s=="object"&&s!==null&&!Array.isArray(s)){const n=s;for(const[d,m]of Object.entries(n))if(typeof m=="function"&&xe(l,d)){l.preventDefault(),m();return}}},[s,a]);c.useEffect(()=>{if(a)return window.addEventListener("keydown",r),()=>{window.removeEventListener("keydown",r)}},[r,a])}function hl(){const s=c.useRef(new Set),a=c.useCallback(l=>{const o=URL.createObjectURL(l);return s.current.add(o),o},[]),r=c.useCallback(l=>{s.current.has(l)&&(URL.revokeObjectURL(l),s.current.delete(l))},[]);return c.useEffect(()=>()=>{s.current.forEach(l=>{URL.revokeObjectURL(l)}),s.current.clear()},[]),{register:a,revoke:r}}function fl({content:s,onApplyRedactions:a}){const{theme:r}=D(),[l,o]=c.useState([]),[i,n]=c.useState(!0);c.useEffect(()=>{let f=!1;const x=setTimeout(async()=>{n(!0);const p=[],h=/[a-zA-Z0-9._-]+@[a-zA-Z0-9._-]+\.[a-zA-Z0-9_-]+/g,j=/\(?([0-9]{3})\)?[-. ]?([0-9]{3})[-. ]?([0-9]{4})/g;let N,y=0;for(;(N=h.exec(s))!==null;){if(f)return;p.push({id:`pii-e-${N.index}`,type:"Email",value:N[0],index:N.index,ignored:!1}),y++,y%10===0&&await ot()}for(;(N=j.exec(s))!==null;){if(f)return;p.push({id:`pii-p-${N.index}`,type:"Phone",value:N[0],index:N.index,ignored:!1}),y++,y%10===0&&await ot()}p.length===0&&s.length>0&&(p.push({id:"mock-1",type:"SSN",value:"***-**-1234",index:0,ignored:!1}),p.push({id:"mock-2",type:"CreditCard",value:"****-****-****-4242",index:0,ignored:!1})),f||(o(p),n(!1))},500);return()=>{f=!0,clearTimeout(x)}},[s]);const d=f=>{o(u=>u.map(x=>x.id===f?{...x,ignored:!x.ignored}:x))},m=()=>{a("Redacted Content")};return e.jsxs("div",{className:t("w-80 border-l flex flex-col",r.surface.highlight,r.border.default),children:[e.jsxs("div",{className:t("p-4 border-b flex justify-between items-center",r.surface.default,r.border.default),children:[e.jsxs("h3",{className:t("font-bold text-sm flex items-center",r.text.primary),children:[e.jsx(Me,{className:"h-4 w-4 mr-2 text-amber-600"})," PII Detection"]}),e.jsxs("span",{className:"text-xs bg-amber-100 text-amber-700 px-2 py-0.5 rounded-full font-bold",children:[l.filter(f=>!f.ignored).length," Found"]})]}),e.jsx("div",{className:"flex-1 overflow-y-auto p-4 space-y-3",children:i?e.jsx("div",{className:t("text-center py-8",r.text.tertiary),children:"Scanning document..."}):l.map(f=>e.jsxs("div",{className:t("p-3 rounded border transition-opacity",r.surface.default,r.border.default,f.ignored?"opacity-50":"shadow-sm"),children:[e.jsxs("div",{className:"flex justify-between items-start mb-1",children:[e.jsx("span",{className:t("text-[10px] font-bold uppercase tracking-wide px-1.5 rounded border",f.type==="SSN"?"bg-red-50 text-red-700 border-red-100":f.type==="CreditCard"?"bg-purple-50 text-purple-700 border-purple-100":"bg-blue-50 text-blue-700 border-blue-100"),children:f.type}),e.jsx("button",{onClick:()=>d(f.id),className:t("hover:text-slate-600",r.text.tertiary),children:f.ignored?e.jsx(Ea,{className:"h-4 w-4"}):e.jsx(Be,{className:"h-4 w-4"})})]}),e.jsx("p",{className:t("font-mono text-sm",f.ignored?"line-through text-slate-400":r.text.primary),children:f.value})]},f.id))}),e.jsxs("div",{className:t("p-4 border-t space-y-3",r.surface.default,r.border.default),children:[e.jsxs("div",{className:t("flex items-start gap-2 text-xs",r.text.secondary),children:[e.jsx(be,{className:"h-4 w-4 text-amber-500 shrink-0"}),e.jsx("p",{children:"Redaction is permanent. A new version of the document will be created."})]}),e.jsx(_,{variant:"primary",className:"w-full bg-slate-900 hover:bg-slate-800",onClick:m,disabled:i,children:"Redact Selected"})]})]})}yr.workerSrc="https://esm.sh/pdfjs-dist@4.0.379/build/pdf.worker.min.mjs";const Yt=z.memo(({url:s,scale:a=1,rotation:r=0,onPageLoad:l,children:o})=>{const{theme:i}=D(),n=c.useRef(null),d=c.useRef(null),[m,f]=c.useState(null),[u,x]=c.useState(1),[p,h]=c.useState(!1),[j,N]=c.useState(null),[y,v]=c.useState({width:0,height:0}),[S,C]=c.useState(0),b=c.useRef(null),w=c.useRef(null),g=c.useRef(!1),T=c.useRef(null);c.useEffect(()=>(g.current=!0,()=>{g.current=!1}),[]),c.useEffect(()=>{if(!n.current)return;const L=new ResizeObserver(W=>{if(!W||W.length===0)return;const X=W[0].contentRect.width;T.current&&clearTimeout(T.current),T.current=setTimeout(()=>{g.current&&X>0&&C(X)},200)});return L.observe(n.current),n.current&&C(n.current.clientWidth),()=>{L.disconnect(),T.current&&clearTimeout(T.current)}},[]),c.useEffect(()=>s?(w.current&&(w.current.destroy(),w.current=null),(async()=>{h(!0),N(null);try{const W=Nr(s);w.current=W;const X=await W.promise;g.current&&(f(X),x(1))}catch(W){console.error("Error loading PDF:",W),g.current&&N("Failed to load document. File may be corrupted or restricted.")}finally{g.current&&h(!1)}})(),()=>{w.current&&w.current.destroy()}):void 0,[s]);const E=c.useCallback(async()=>{if(!(!m||!d.current||S===0)){if(b.current)try{b.current.cancel()}catch{}try{const L=await m.getPage(u),W=L.getViewport({scale:1,rotation:r}),me=Math.max(S-64,300)/W.width*a,M=L.getViewport({scale:me,rotation:r}),R=d.current;if(!R)return;const te=R.getContext("2d");if(!te)return;const P=window.devicePixelRatio||1;R.width=Math.floor(M.width*P),R.height=Math.floor(M.height*P);const O=Math.floor(M.width),$=Math.floor(M.height);R.style.width=O+"px",R.style.height=$+"px",g.current&&(v({width:O,height:$}),l&&l({width:O,height:$}));const H=P!==1?[P,0,0,P,0,0]:void 0,ee=H?{canvasContext:te,transform:H,viewport:M}:{canvasContext:te,viewport:M},se=L.render(ee);b.current=se,await se.promise}catch(L){(typeof L=="object"&&L!==null&&"name"in L?String(L.name):"")!=="RenderingCancelledException"&&console.error("Render error:",L)}}},[m,u,a,r,l,S]);return c.useEffect(()=>{E()},[E]),s?e.jsxs("div",{ref:n,className:t("flex flex-col items-center p-8 min-h-full relative overflow-auto w-full",i.background),children:[p&&e.jsxs("div",{className:t("absolute inset-0 flex flex-col items-center justify-center z-20 backdrop-blur-sm",i.surface.default,"bg-opacity-80"),children:[e.jsx(re,{className:"h-10 w-10 animate-spin text-blue-600 mb-3"}),e.jsx("span",{className:t("text-sm font-medium",i.text.secondary),children:"Rendering..."})]}),j?e.jsxs("div",{className:t("flex flex-col items-center p-8 rounded-lg border",i.status.error.bg,i.status.error.border,i.status.error.text),children:[e.jsx(je,{className:"h-8 w-8 mb-2"}),e.jsx("p",{className:"font-medium",children:j})]}):e.jsxs("div",{className:t("relative shadow-2xl border transition-all duration-200 ease-out origin-top",i.surface.default,i.border.default),style:{width:y.width,height:y.height},children:[e.jsx("canvas",{ref:d,className:"block absolute inset-0"}),e.jsx("div",{className:"absolute inset-0 z-10",children:o})]})]}):null});Yt.displayName="PDFViewer";const pl=z.memo(({value:s,onChange:a,label:r="Digital Signature",subtext:l="I certify this record is accurate.",isSigning:o})=>{const{theme:i}=D(),[n,d]=c.useState(!1),m=()=>{s||(d(!0),setTimeout(()=>{d(!1),a(!0)},800))},f=x=>{x.stopPropagation(),a(!1)},u=o||n;return e.jsx("div",{className:"relative",children:e.jsxs("div",{className:t("p-4 rounded-lg border-2 border-dashed transition-all cursor-pointer group relative overflow-hidden",s?t(i.status.info.bg,i.status.info.border):t(i.surface.highlight,i.border.default,`hover:${i.border.default}`)),onClick:m,children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:t("w-10 h-10 rounded-full flex items-center justify-center transition-all",s?t(i.primary.DEFAULT,i.text.inverse):t(i.surface.default,i.border.default,"border text-slate-400 group-hover:border-slate-300")),children:u?e.jsx(Aa,{className:"h-5 w-5 animate-spin"}):s?e.jsx(ie,{className:"h-6 w-6"}):e.jsx(ss,{className:"h-5 w-5"})}),e.jsxs("div",{children:[e.jsx("span",{className:t("block text-sm font-bold",s?i.primary.text:i.text.primary),children:s?"Signed & Verified":r}),e.jsx("span",{className:t("text-xs",i.text.secondary),children:l})]})]}),s&&e.jsx("div",{className:"absolute top-0 right-0 p-2",children:e.jsx("button",{onClick:f,className:t("p-1 rounded-full transition-colors",i.action.danger.hover,i.text.secondary),title:"Clear Signature","aria-label":"Clear Signature",children:e.jsx(Se,{className:"h-4 w-4"})})})]})})});function gl({activeTool:s,setActiveTool:a,scale:r,setScale:l,setRotation:o,pageNum:i,setPageNum:n,totalPages:d}){const{theme:m}=D(),f=({tool:u,icon:x,label:p})=>e.jsxs("button",{onClick:()=>a(u),className:t("p-2 rounded-md flex flex-col items-center justify-center gap-1 transition-all w-16 h-14",s===u?t(m.primary.light,m.primary.text,"ring-1 shadow-inner",m.primary.border):t(m.text.secondary,`hover:${m.surface.highlight}`,`hover:${m.text.primary}`)),title:p,children:[e.jsx(x,{className:"h-5 w-5"}),e.jsx("span",{className:"text-[9px] font-semibold uppercase tracking-tight",children:p})]});return e.jsxs("div",{className:t("h-16 border-b flex items-center justify-between px-4 shrink-0 shadow-sm",m.border.default,m.surface.default),children:[e.jsxs("div",{className:t("flex items-center gap-2 border-r pr-4 mr-4 h-10",m.border.default),children:[e.jsx(f,{tool:"select",icon:Ia,label:"Select"}),e.jsx(f,{tool:"pen",icon:ss,label:"Draw"}),e.jsx(f,{tool:"highlight",icon:_t,label:"Highlight"}),e.jsx(f,{tool:"text",icon:Pa,label:"Type"})]}),e.jsxs("div",{className:t("flex items-center gap-2 border-r pr-4 mr-4 h-10",m.border.default),children:[e.jsx(f,{tool:"signature",icon:Ra,label:"Sign"}),e.jsx(f,{tool:"initials",icon:La,label:"Initial"}),e.jsx(f,{tool:"date",icon:pe,label:"Date"})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:t("flex items-center rounded-lg p-1",m.surface.highlight),children:[e.jsx("button",{onClick:()=>n(u=>Math.max(1,u-1)),className:t("p-1.5 rounded shadow-sm disabled:opacity-30",m.surface.default,m.text.secondary,`hover:${m.text.primary}`),children:e.jsx(Ma,{className:"h-4 w-4"})}),e.jsxs("span",{className:t("text-xs font-mono w-16 text-center",m.text.secondary),children:[i," / ",d||"-"]}),e.jsx("button",{onClick:()=>n(u=>u+1),className:t("p-1.5 rounded shadow-sm disabled:opacity-30",m.surface.default,m.text.secondary,`hover:${m.text.primary}`),children:e.jsx(Fs,{className:"h-4 w-4"})})]}),e.jsxs("div",{className:t("flex items-center gap-1"),children:[e.jsx("button",{onClick:()=>o(u=>(u-90)%360),className:t("p-2 rounded",m.text.tertiary,`hover:${m.surface.highlight}`),children:e.jsx(Tt,{className:"h-4 w-4"})}),e.jsx("button",{onClick:()=>o(u=>(u+90)%360),className:t("p-2 rounded",m.text.tertiary,`hover:${m.surface.highlight}`),children:e.jsx(Oa,{className:"h-4 w-4"})})]}),e.jsxs("div",{className:t("flex items-center rounded-lg p-1",m.surface.highlight),children:[e.jsx("button",{onClick:()=>l(u=>Math.max(.5,u-.1)),className:t("p-1.5 rounded shadow-sm",m.surface.default,m.text.secondary,`hover:${m.text.primary}`),children:e.jsx(za,{className:"h-4 w-4"})}),e.jsxs("span",{className:t("text-xs font-mono w-12 text-center",m.text.secondary),children:[Math.round(r*100),"%"]}),e.jsx("button",{onClick:()=>l(u=>Math.min(3,u+.1)),className:t("p-1.5 rounded shadow-sm",m.surface.default,m.text.secondary,`hover:${m.text.primary}`),children:e.jsx($a,{className:"h-4 w-4"})})]})]})]})}function jl({activeTool:s,dimensions:a,onFieldClick:r,existingFields:l=[],onFieldsUpdate:o}){const{theme:i}=D(),n=c.useRef(null),[d,m]=c.useState([]),[f,u]=c.useState(l),[x,p]=c.useState(!1),[h,j]=c.useState([]);c.useEffect(()=>{u(l)},[l]),c.useEffect(()=>{const b=n.current;if(!b)return;const w=b.getContext("2d");w&&(w.clearRect(0,0,a.width,a.height),w.lineCap="round",w.lineJoin="round",d.forEach(g=>{g.points.length<2||(w.beginPath(),w.moveTo(g.points[0].x,g.points[0].y),g.points.forEach(T=>w.lineTo(T.x,T.y)),w.strokeStyle=g.color,w.lineWidth=g.width,w.globalAlpha=g.opacity,w.stroke())}),w.globalAlpha=1)},[d,a]);const N=b=>{const w=n.current;if(!w)return{x:0,y:0};const g=w.getBoundingClientRect();return{x:b.clientX-g.left,y:b.clientY-g.top}},y=b=>{const w=N(b);if(s==="pen"||s==="highlight")p(!0),j([w]);else if(["signature","date","initials","text"].includes(s)){const g={id:`f-${Date.now()}`,type:s,x:w.x-60,y:w.y-20,value:s==="date"?new Date().toLocaleDateString():""},T=[...f,g];u(T),o&&o(T)}},v=b=>{if(!x)return;const w=N(b);j(E=>[...E,w]);const g=n.current,T=g?.getContext("2d");if(g&&T&&h.length>0){T.beginPath();const E=h[h.length-1];T.moveTo(E.x,E.y),T.lineTo(w.x,w.y),T.strokeStyle=s==="highlight"?i.chart.colors.warning:i.chart.colors.danger,T.lineWidth=s==="highlight"?12:2,T.globalAlpha=s==="highlight"?.4:1,T.stroke()}},S=()=>{if(x){p(!1);const b={id:`d-${Date.now()}`,type:s==="highlight"?"highlight":"pen",points:h,color:s==="highlight"?i.chart.colors.warning:i.chart.colors.danger,width:s==="highlight"?12:2,opacity:s==="highlight"?.4:1};m([...d,b]),j([])}},C=b=>{const w=f.filter(g=>g.id!==b);u(w),o&&o(w)};return e.jsxs("div",{className:"absolute inset-0 w-full h-full",children:[e.jsx("canvas",{ref:n,width:a.width,height:a.height,className:t("absolute inset-0 z-10",s==="select"?"pointer-events-none":"cursor-crosshair"),onMouseDown:y,onMouseMove:v,onMouseUp:S}),e.jsx("div",{className:"absolute inset-0 z-20 pointer-events-none",children:f.map(b=>e.jsxs("div",{className:t("absolute pointer-events-auto border-2 rounded flex items-center justify-center group cursor-pointer shadow-lg transition-transform hover:scale-105",i.primary.border,i.surface.highlight,b.type==="signature"?"w-40 h-16":b.type==="text"?"w-48 h-8":"w-32 h-10"),style:{left:b.x,top:b.y},onClick:()=>r(b),children:[b.value?e.jsx("span",{className:t("font-handwriting text-xl",i.primary.text,b.type==="date"&&"font-mono text-sm font-bold"),children:b.value}):e.jsx("span",{className:t("text-xs font-bold uppercase tracking-widest",i.text.tertiary),children:b.type}),e.jsx("button",{onClick:w=>{w.stopPropagation(),C(b.id)},className:t("absolute -top-2 -right-2 text-white rounded-full p-0.5 opacity-0 group-hover:opacity-100 transition-opacity shadow-sm",i.status.error.bg),children:e.jsx(Se,{className:"h-3 w-3"})}),e.jsx("div",{className:t("absolute top-0 left-0 p-1 opacity-0 group-hover:opacity-50",i.primary.text),children:e.jsx(Va,{className:"h-3 w-3"})})]},b.id))})]})}function bl({document:s,previewUrl:a,isRedactionMode:r}){const{theme:l}=D(),o=s.type.includes("IMAGE")||s.type.includes("PNG")||s.type.includes("JPG"),i=s.type.toUpperCase().includes("PDF")||s.title.toLowerCase().endsWith(".pdf"),[n,d]=c.useState("select"),[m,f]=c.useState(1),[u,x]=c.useState(0),[p,h]=c.useState(1),[j,N]=c.useState({width:0,height:0}),[y,v]=c.useState(!1),[S,C]=c.useState(null),b=g=>{(g.type==="signature"||g.type==="initials")&&(C(g),v(!0))},w=g=>{g&&S&&(S.value="Signed by User",v(!1),C(null))};return i?e.jsxs("div",{className:t("flex flex-col h-full border rounded-lg overflow-hidden shadow-sm",l.border.default,l.surface.default),children:[e.jsx(gl,{activeTool:n,setActiveTool:d,scale:m,setScale:f,rotation:u,setRotation:x,pageNum:p,setPageNum:h,totalPages:10}),e.jsx("div",{className:t("flex-1 relative overflow-auto",l.surface.highlight),children:a?e.jsx(Yt,{url:a,scale:m,rotation:u,onPageLoad:N,children:e.jsx(jl,{activeTool:n,dimensions:j,onFieldClick:b})}):e.jsx("div",{className:t("flex items-center justify-center h-full",l.text.tertiary),children:e.jsx("p",{className:"text-sm",children:"No PDF source available."})})}),e.jsx(Ne,{isOpen:y,onClose:()=>v(!1),title:"Sign Document",size:"sm",children:e.jsxs("div",{className:"p-6",children:[e.jsx("p",{className:t("text-sm mb-4",l.text.secondary),children:"Draw your signature below to sign this field."}),e.jsx(pl,{value:!1,onChange:w,label:"Draw Signature",subtext:"I certify this signature is valid."}),e.jsx("div",{className:"mt-4 flex justify-end",children:e.jsx(_,{variant:"secondary",onClick:()=>v(!1),children:"Cancel"})})]})})]}):e.jsx("div",{className:t("border rounded-lg overflow-hidden flex items-center justify-center min-h-[400px] relative group",l.surface.highlight,l.border.default),children:o&&a?e.jsx("img",{src:a,alt:"Preview",className:"max-w-full max-h-[600px] object-contain",style:r?{filter:"blur(8px)"}:{}}):e.jsxs("div",{className:"text-center p-4",children:[e.jsx(vs,{type:s.type,className:t("h-16 w-16 mx-auto mb-4 opacity-50",l.text.tertiary)}),e.jsx("p",{className:t("text-sm font-medium mb-2",l.text.secondary),children:"Preview not available for this file type."}),a&&e.jsx("a",{href:a,download:s.title,className:t("hover:underline text-xs",l.primary.text),children:"Download File"})]})})}function vl({document:s,onCloseMobile:a}){const{theme:r}=D();return e.jsxs("div",{className:t("p-5 border-b relative shrink-0",r.border.default,r.surface.default),children:[e.jsx("div",{className:"md:hidden absolute top-3 right-3",children:e.jsx("button",{onClick:a,className:t("p-2 rounded-full",r.surface.highlight,r.text.secondary),children:e.jsx(ts,{className:"h-5 w-5"})})}),s.isEncrypted&&e.jsx("div",{className:"absolute top-0 right-0 p-2 hidden md:block",children:e.jsx(Oe,{className:"h-5 w-5 text-amber-500"})}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsxs("div",{className:t("p-3 border rounded-lg shadow-sm relative",r.surface.highlight,r.border.default),children:[e.jsx(vs,{type:s.type,className:"h-8 w-8"}),s.isEncrypted&&e.jsx("div",{className:t("absolute -bottom-1 -right-1 rounded-full",r.surface.default),children:e.jsx(Oe,{className:"h-3 w-3 text-amber-500"})})]}),e.jsxs("div",{className:"flex-1 min-w-0 pr-8 md:pr-0",children:[e.jsx("h3",{className:t("font-bold text-sm line-clamp-2 leading-snug",r.text.primary),children:s.title}),e.jsx("p",{className:t("text-xs mt-1",r.text.secondary),children:s.type})]})]}),e.jsxs("div",{className:t("mt-4 flex items-center justify-between p-2 border rounded text-xs",r.status.success.bg,r.status.success.border,r.status.success.text),children:[e.jsxs("span",{className:"flex items-center font-medium",children:[e.jsx(Fa,{className:"h-3 w-3 mr-1.5"})," Data Quality"]}),e.jsx("span",{className:"font-bold",children:"98%"})]})]})}function Qt({document:s,onViewHistory:a,onUpdate:r,userRole:l="Associate",isOrbital:o=!1,onCloseMobile:i}){const{theme:n}=D(),{openWindow:d}=_e(),m=De(),[f,u]=c.useState(null),[x,p]=c.useState(!1),{register:h}=hl(),{mutate:j,isLoading:N}=le(I.documents.redact,{onSuccess:()=>{m.success("Document redacted and saved as new version."),p(!1),Y.invalidate(U.documents.all())}});c.useEffect(()=>{let b=!0;return s&&s.tags.includes("Local")?(async()=>{const g=await I.documents.getFile(s.id);if(b&&g){const T=h(g);u(T)}})():u(null),()=>{b=!1}},[s,h]);const y=()=>{if(!(!s||!r)){if(!["Senior Partner","Administrator"].includes(l)){alert("Access Denied: Only Senior Partners and Administrators can modify encryption settings.");return}r(s.id,{isEncrypted:!s.isEncrypted})}},v=()=>{s&&d(`doc-preview-${s.id}`,`Inspector: ${s.title}`,e.jsx("div",{className:t("h-full overflow-hidden flex flex-col",n.background),children:e.jsx(Qt,{document:s,onViewHistory:a,onUpdate:r,userRole:l,isOrbital:!0})}))},S=()=>{s&&j(s.id)},C=c.useMemo(()=>s?.summary?x?s.summary.replace(/(\b[A-Z][a-z]*\b)|(\d{2}\/\d{2}\/\d{4})|([a-zA-Z0-9._-]+@[a-zA-Z0-9._-]+\.[a-zA-Z0-9_-]+)/g,"██████"):s.summary:"",[s?.summary,x]);return s?e.jsxs("div",{className:t("flex flex-row overflow-hidden animate-in slide-in-from-bottom md:slide-in-from-right duration-300",n.surface.default,!o&&"fixed inset-x-0 bottom-0 h-[85vh] z-50 rounded-t-2xl shadow-2xl border-t md:static md:h-full md:w-auto md:min-w-[320px] md:border-l md:rounded-none md:shadow-none md:z-auto",o&&"h-full w-full",n.border.default),children:[x&&e.jsx("div",{className:"hidden lg:flex border-r w-80 shrink-0 animate-in slide-in-from-left duration-200",children:e.jsx(fl,{content:s.content,onApplyRedactions:S})}),e.jsxs("div",{className:"flex-1 flex flex-col min-w-0",children:[e.jsx("div",{className:"md:hidden flex justify-center pt-3 pb-1",onClick:i,children:e.jsx("div",{className:"w-12 h-1.5 bg-slate-300 rounded-full"})}),e.jsx(vl,{document:s,onCloseMobile:i}),e.jsxs("div",{className:"flex-1 overflow-y-auto p-5 space-y-6 relative",children:[x&&e.jsx("div",{className:"absolute top-0 left-0 right-0 bg-amber-500 text-white text-xs font-bold text-center py-1 z-10",children:"REDACTION MODE ACTIVE"}),e.jsx(bl,{document:s,previewUrl:f,isRedactionMode:x}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[!o&&e.jsx(_,{variant:"secondary",size:"sm",className:"w-full hidden md:flex",icon:fs,onClick:v,children:"Pop Out"}),e.jsx(_,{variant:x?"primary":"outline",size:"sm",className:t("w-full",x?"bg-slate-900 border-slate-900":""),icon:x?Se:Ba,onClick:()=>p(!x),isLoading:N,children:N?"Burning...":x?"Cancel Redaction":"Redact"})]}),e.jsx("div",{className:t("p-4 rounded-lg border shadow-sm",n.surface.default,n.border.default),children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:t("text-xs font-bold uppercase tracking-wide",n.text.tertiary),children:"Security"}),e.jsx("button",{onClick:y,children:s.isEncrypted?e.jsx(Oe,{className:"h-4 w-4 text-amber-500"}):e.jsx(Wa,{className:"h-4 w-4 text-slate-400"})})]})}),e.jsxs("div",{children:[e.jsx("h4",{className:t("text-xs font-bold uppercase tracking-wide mb-3",n.text.tertiary),children:"Tags"}),e.jsx(Qs,{tags:[...s.tags]})]}),s.summary&&e.jsxs("div",{className:t("p-4 rounded-lg border shadow-sm relative overflow-hidden group",n.surface.default,n.primary.border),children:[e.jsx("div",{className:t("absolute top-0 left-0 w-1 h-full transition-all group-hover:w-1.5",n.primary.DEFAULT)}),e.jsxs("h4",{className:t("text-xs font-bold mb-2 flex items-center",n.primary.text),children:[e.jsx(oe,{className:"h-3 w-3 mr-1"})," ",x?"Redacted Summary":"AI Summary"]}),e.jsx("p",{className:t("text-xs leading-relaxed",n.text.secondary),children:C})]}),e.jsx("div",{className:t("pt-4 border-t pb-12 md:pb-0",n.border.default),children:e.jsx(_,{variant:"outline",className:"w-full",onClick:()=>a(s),children:"View Version History"})})]})]})]}):e.jsxs("div",{className:"hidden md:flex flex-col items-center justify-center h-full p-6 text-center text-slate-400",children:[e.jsx(je,{className:"h-8 w-8 opacity-50 mb-2"}),e.jsx("p",{className:"text-sm",children:"No document selected"})]})}const uc=z.memo(s=>{const{items:a,itemHeight:r,itemWidth:l,renderItem:o,className:i,emptyMessage:n="No items found",gap:d=16,height:m,getItemKey:f}=s,{theme:u}=D(),x=c.useRef(null),[p,h]=c.useState(0),[j,N]=c.useState({width:0,height:0}),y=c.useRef(null),v=c.useDeferredValue(a);c.useEffect(()=>{if(!x.current)return;const H=new ResizeObserver(ee=>{y.current&&cancelAnimationFrame(y.current),y.current=requestAnimationFrame(()=>{for(const se of ee)N({width:se.contentRect.width,height:se.contentRect.height})})});return H.observe(x.current),N({width:x.current.clientWidth,height:x.current.clientHeight}),()=>{H.disconnect(),y.current&&cancelAnimationFrame(y.current)}},[]);const S=l||250,C=r||180,b=d||16,w=j.width||0,g=j.height||0,T=Math.max(1,Math.floor((w+b)/(S+b))),E=Math.ceil((v?.length||0)/T),L=Math.max(0,E*(C+b)-b),W=Math.max(L,g),X=isNaN(W)?0:W,me=2,M=Math.max(0,Math.floor(p/(C+b))-me),R=g>0?Math.ceil(g/(C+b))+2*me:5,te=Math.min(E,M+R),P=c.useMemo(()=>{const H=[];for(let ee=M;ee<te;ee++)for(let se=0;se<T;se++){const Te=ee*T+se;if(Te<v.length){const ls=T*S+(T-1)*b,Ns=(w-ls)/2;H.push({index:Te,data:v[Te],top:ee*(C+b),left:se*(S+b)+Math.max(0,Ns)})}}return H},[v,M,te,T,C,S,b,w]),O=H=>{const ee=H.currentTarget.scrollTop;requestAnimationFrame(()=>h(ee))},$=(H,ee)=>{if(f)return f(H);if(H&&typeof H=="object"&&"id"in H){const se=H.id;if(typeof se=="string"||typeof se=="number")return se}return ee};return v.length===0?e.jsx("div",{className:t("flex items-center justify-center h-full text-slate-400",u.text.tertiary),children:n}):e.jsx("div",{ref:x,className:t("overflow-y-auto relative custom-scrollbar will-change-scroll h-full",i),style:{height:typeof m=="number"?`${m}px`:m},onScroll:O,children:e.jsx("div",{style:{height:X,position:"relative"},children:P.map(({index:H,data:ee,top:se,left:Te})=>e.jsx("div",{style:{position:"absolute",top:0,left:0,width:S,height:C,transform:`translate3d(${Te}px, ${se}px, 0)`,willChange:"transform",contain:"strict"},children:o(ee,H)},$(ee,H)))})})}),Xt=c.memo(({activeView:s,selectedCaseId:a})=>{const{activeTime:r,isIdle:l}=Rr(s,a);return r===0?null:e.jsx("div",{className:t("absolute top-0 right-0 h-0.5 bg-green-500 transition-all duration-1000 z-[60] pointer-events-none",l?"opacity-0":"opacity-100"),style:{width:`${Math.min(r%60/60*100,100)}%`}})});Xt.displayName="PassiveTimeTracker";const yl=z.memo(({sidebar:s,headerContent:a,children:r,activeView:l,onNavigate:o,selectedCaseId:i})=>{const{theme:n}=D(),{isFetching:d}=Lr();return e.jsxs("div",{className:t("flex h-[100dvh] w-screen font-sans overflow-hidden transition-colors duration-200 relative",n.background,n.text.primary),children:[e.jsx("div",{className:t("absolute top-0 left-0 right-0 h-0.5 z-[9000] bg-blue-500 transition-opacity duration-300",d?"opacity-100":"opacity-0"),children:e.jsx("div",{className:"absolute inset-0 bg-inherit opacity-50 animate-pulse"})}),s,e.jsxs("div",{className:"flex-1 flex flex-col h-full w-full min-w-0 relative",children:[e.jsx(Xt,{activeView:l||"unknown",selectedCaseId:i||null}),e.jsx("header",{className:t("h-16 flex items-center justify-between px-4 md:px-6 shadow-sm z-40 shrink-0 border-b",n.surface.default,n.border.default),children:a}),e.jsx("main",{className:"flex-1 flex flex-col min-h-0 overflow-hidden relative isolate pb-0",style:{contain:"strict"},children:r})]})]})});yl.displayName="AppShellLayout";c.lazy(()=>k(()=>Promise.resolve().then(()=>fo),void 0).then(s=>({default:s.CaseDetail})));z.memo(({children:s,className:a=""})=>e.jsx("div",{className:"h-full overflow-y-auto custom-scrollbar p-6",children:e.jsx("div",{className:`max-w-7xl mx-auto space-y-6 animate-fade-in ${a}`,children:s})}));const Nl=z.memo(({header:s,children:a,headerClassName:r="",contentClassName:l="",className:o=""})=>{const{theme:i}=D();return e.jsxs("div",{className:t("h-full flex flex-col",o),children:[e.jsx("div",{className:t("sticky top-0 z-10 shrink-0",i.surface.default,"border-b",i.border.default,r),children:s}),e.jsx("div",{className:t("flex-1 overflow-y-auto",l),children:a})]})});Nl.displayName="StickyHeaderLayout";const wl={sm:"md:w-64",md:"md:w-80",lg:"md:w-96",xl:"md:w-[28rem]"},Cl=z.memo(({sidebar:s,content:a,showSidebarOnMobile:r=!0,sidebarPosition:l="left",sidebarWidth:o="lg",className:i=""})=>{const{theme:n}=D(),d=e.jsx("div",{className:t("w-full flex flex-col h-full",wl[o],l==="left"?"border-r":"border-l",n.border.default,n.surface.highlight,r?"flex":"hidden md:flex"),children:s}),m=e.jsx("div",{className:t("flex-1 flex flex-col min-w-0 h-full",n.surface.default,r?"hidden md:flex":"flex"),children:a});return e.jsx("div",{className:t("flex-1 flex flex-col md:flex-row rounded-lg overflow-hidden min-h-0",n.surface.default,n.border.default,"border shadow-sm",i),children:l==="left"?e.jsxs(e.Fragment,{children:[d,m]}):e.jsxs(e.Fragment,{children:[m,d]})})});Cl.displayName="SplitViewLayout";const gt={sm:"w-64",md:"w-80",lg:"w-96"},kl={none:"gap-0",sm:"gap-2",md:"gap-4",lg:"gap-6"},Sl=z.memo(({leftColumn:s,centerColumn:a,rightColumn:r,leftWidth:l="md",rightWidth:o="md",gap:i="md",showOnMobile:n="center",className:d=""})=>e.jsxs("div",{className:t("flex h-full",kl[i],d),children:[e.jsx("div",{className:t("flex flex-col overflow-auto",gt[l],n==="all"?"flex":"hidden lg:flex"),children:s}),e.jsx("div",{className:"flex-1 flex flex-col overflow-auto",children:a}),e.jsx("div",{className:t("flex flex-col overflow-auto",gt[o],n==="all"?"flex":"hidden xl:flex"),children:r})]}));Sl.displayName="ThreeColumnLayout";const _l={vertical:{none:"space-y-0",xs:"space-y-1",sm:"space-y-2",md:"space-y-4",lg:"space-y-6",xl:"space-y-8"},horizontal:{none:"space-x-0",xs:"space-x-1",sm:"space-x-2",md:"space-x-4",lg:"space-x-6",xl:"space-x-8"}},Dl={start:"items-start",center:"items-center",end:"items-end",stretch:"items-stretch"},Tl={start:"justify-start",center:"justify-center",end:"justify-end",between:"justify-between",around:"justify-around"},El=c.memo(({children:s,direction:a="vertical",spacing:r="md",align:l="stretch",justify:o="start",wrap:i=!1,className:n=""})=>e.jsx("div",{className:t("flex",a==="vertical"?"flex-col":"flex-row",_l[a][r],Dl[l],Tl[o],i&&"flex-wrap",n),children:s}));El.displayName="StackLayout";c.createContext(null);c.lazy(()=>k(()=>import("./DocumentExplorer-CnTnI11N.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44])).then(s=>({default:s.DocumentExplorer})));c.lazy(()=>k(()=>import("./DocumentTemplates-CJpDiW86.js"),__vite__mapDeps([45,1,2,3,13,10,6,31,4,5,7])).then(s=>({default:s.DocumentTemplates})));c.lazy(()=>k(()=>import("./RecentFiles-e-6oaoLM.js"),__vite__mapDeps([46,1,2,3,21,10,6,13,22,4,5,7,15,16,11,12,17,18,19,20,9,23,24,25,8,26,27,28,14,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44])).then(s=>({default:s.RecentFiles})));c.lazy(()=>k(()=>import("./PDFEditorView-CpbmaJYK.js"),__vite__mapDeps([47,1,2,3,13,10,6,27,14,4,5,7,11,8,15,16,12,17,18,19,20,21,22,9,23,24,25,26,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44])).then(s=>({default:s.PDFEditorView})));c.lazy(()=>k(()=>import("./RedactionStudioView-DEw-tXIs.js"),__vite__mapDeps([48,1,2,3,27,13,10,6,4,5,7,8,15,16,11,12,17,18,19,20,21,22,9,23,24,25,26,28,14,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44])).then(s=>({default:s.RedactionStudioView})));c.lazy(()=>k(()=>import("./BatchProcessingView-C7j-ellx.js"),__vite__mapDeps([49,1,2,3,13,10,6,22])).then(s=>({default:s.BatchProcessingView})));z.memo(({onExport:s})=>{const[a,r]=c.useState(!1),l=c.useRef(null),{theme:o}=D();return Bt(l,()=>r(!1)),e.jsxs("div",{className:"relative inline-block text-left",ref:l,children:[e.jsx(_,{variant:"secondary",icon:$e,onClick:()=>r(!a),"aria-haspopup":"true","aria-expanded":a,children:"Export"}),a&&e.jsx("div",{className:t("absolute right-0 mt-2 w-48 rounded-md shadow-lg ring-1 ring-black ring-opacity-5 z-50 animate-in fade-in zoom-in-95 duration-100",o.surface.default,o.border.default,"border"),children:e.jsxs("div",{className:"py-1",children:[e.jsxs("button",{onClick:()=>{s("pdf"),r(!1)},className:t("w-full text-left px-4 py-2 text-sm flex items-center gap-2 transition-colors",o.text.primary,`hover:${o.surface.highlight}`),children:[e.jsx(Q,{className:"h-4 w-4 text-red-500"})," PDF Report"]}),e.jsxs("button",{onClick:()=>{s("csv"),r(!1)},className:t("w-full text-left px-4 py-2 text-sm flex items-center gap-2 transition-colors",o.text.primary,`hover:${o.surface.highlight}`),children:[e.jsx(Ha,{className:"h-4 w-4 text-green-500"})," CSV Data"]}),e.jsxs("button",{onClick:()=>{s("xml"),r(!1)},className:t("w-full text-left px-4 py-2 text-sm flex items-center gap-2 transition-colors",o.text.primary,`hover:${o.surface.highlight}`),children:[e.jsx(Ua,{className:"h-4 w-4 text-blue-500"})," XML (LEDES)"]})]})})]})});const Al=[{value:"30d",label:"Last 30 Days"},{value:"QTD",label:"Quarter to Date"},{value:"YTD",label:"Year to Date"},{value:"ALL",label:"All Time"}];z.memo(({periods:s=Al,selected:a,onChange:r,className:l=""})=>{const{theme:o}=D();return e.jsx("div",{className:t("inline-flex p-1 rounded-lg border",o.surface.default,o.border.default,l),children:s.map(i=>{const n=a===i.value;return e.jsx("button",{onClick:()=>r(i.value),className:t("px-3 py-1.5 text-xs font-medium rounded-md transition-all duration-200",n?t(o.primary.DEFAULT,o.text.inverse,"shadow-sm"):t(o.text.secondary,`hover:${o.surface.highlight}`,`hover:${o.text.primary}`)),children:i.label},i.value)})})});const jt=c.lazy(()=>k(()=>Promise.resolve().then(()=>Yl),void 0).then(s=>({default:s.BillingOverview}))),Il=c.lazy(()=>k(()=>import("./BillingInvoices-D8jr0qzb.js"),__vite__mapDeps([50,1,2,3,6,4,5,7,9,10,11,21,15,13,51,20,16,12,17,18,19,22,23,24,25,8,26,27,28,14,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44])).then(s=>({default:s.BillingInvoices}))),Pl=c.lazy(()=>k(()=>import("./BillingWIP-hxyeZS_n.js"),__vite__mapDeps([52,1,2,3,4,5,6,7,10,9,11,21,13,51,15,16,12,17,18,19,20,22,23,24,25,8,26,27,28,14,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44])).then(s=>({default:s.BillingWIP}))),Rl=c.lazy(()=>k(()=>Promise.resolve().then(()=>Jl),void 0).then(s=>({default:s.BillingLedger}))),Ll=()=>e.jsx("div",{className:"p-8 text-center text-slate-500",children:"Financial Analytics Module Loading..."}),Ml=({activeTab:s,navigateTo:a})=>{switch(s){case"overview":return e.jsx(jt,{onNavigate:a});case"invoices":return e.jsx(Il,{});case"wip":return e.jsx(Pl,{});case"expenses":case"trust":return e.jsx(Rl,{});case"analytics":return e.jsx(Ll,{});default:return e.jsx(jt,{onNavigate:a})}},Ol=c.memo(Ml);Ol.displayName="BillingDashboardContent";const ea=()=>{const{theme:s}=D();return c.useMemo(()=>({grid:s.chart.grid,text:s.chart.text,colors:s.chart.colors,tooltipStyle:{backgroundColor:s.chart.tooltip.bg,borderColor:s.chart.tooltip.border,color:s.chart.tooltip.text,borderRadius:"8px",boxShadow:"0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06)",borderWidth:"1px"}}),[s])};c.lazy(()=>k(()=>import("./WikiView-Cb-5G1sT.js"),__vite__mapDeps([53,1,2,3,6,4,5,7,54,10,15,31])).then(s=>({default:s.WikiView})));c.lazy(()=>k(()=>import("./PrecedentsView-DqklS0za.js"),__vite__mapDeps([55,1,2,3,4,5,6,7,10,13])).then(s=>({default:s.PrecedentsView})));c.lazy(()=>k(()=>import("./QAView-Tr_YiqVM.js"),__vite__mapDeps([56,1,2,3,4,5,6,7,10,13])).then(s=>({default:s.QAView})));c.lazy(()=>k(()=>import("./KnowledgeAnalytics-BAoB0LnD.js"),__vite__mapDeps([57,1,2,3,6,4,5,7,10,24,25,13,15,16,11,12,17,18,19,20,21,22,9,23,8,26,27,28,14,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44])).then(s=>({default:s.KnowledgeAnalytics})));function Xs({value:s,onChange:a,placeholder:r="Search (Press /)...",actions:l,className:o=""}){const{theme:i}=D(),n=c.useRef(null),d=c.useRef(null),m=c.useId(),[f,u]=c.useState(!1),[x,p]=c.useState(!1),h=ct.getHistory();Bt(d,()=>p(!1)),z.useEffect(()=>{u(!0)},[]),z.useEffect(()=>{if(!f||typeof document>"u")return;const v=S=>{S.key==="/"&&document.activeElement!==n.current&&(S.preventDefault(),n.current?.focus())};return document.addEventListener("keydown",v),()=>document.removeEventListener("keydown",v)},[f]);const j=()=>{h.length>0&&p(!0)},N=v=>{a(v),p(!1),n.current?.focus()},y=v=>{v.key==="Enter"&&(ct.saveHistory(s),p(!1))};return e.jsxs("div",{className:t("flex flex-col md:flex-row justify-between items-center gap-4 p-4 rounded-lg border shadow-sm",i.surface.default,i.border.default,o),children:[e.jsxs("div",{className:"relative w-full md:max-w-md",ref:d,children:[e.jsx(Et,{className:t("absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4",i.text.tertiary)}),e.jsx("input",{ref:n,id:m,"aria-label":"Search input",className:t("w-full pl-9 pr-4 py-2 border rounded-md text-sm outline-none transition-all placeholder:text-slate-400 dark:placeholder:text-slate-500",i.surface.highlight,i.border.default,i.text.primary,i.border.focused),placeholder:r,value:s,onChange:v=>a(v.target.value),onFocus:j,onKeyUp:y}),x&&h.length>0&&!s&&e.jsxs("div",{className:t("absolute top-full left-0 right-0 mt-1 rounded-md shadow-lg border z-50 overflow-hidden",i.surface.default,i.border.default),children:[e.jsx("div",{className:t("px-3 py-1.5 text-[10px] font-bold uppercase tracking-wider text-slate-500",i.surface.highlight),children:"Recent Searches"}),h.map((v,S)=>e.jsxs("button",{className:t("w-full text-left px-3 py-2 text-sm flex items-center gap-2",i.text.primary,`hover:${i.surface.highlight}`),onClick:()=>N(v),children:[e.jsx(ce,{className:"h-3 w-3 text-slate-400"})," ",v]},S))]})]}),l&&e.jsx("div",{className:"flex gap-2 w-full md:w-auto",children:l})]})}function xc(s=[],a=(r,l)=>r===l){const[r,l]=c.useState(s),o=c.useCallback(p=>{l(h=>h.some(N=>a(N,p))?h:[...h,p])},[a]),i=c.useCallback(p=>{l(h=>h.filter(j=>!a(j,p)))},[a]),n=c.useCallback(p=>{l(h=>h.some(N=>a(N,p))?h.filter(N=>!a(N,p)):[...h,p])},[a]),d=c.useCallback(p=>{l(p)},[]),m=c.useCallback(()=>{l([])},[]),f=c.useCallback(p=>r.some(h=>a(h,p)),[r,a]),u=c.useCallback(p=>p.length>0&&p.every(h=>r.some(j=>a(j,h))),[r,a]),x=c.useCallback(p=>{const h=p.filter(j=>r.some(N=>a(N,j))).length;return h>0&&h<p.length},[r,a]);return{selected:r,select:o,deselect:i,toggle:n,selectAll:d,clear:m,isSelected:f,isAllSelected:u,isIndeterminate:x}}function sa(s=null,a=(r,l)=>r===l){const[r,l]=c.useState(s),o=c.useCallback(d=>{l(d)},[]),i=c.useCallback(()=>{l(null)},[]),n=c.useCallback(d=>r!==null&&a(r,d),[r,a]);return{selected:r,select:o,deselect:i,isSelected:n}}const bt=c.lazy(()=>k(()=>import("./ActiveResearch-v-ACdYqa.js"),__vite__mapDeps([58,1,2,3,6,8,4,5,7,10,24,15,36,16,11])).then(s=>({default:s.ActiveResearch}))),zl=c.lazy(()=>k(()=>import("./ResearchHistory-CaEcD8ze.js"),__vite__mapDeps([59,1,2,3,13,10,6,31,21,4,5,7,8,15,16,11,12,17,18,19,20,22,9,23,24,25,26,27,28,14,29,30,32,33,34,35,36,37,38,39,40,41,42,43,44])).then(s=>({default:s.ResearchHistory}))),$l=c.lazy(()=>k(()=>import("./SavedAuthorities-Ck3Kioy1.js"),__vite__mapDeps([60,1,2,3,21,10,6,15,13,31,22,4,5,7,8])).then(s=>({default:s.SavedAuthorities}))),Vl=c.lazy(()=>k(()=>import("./JurisdictionSettings-xKWXhLAA.js"),__vite__mapDeps([61,1,2,3,24,10,6])).then(s=>({default:s.JurisdictionSettings}))),Fl=c.lazy(()=>k(()=>import("./ShepardizingTool-DpmNh5Si.js"),__vite__mapDeps([62,1,2,3,15,10,6,13,24,36,16,4,5,7])).then(s=>({default:s.ShepardizingTool}))),Bl=c.lazy(()=>k(()=>import("./ClauseLibrary-DAisxU19.js"),__vite__mapDeps([63,1,2,3,15,10,6,13,34,31,24,22,27,4,5,7]))),Wl=({activeView:s,caseId:a,selectedClause:r,setSelectedClause:l})=>{switch(s){case"active":return e.jsx(bt,{});case"history":return e.jsx(zl,{});case"saved":return e.jsx($l,{});case"shepardize":return e.jsx(Fl,{});case"library":return e.jsx(Bl,{onSelectClause:()=>{}});case"settings":return e.jsx(Vl,{});default:return e.jsx(bt,{})}},vt=c.lazy(async()=>({default:(await k(()=>import("./ClauseHistoryModal-tbMW-2a5.js"),__vite__mapDeps([64,1,2,3,10,6,13,15,16,11,4,5,7,12,17,18,19,20,21,22,9,23,24,25,8,26,27,28,14,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44]))).ClauseHistoryModal})),hc=({initialTab:s,caseId:a})=>{const{theme:r}=D(),l=a?`research_active_view_${a}`:"research_active_view",[o,i]=Ht(l,s||"search_home"),n=sa(null,(x,p)=>x.id===p.id),[d,m]=c.useState(""),{data:f=[]}=F(U.adminExtended.judgeProfiles(),()=>I.analysis.getJudgeProfiles(),{enabled:o.startsWith("analytics_")});c.useEffect(()=>{f.length>0&&!d&&m(f[0].id)},[f,d]);const u=()=>e.jsx(Wl,{activeView:o,caseId:a,selectedClause:n.selected,setSelectedClause:n.select});return a?e.jsxs(e.Fragment,{children:[n.selected&&e.jsx(c.Suspense,{fallback:null,children:e.jsx(vt,{clause:n.selected,onClose:n.deselect})}),e.jsxs("div",{className:t("h-full flex flex-col animate-fade-in",r.background),children:[e.jsx("div",{className:t("px-6 pt-2 shrink-0 border-b",r.border.default),children:e.jsx("div",{className:"flex space-x-4 overflow-x-auto no-scrollbar pb-3",children:dt.flatMap(x=>x.subTabs).map(x=>e.jsxs("button",{onClick:()=>i(x.id),className:t("flex items-center text-xs font-medium px-3 py-1.5 rounded-full border transition-colors whitespace-nowrap",o===x.id?t(r.primary.light,r.primary.text,r.primary.border):t(r.surface.default,r.text.secondary,r.border.default,`hover:${r.surface.highlight}`)),children:[e.jsx(x.icon,{className:"h-3 w-3 mr-1.5"}),x.label]},x.id))})}),e.jsx("div",{className:"flex-1 overflow-hidden px-6 pb-6 min-h-0 pt-4",children:e.jsx(c.Suspense,{fallback:e.jsx(ke,{message:"Loading Research Tools..."}),children:u()})})]})]}):e.jsxs(e.Fragment,{children:[n.selected&&e.jsx(c.Suspense,{fallback:null,children:e.jsx(vt,{clause:n.selected,onClose:n.deselect})}),e.jsx(zr,{pageTitle:"Research & Knowledge Center",pageSubtitle:"Unified intelligence hub for legal authority, firm knowledge, and strategic analysis.",tabConfig:dt,activeTabId:o,onTabChange:i,children:e.jsx(c.Suspense,{fallback:e.jsx(ke,{message:"Loading Module..."}),children:u()})})]})},ta=z.memo(({value:s,label:a,type:r="strength"})=>{const{theme:l}=D(),o=c.useCallback(i=>r==="strength"?i>=80?l.chart.colors.success:i>=50?l.chart.colors.primary:l.chart.colors.warning:i>=80?l.chart.colors.danger:i>=50?l.chart.colors.warning:l.chart.colors.success,[r,l]);return e.jsxs("div",{className:"space-y-2",children:[a&&e.jsxs("div",{className:"flex items-center justify-between text-xs",children:[e.jsx("span",{className:t("font-semibold uppercase",l.text.secondary),children:a}),e.jsxs("span",{className:t("font-bold",l.text.primary),children:[s,"%"]})]}),e.jsx("div",{className:t("w-full rounded-full h-2 overflow-hidden",l.surface.highlight),children:e.jsx("div",{className:"h-full rounded-full transition-all duration-500",style:{width:`${Math.max(0,Math.min(100,s))}%`,backgroundColor:o(s)}})})]})});c.lazy(()=>k(()=>import("./CitationLibrary-B-Ba-HYx.js"),__vite__mapDeps([65,1,2,3,12,10,6,15,13,22,4,5,7,36,16,40,11,66,17,18,19,20,21,9,23,24,25,8,26,27,28,14,29,30,31,32,33,34,35,37,38,39,41,42,43,44])).then(s=>({default:s.CitationLibrary})));c.lazy(()=>k(()=>import("./BriefAnalyzer-mg_EjD84.js"),__vite__mapDeps([67,1,2,3,13,10,6,24,33,9,11,4,5,7,36,16,66,15,12,17,18,19,20,21,22,23,25,8,26,27,28,14,29,30,31,32,34,35,37,38,39,40,41,42,43,44])));const Hl=(s,a)=>{const r=a.toLowerCase();return s.filter(l=>(l.name||"").toLowerCase().includes(r)||l.category.toLowerCase().includes(r))},Ul=({onSelectClause:s})=>{const{theme:a}=D(),[r,l]=c.useState(""),[o,i]=c.useState(null),{data:n=[],isLoading:d}=F(["clauses","all"],I.clauses.getAll),m=c.useMemo(()=>Hl(n,r),[n,r]),f=(x,p,h)=>{h.stopPropagation(),navigator.clipboard.writeText(x),i(p),setTimeout(()=>i(null),Mr)},u=x=>e.jsxs("div",{onClick:()=>s(x),className:t("flex items-center border-b h-[64px] px-6 cursor-pointer hover:bg-slate-50 transition-colors group",a.border.default),children:[e.jsxs("div",{className:"flex-1 min-w-0 pr-4",children:[e.jsx("div",{className:t("font-bold text-sm truncate",a.text.primary),children:x.name}),e.jsx("p",{className:t("text-xs truncate",a.text.secondary),children:x.category})]}),e.jsx("div",{className:"w-32",children:e.jsxs("span",{className:"text-xs",children:["v",x.version," • ",x.usageCount," uses"]})}),e.jsxs("div",{className:"w-48 text-right",children:[e.jsx(_,{size:"sm",variant:"ghost",onClick:p=>f(x.content,x.id,p),children:o===x.id?e.jsx(Bs,{className:"h-4 w-4 text-green-500"}):e.jsx(Ga,{className:"h-4 w-4"})}),e.jsx(_,{size:"sm",variant:"ghost",onClick:p=>{p.stopPropagation(),s(x)},children:e.jsx(qa,{className:"h-4 w-4"})})]})]},x.id);return e.jsxs("div",{className:"flex flex-col h-full",children:[e.jsx("div",{className:t("p-4 border-b shrink-0",a.border.default),children:e.jsx(Xs,{value:r,onChange:l,placeholder:"Search clauses...",className:"border-none shadow-none p-0"})}),e.jsxs("div",{className:t("flex-1 min-h-0 flex flex-col bg-white border-t",a.border.default),children:[e.jsxs("div",{className:t("flex items-center px-6 py-3 border-b font-bold text-xs uppercase tracking-wider bg-slate-50",a.border.default,a.text.secondary),children:[e.jsx("div",{className:"flex-1",children:"Clause Name & Category"}),e.jsx("div",{className:"w-32",children:"Version & Usage"}),e.jsx("div",{className:"w-48 text-right",children:"Actions"})]}),e.jsx("div",{className:"flex-1 relative",children:d?e.jsx("div",{className:"flex items-center justify-center h-full",children:e.jsx(re,{className:"h-6 w-6 animate-spin text-blue-600"})}):m.length>0?e.jsx(rs,{items:m,height:"100%",itemHeight:64,renderItem:u}):e.jsx("div",{className:"pt-10",children:e.jsx(Wt,{icon:as,title:"No Clauses Found",description:"The clause library is empty or your search returned no results."})})})]})]})};z.lazy(()=>k(()=>import("./JurisdictionFederal-BkHmr8Ju.js"),__vite__mapDeps([68,1,2,3,6,4,5,7,10,21,15,31])).then(s=>({default:s.JurisdictionFederal})));z.lazy(()=>k(()=>import("./JurisdictionState-Dv3nI_dD.js"),__vite__mapDeps([69,1,2,3,6,4,5,7,10,21,31,70,13,15,16,11,12,17,18,19,20,22,9,23,24,25,8,26,27,28,14,29,30,32,33,34,35,36,37,38,39,40,41,42,43,44])).then(s=>({default:s.JurisdictionState})));z.lazy(()=>k(()=>import("./JurisdictionRegulatory-CJ27ZRPI.js"),__vite__mapDeps([71,1,2,3,31,10,6,24,4,5,7])).then(s=>({default:s.JurisdictionRegulatory})));z.lazy(()=>k(()=>import("./JurisdictionInternational-CQxnAtp-.js"),__vite__mapDeps([72,1,2,3,31,10,6,21,4,5,7])).then(s=>({default:s.JurisdictionInternational})));z.lazy(()=>k(()=>import("./JurisdictionArbitration-DFQo1Ggp.js"),__vite__mapDeps([73,1,2,3,13,10,6,31,24,4,5,7])).then(s=>({default:s.JurisdictionArbitration})));z.lazy(()=>k(()=>import("./JurisdictionLocalRules-Bme-yx_Z.js"),__vite__mapDeps([74,1,2,3,21,10,6,13,14,4,5,7,11,34,35,28,15,41,70,16,12,17,18,19,20,22,9,23,24,25,8,26,27,29,30,31,32,33,36,37,38,39,40,42,43,44])).then(s=>({default:s.JurisdictionLocalRules})));z.lazy(()=>k(()=>import("./JurisdictionGeoMap-CB_sYjbA.js"),__vite__mapDeps([75,1,2,3,10,6,4,5,7,11])).then(s=>({default:s.JurisdictionGeoMap})));c.lazy(()=>k(()=>import("./RulesDashboard-B0aNFB9O.js"),__vite__mapDeps([76,1,2,3,13,10,6,31,24,25,4,5,7])).then(s=>({default:s.RulesDashboard})));c.lazy(()=>k(()=>import("./RuleBookViewer-n9RMmH3h.js"),__vite__mapDeps([77,1,2,3,31,10,6,4,5,7,8,13,33,38,11])).then(s=>({default:s.RuleBookViewer})));c.lazy(()=>k(()=>import("./StandingOrders-D4JLXpB_.js"),__vite__mapDeps([78,1,2,3,13,10,6,24,4,5,7])).then(s=>({default:s.StandingOrders})));c.lazy(()=>k(()=>import("./LocalRulesMap-9POWM-WB.js"),__vite__mapDeps([79,1,2,3,24,10,6,4,5,7,13,21,15,75,11,17,28,14,16,12,18,19,20,22,9,23,25,8,26,27,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44])).then(s=>({default:s.LocalRulesMap})));c.lazy(()=>k(()=>import("./HRManager-CdnpEfGf.js"),__vite__mapDeps([80,1,2,3,15,10,6,13,32,28,14,4,5,7,11,25,21,34,81,8,41,9,23])).then(s=>({default:s.HRManager})));c.lazy(()=>k(()=>import("./FinancialCenter-B6RNAu7B.js"),__vite__mapDeps([82,1,2,3,6,4,5,7,8,10,13,15,24,21,20])).then(s=>({default:s.FinancialCenter})));c.lazy(()=>k(()=>import("./MarketingDashboard-BTb-ydvc.js"),__vite__mapDeps([83,1,2,3,6,4,5,7,10,24])).then(s=>({default:s.MarketingDashboard})));c.lazy(()=>k(()=>import("./AssetManager-cEkGfdsk.js"),__vite__mapDeps([84,1,2,3,6,4,5,7,10,11,41,23,12,15,13,34,28,14,16,17,18,19,20,21,22,9,24,25,8,26,27,29,30,31,32,33,35,36,37,38,39,40,42,43,44])).then(s=>({default:s.AssetManager})));c.lazy(()=>k(()=>import("./KnowledgeCenter-kfvCUqNT.js"),__vite__mapDeps([85,1,2,3,6,4,5,7,10,15,33,21,57,24,25,13,16,11,12,17,18,19,20,22,9,23,8,26,27,28,14,29,30,31,32,34,35,36,37,38,39,40,41,42,43,44,55,56,53,54])).then(s=>({default:s.KnowledgeCenter})));c.lazy(()=>k(()=>import("./VendorProcurement-BhGvnNUk.js"),__vite__mapDeps([86,1,2,3,6,4,5,7,10,29,15,13,33,21,16,11,12,17,18,19,20,22,9,23,24,25,8,26,27,28,14,30,31,32,34,35,36,37,38,39,40,41,42,43,44])).then(s=>({default:s.VendorProcurement})));c.lazy(()=>k(()=>import("./FacilitiesManager-DGVZOa5g.js"),__vite__mapDeps([87,1,2,3,6,4,5,7,10,88,15,24,33,21])).then(s=>({default:s.FacilitiesManager})));c.lazy(()=>k(()=>import("./SecurityOps-CWAuYJLv.js"),__vite__mapDeps([89,1,2,3,6,4,5,7,9,10,11,13,24])).then(s=>({default:s.SecurityOps})));c.lazy(()=>k(()=>import("./StrategyBoard-pxNyrQ06.js"),__vite__mapDeps([90,1,2,3,6,4,5,7,10,88,29,91,24,33])).then(s=>({default:s.StrategyBoard})));const Gl=({className:s})=>e.jsx("div",{className:s,children:"Operating Ledger (stub)"}),ql=({className:s})=>e.jsx("div",{className:s,children:"Trust Ledger (stub)"}),Kl=()=>{const{theme:s}=D(),{openWindow:a,closeWindow:r}=_e(),{success:l,error:o}=De(),[i,n]=c.useState("operating"),[d,m]=c.useState(null),[f,u]=c.useState(null),x=c.useCallback(()=>{const p=`txn-new-${crypto.randomUUID()}`.slice(0,32);a(p,"Record Ledger Transaction",e.jsx("div",{className:"p-6 bg-white h-full",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex gap-4",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{className:"block text-xs font-bold text-slate-500 mb-1",children:"Account"}),e.jsxs("select",{id:"transaction-account",className:"w-full border rounded p-2 text-sm","aria-label":"Account",children:[e.jsx("option",{children:"Operating"}),e.jsx("option",{children:"Trust"}),e.jsx("option",{children:"Retainer"})]})]}),e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{className:"block text-xs font-bold text-slate-500 mb-1",children:"Type"}),e.jsxs("select",{id:"transaction-type",className:"w-full border rounded p-2 text-sm","aria-label":"Type",children:[e.jsx("option",{children:"Income"}),e.jsx("option",{children:"Expense"}),e.jsx("option",{children:"Transfer"})]})]})]}),e.jsxs("div",{className:"flex gap-4",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{className:"block text-xs font-bold text-slate-500 mb-1",children:"Date"}),e.jsx("input",{type:"date",className:"w-full border rounded p-2 text-sm",defaultValue:Zs(),"aria-label":"Date"})]}),e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{className:"block text-xs font-bold text-slate-500 mb-1",children:"Amount"}),e.jsx("input",{type:"number",className:"w-full border rounded p-2 text-sm",placeholder:"0.00",step:"0.01",min:"0"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold text-slate-500 mb-1",children:"Description"}),e.jsx("textarea",{className:"w-full border rounded p-2 text-sm h-24",placeholder:"Transaction details...",id:"transaction-description"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold text-slate-500 mb-1",children:"Receipt/Invoice"}),e.jsx("input",{type:"file",id:"receipt-upload",accept:".pdf,.jpg,.jpeg,.png",className:"w-full border rounded p-2 text-sm","aria-label":"Receipt or Invoice",onChange:h=>{const j=h.target.files?.[0];if(j){if(j.size>5*1024*1024){o("File size must be less than 5MB");return}if(m(j),j.type.startsWith("image/")){const N=new FileReader;N.onloadend=()=>{u(N.result)},N.readAsDataURL(j)}else u(null)}}}),d&&e.jsxs("div",{className:"mt-2 text-xs text-slate-600",children:[e.jsx(Q,{className:"inline h-3 w-3 mr-1"}),d.name," (",(d.size/1024).toFixed(1)," KB)"]}),f&&e.jsx("div",{className:"mt-2 border rounded p-2",children:e.jsx("img",{src:f,alt:"Receipt preview",className:"max-h-32 object-contain"})})]}),e.jsx(_,{variant:"primary",className:"w-full",onClick:async()=>{try{const h=document.querySelector("#transaction-account"),j=document.querySelector("#transaction-type"),N=document.querySelector('input[type="date"]'),y=document.querySelector('input[type="number"]'),v=document.querySelector("#transaction-description");if(!y?.value||parseFloat(y.value)<=0){o("Please enter a valid amount");return}if(!v?.value?.trim()){o("Please enter a description");return}const S={id:crypto.randomUUID(),account:h?.value||"Operating",type:j?.value||"Income",date:N?.value||new Date().toISOString().split("T")[0],amount:parseFloat(y.value),description:v.value,receiptFile:d?{name:d.name,size:d.size,type:d.type,data:f||null}:void 0,createdAt:new Date().toISOString(),userId:"current-user"};await I.transactions.add(S),l(`Transaction logged successfully${d?" with receipt":""}`),m(null),u(null),r(p)}catch(h){o("Failed to log transaction"),console.error("Transaction error:",h)}},children:"Save"})]})}))},[a,r,l,o]);return e.jsxs("div",{className:"space-y-6 animate-fade-in",children:[e.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[e.jsxs("div",{className:t("flex p-1 rounded-lg border shadow-sm",s.surface.default,s.border.default),children:[e.jsx("button",{onClick:()=>n("operating"),className:t("px-4 py-2 text-sm font-medium rounded-md transition-all",i==="operating"?t(s.primary.DEFAULT,s.text.inverse):t(s.text.secondary,`hover:${s.surface.highlight}`)),children:"Operating Expenses"}),e.jsx("button",{onClick:()=>n("trust"),className:t("px-4 py-2 text-sm font-medium rounded-md transition-all",i==="trust"?"bg-green-600 text-white shadow":t(s.text.secondary,`hover:${s.surface.highlight}`)),children:"Trust (IOLTA)"})]}),e.jsx("div",{className:"flex-1"}),e.jsx(_,{variant:"outline",size:"sm",icon:J,onClick:x,children:"Log Transaction"})]}),i==="operating"?e.jsx(Gl,{}):e.jsx(ql,{})]})},aa=memo(Kl);aa.displayName="BillingLedger";const Jl=Object.freeze(Object.defineProperty({__proto__:null,BillingLedger:aa},Symbol.toStringTag,{value:"Module"})),Zl=({onNavigate:s})=>{const{theme:a,mode:r}=D(),l=ea(),{data:o=[]}=F(["billing","wipStats"],()=>I.billing?I.billing.getWIPStats():Promise.resolve([])),{data:i=[]}=F(["billing","realization"],()=>I.billing?I.billing.getRealizationStats(r):Promise.resolve([])),{data:n=[]}=F(["billing","topAccounts"],()=>I.billing?I.billing.getTopAccounts():Promise.resolve([])),d=Array.isArray(o)?o:[],m=Array.isArray(i)?i:[],f=Array.isArray(n)?n:[],u=d.reduce((x,p)=>typeof p=="object"&&p!==null&&"wip"in p?x+(typeof p.wip=="number"?p.wip:0):x,0);return e.jsxs("div",{className:"space-y-6 animate-fade-in",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsx(ne,{label:"Total WIP (Unbilled)",value:u,icon:Ce,trend:"+12% MoM",trendUp:!0,className:"border-l-4 border-l-blue-600",isLive:!0}),e.jsx(ne,{label:"Realization Rate",value:"92.4%",icon:et,trend:"Target: 90%",trendUp:!0,className:"border-l-4 border-l-emerald-500"}),e.jsx(ne,{label:"Outstanding (60+ Days)",value:12450,icon:je,trend:"3 Invoices Overdue",trendUp:!1,className:"border-l-4 border-l-rose-500"})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsx(ye,{title:"WIP vs Billed (Top Clients)",subtitle:"Revenue potential by client",children:e.jsx("div",{className:"h-72",style:{minHeight:"288px"},children:d.length>0?e.jsx(Ls,{width:"100%",height:"100%",children:e.jsxs(Hr,{data:d,margin:{top:20,right:30,left:20,bottom:5},children:[e.jsx(Ur,{strokeDasharray:"3 3",vertical:!1,stroke:l.grid}),e.jsx(Gr,{dataKey:"name",axisLine:!1,tickLine:!1,fontSize:12,tick:{fill:l.text},dy:10}),e.jsx(qr,{axisLine:!1,tickLine:!1,fontSize:12,tick:{fill:l.text},tickFormatter:x=>`$${x/1e3}k`}),e.jsx(Ms,{cursor:{fill:l.grid},contentStyle:l.tooltipStyle}),e.jsx(Os,{iconType:"circle"}),e.jsx(ut,{dataKey:"billed",stackId:"a",fill:l.colors.secondary,name:"Billed",radius:[0,0,4,4],isAnimationActive:!0}),e.jsx(ut,{dataKey:"wip",stackId:"a",fill:l.colors.primary,name:"WIP (Unbilled)",radius:[4,4,0,0],isAnimationActive:!0})]})}):e.jsx("div",{className:"h-full flex items-center justify-center text-slate-400",children:e.jsxs("div",{className:"text-center",children:[e.jsx(Ce,{className:"h-12 w-12 mx-auto mb-2 opacity-20"}),e.jsx("p",{className:"text-sm",children:"No WIP data available"})]})})})}),e.jsx(ye,{title:"Realization Breakdown",subtitle:"Collection efficiency analysis",children:e.jsx("div",{className:"h-72 flex flex-col items-center justify-center relative",style:{minHeight:"288px"},children:m.length>0?e.jsxs(e.Fragment,{children:[e.jsx(Ls,{width:"100%",height:"100%",children:e.jsxs(Ut,{children:[e.jsx(Gt,{data:m,innerRadius:70,outerRadius:100,paddingAngle:5,dataKey:"value",stroke:"none",isAnimationActive:!0,children:m.map((x,p)=>{const h=typeof x=="object"&&x!==null&&"name"in x?String(x.name):"";return e.jsx(qt,{fill:h==="Billed"?l.colors.success:l.colors.danger},`cell-${p}`)})}),e.jsx(Ms,{contentStyle:l.tooltipStyle}),e.jsx(Os,{verticalAlign:"bottom",height:36,iconType:"circle"})]})}),e.jsxs("div",{className:"absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 text-center -mt-4",children:[e.jsx("p",{className:t("text-3xl font-bold",a.text.primary),children:"92%"}),e.jsx("p",{className:t("text-xs uppercase",a.text.tertiary),children:"Collected"})]})]}):e.jsxs("div",{className:"text-center text-slate-400",children:[e.jsx(et,{className:"h-12 w-12 mx-auto mb-2 opacity-20"}),e.jsx("p",{className:"text-sm",children:"No realization data available"})]})})})]}),e.jsxs("div",{className:t("rounded-lg shadow-sm border overflow-hidden",a.surface.default,a.border.default),children:[e.jsx("div",{className:t("p-4 border-b flex justify-between items-center",a.border.default,a.surface.highlight),children:e.jsxs("h3",{className:t("font-bold flex items-center",a.text.primary),children:[e.jsx(de,{className:t("h-5 w-5 mr-2",a.primary.text)})," Top Revenue Accounts"]})}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 divide-y md:divide-y-0 md:divide-x dark:divide-slate-700 divide-slate-200",children:f.map(x=>{if(typeof x!="object"||x===null)return null;const p="id"in x?String(x.id):"",h="name"in x&&typeof x.name=="string"?x.name:"",j="industry"in x&&typeof x.industry=="string"?x.industry:"",N="totalBilled"in x&&typeof x.totalBilled=="number"?x.totalBilled:0;return e.jsxs("div",{className:t("flex items-center justify-between p-4 hover:bg-slate-50 dark:hover:bg-slate-800 transition-colors cursor-pointer"),onClick:()=>s&&s("accounts"),children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:t("h-10 w-10 rounded-full flex items-center justify-center font-bold text-sm bg-blue-100 text-blue-700"),children:h.substring(0,2)}),e.jsxs("div",{children:[e.jsx("p",{className:t("font-bold text-sm",a.text.primary),children:h}),e.jsx("p",{className:t("text-xs",a.text.secondary),children:j})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:t("font-mono font-bold text-sm",a.text.primary),children:e.jsx(Br,{value:N,hideSymbol:!1})}),e.jsx("span",{className:t("text-[10px] font-bold text-green-600"),children:"Active"})]})]},p)})})]})]})},ra=c.memo(Zl);ra.displayName="BillingOverview";const Yl=Object.freeze(Object.defineProperty({__proto__:null,BillingOverview:ra},Symbol.toStringTag,{value:"Module"})),Ql=({conflicts:s})=>{const{theme:a}=D(),[r,l]=c.useState(""),o=s.filter(i=>i.entityName.toLowerCase().includes(r.toLowerCase())||i.checkedBy.toLowerCase().includes(r.toLowerCase()));return e.jsxs("div",{className:"space-y-6 animate-fade-in",children:[e.jsxs("div",{className:t("flex flex-col md:flex-row justify-between items-start md:items-center p-4 rounded-lg border gap-4",a.surface.highlight,a.border.default),children:[e.jsxs("div",{children:[e.jsx("h3",{className:t("font-bold",a.text.primary),children:"Conflict Checks"}),e.jsx("p",{className:t("text-sm",a.text.secondary),children:"Search history and run new clearance reports."})]}),e.jsx(_,{variant:"primary",icon:J,children:"Run New Check"})]}),e.jsx(Xs,{value:r,onChange:l,placeholder:"Search by entity or requester...",actions:e.jsxs("div",{className:"flex gap-2",children:[e.jsx(_,{variant:"secondary",size:"sm",icon:ps,children:"Filter"}),e.jsx(_,{variant:"outline",size:"sm",icon:$e,children:"Export"})]})}),e.jsxs(We,{responsive:"card",children:[e.jsxs(He,{children:[e.jsx(B,{children:"Entity Name"}),e.jsx(B,{children:"Date Checked"}),e.jsx(B,{children:"Status"}),e.jsx(B,{children:"Potential Matches"}),e.jsx(B,{children:"Checked By"}),e.jsx(B,{className:"text-right",children:"Report"})]}),e.jsx(Ue,{children:o.map(i=>e.jsxs(Ie,{children:[e.jsx(V,{className:t("font-medium",a.text.primary),children:i.entityName}),e.jsx(V,{className:t("text-xs font-mono",a.text.secondary),children:i.date}),e.jsx(V,{children:e.jsx(K,{variant:i.status==="Cleared"?"success":i.status==="Flagged"?"error":"warning",children:i.status})}),e.jsx(V,{children:i.foundIn.length>0?e.jsx("div",{className:"flex flex-wrap gap-1",children:i.foundIn.map((n,d)=>e.jsx("span",{className:t("text-[10px] px-2 py-0.5 rounded border flex items-center",a.surface.highlight,a.border.default,a.text.secondary),children:n},`conflict-${i.id}-hit-${n}-${d}`))}):e.jsx("span",{className:t("text-xs italic",a.text.tertiary),children:"No hits found"})}),e.jsx(V,{children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ws,{className:t("h-3 w-3",a.text.tertiary)}),e.jsx("span",{className:t("text-xs",a.text.secondary),children:i.checkedBy})]})}),e.jsx(V,{className:"text-right",children:e.jsx(_,{variant:"ghost",size:"sm",className:"text-blue-600",children:"View PDF"})})]},i.id))})]})]})},la=c.memo(Ql);la.displayName="ComplianceConflicts";const Xl=Object.freeze(Object.defineProperty({__proto__:null,ComplianceConflicts:la},Symbol.toStringTag,{value:"Module"})),yt=c.lazy(()=>k(()=>Promise.resolve().then(()=>li),void 0).then(s=>({default:s.ComplianceOverview}))),ei=c.lazy(()=>k(()=>Promise.resolve().then(()=>Xl),void 0).then(s=>({default:s.ComplianceConflicts}))),si=c.lazy(()=>k(()=>Promise.resolve().then(()=>mi),void 0).then(s=>({default:s.ComplianceWalls}))),ti=c.lazy(()=>k(()=>Promise.resolve().then(()=>ni),void 0).then(s=>({default:s.CompliancePolicies}))),ai=({activeTab:s})=>{const{data:a=[]}=F(U.compliance.conflicts(),()=>I.compliance.getConflicts()),{data:r=[]}=F(U.compliance.ethicalWalls(),()=>I.compliance.getEthicalWalls());switch(s){case"overview":return e.jsx(yt,{});case"conflicts":return e.jsx(ei,{conflicts:a});case"walls":return e.jsx(si,{walls:r});case"policies":return e.jsx(ti,{});default:return e.jsx(yt,{})}},ri=c.memo(ai);ri.displayName="ComplianceDashboardContent";const ia=c.memo(()=>{const{theme:s,mode:a}=D(),r=ea(),{data:l=[],isLoading:o}=F(["compliance","riskStats"],()=>I.compliance.getRiskStats(a)),{data:i,isLoading:n}=F(["compliance","riskMetrics"],I.compliance.getRiskMetrics);return o||n?e.jsx("div",{className:"flex justify-center p-12",children:e.jsx(re,{className:"animate-spin h-6 w-6 text-blue-600"})}):e.jsxs("div",{className:"space-y-6 animate-fade-in",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsx(ne,{label:"Compliance Score",value:`${i?.score}/100`,icon:Me,trend:"+2% vs Last Qtr",trendUp:!0,className:"border-l-4 border-l-emerald-500"}),e.jsx(ne,{label:"Pending Conflicts",value:i?.high||0,icon:be,trend:"Needs Review",trendUp:!1,className:"border-l-4 border-l-amber-500"}),e.jsx(ne,{label:"Active Walls",value:i?.activeWalls||0,icon:Q,className:"border-l-4 border-l-blue-500"}),e.jsx(ne,{label:"Policy Violations",value:i?.violations||0,icon:ie,className:"border-l-4 border-l-green-500"})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsx(ye,{title:"Client Risk Profile",className:"lg:col-span-2",children:e.jsxs("div",{className:"flex flex-col md:flex-row items-center",children:[e.jsx("div",{className:"h-64 w-full md:w-1/2",children:e.jsx(Ls,{width:"100%",height:"100%",children:e.jsxs(Ut,{children:[e.jsx(Gt,{data:l,innerRadius:60,outerRadius:80,paddingAngle:5,dataKey:"value",children:l.map((d,m)=>e.jsx(qt,{fill:d.color},`compliance-risk-${d.name}-${m}`))}),e.jsx(Ms,{contentStyle:r.tooltipStyle}),e.jsx(Os,{verticalAlign:"bottom",height:36})]})})}),e.jsx("div",{className:"w-full md:w-1/2 space-y-4 p-4",children:e.jsxs("div",{className:t("p-4 rounded-lg border",s.surface.highlight,s.border.default),children:[e.jsx("h4",{className:t("font-bold text-sm mb-2",s.text.primary),children:"High Risk Factors"}),e.jsxs("ul",{className:t("space-y-2 text-xs",s.text.secondary),children:[e.jsxs("li",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-1.5 h-1.5 rounded-full bg-red-500"})," Politically Exposed Persons (PEP)"]}),e.jsxs("li",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-1.5 h-1.5 rounded-full bg-red-500"})," Sanctions List Matches"]}),e.jsxs("li",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-1.5 h-1.5 rounded-full bg-amber-500"})," Missing Engagement Letters"]})]})]})})]})}),e.jsx(ye,{title:"Recent Alerts",children:e.jsx("div",{className:"space-y-4",children:[{title:"Conflict Hit: MegaCorp",time:"2 hours ago",severity:"medium"},{title:"Ethical Wall Update",time:"5 hours ago",severity:"low"},{title:"GDPR Data Request",time:"Yesterday",severity:"high"}].map((d,m)=>e.jsxs("div",{className:t("flex items-start p-3 rounded-lg border transition-colors",s.surface.highlight,s.border.default),children:[e.jsx(Hs,{className:t("h-4 w-4 mt-0.5 mr-3",d.severity==="high"?"text-red-500":d.severity==="medium"?"text-amber-500":"text-blue-500")}),e.jsxs("div",{children:[e.jsx("p",{className:t("text-sm font-bold",s.text.primary),children:d.title}),e.jsx("p",{className:t("text-xs",s.text.tertiary),children:d.time})]})]},`alert-${d.title.replace(/\s+/g,"-")}-${m}`))})})]})]})});ia.displayName="ComplianceOverview";const li=Object.freeze(Object.defineProperty({__proto__:null,ComplianceOverview:ia},Symbol.toStringTag,{value:"Module"})),ii=()=>{const{theme:s}=D(),{openWindow:a}=_e(),{data:r=[],isLoading:l}=F(["policies","all"],I.compliance.getPolicies),o=i=>{const n=`policy-${i.id}`;a(n,`Policy: ${i.title}`,e.jsx("div",{className:"h-full bg-white",children:e.jsx(Qt,{document:{id:i.id,title:i.title,type:"Policy",content:"Policy Content Preview...",uploadDate:i.date,lastModified:i.date,tags:["Compliance","Policy"],versions:[],caseId:"General",status:i.status},onViewHistory:()=>{},isOrbital:!0})}))};return l?e.jsx(Kr,{contentType:"list",shimmer:!0,itemCount:5}):e.jsxs("div",{className:"space-y-6 animate-fade-in",children:[e.jsxs("div",{className:t("flex justify-between items-start p-4 rounded-lg border",s.surface.default,s.border.default),children:[e.jsxs("div",{children:[e.jsx("h3",{className:t("font-bold text-lg",s.text.primary),children:"Regulatory Policies"}),e.jsx("p",{className:t("text-sm",s.text.secondary),children:"Firm-wide compliance documents and SOPs."})]}),e.jsx(_,{variant:"outline",children:"Upload New Version"})]}),e.jsxs(We,{responsive:"card",children:[e.jsxs(He,{children:[e.jsx(B,{children:"Policy Name"}),e.jsx(B,{children:"Version"}),e.jsx(B,{children:"Last Updated"}),e.jsx(B,{children:"Status"}),e.jsx(B,{className:"text-right",children:"Actions"})]}),e.jsx(Ue,{children:r.map(i=>e.jsxs(Ie,{children:[e.jsx(V,{children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:t("p-2 rounded bg-blue-50 text-blue-600"),children:e.jsx(Q,{className:"h-4 w-4"})}),e.jsx("span",{className:t("font-medium",s.text.primary),children:i.title})]})}),e.jsx(V,{children:e.jsxs("span",{className:t("font-mono text-xs",s.text.secondary),children:["v",i.version]})}),e.jsx(V,{children:e.jsxs("div",{className:t("flex items-center text-xs",s.text.secondary),children:[e.jsx(pe,{className:"h-3 w-3 mr-1"})," ",i.date]})}),e.jsx(V,{children:e.jsx(K,{variant:i.status==="Active"?"success":"warning",children:i.status})}),e.jsx(V,{className:"text-right",children:e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(_,{size:"sm",variant:"ghost",icon:Be,onClick:()=>o(i),children:"View"}),e.jsx(_,{size:"sm",variant:"ghost",icon:$e,children:"PDF"})]})})]},i.id))})]})]})},na=c.memo(ii);na.displayName="CompliancePolicies";const ni=Object.freeze(Object.defineProperty({__proto__:null,CompliancePolicies:na},Symbol.toStringTag,{value:"Module"})),oi=()=>{const{data:s={high:0,missingDocs:0,violations:0}}=F(U.compliance.riskMetrics?.()||["compliance","riskMetrics"],()=>I.compliance.getRiskMetrics());return e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[e.jsx(ne,{label:"High Risk Clients",value:s.high,icon:Me,className:"border-l-4 border-l-rose-500"}),e.jsx(ne,{label:"Missing Engagement Letters",value:s.missingDocs,icon:Q,className:"border-l-4 border-l-amber-500"}),e.jsx(ne,{label:"Data Policy Violations",value:s.violations,icon:be,className:"border-l-4 border-l-blue-500"})]})},ci=c.memo(oi);ci.displayName="ComplianceRisk";const di=({walls:s})=>{const{theme:a}=D();return e.jsxs("div",{className:"space-y-6 animate-fade-in",children:[e.jsxs("div",{className:t("flex justify-between items-center p-4 rounded-lg border shadow-sm",a.surface.default,a.border.default),children:[e.jsxs("div",{children:[e.jsx("h3",{className:t("font-bold text-lg",a.text.primary),children:"Information Barriers"}),e.jsx("p",{className:t("text-sm",a.text.secondary),children:"Manage ethical walls and restrict access to sensitive matters."})]}),e.jsx(_,{variant:"primary",icon:J,children:"Create Wall"})]}),e.jsx("div",{className:"grid grid-cols-1 gap-4",children:s.map(r=>e.jsxs(ye,{noPadding:!0,className:t("flex flex-col md:flex-row justify-between items-stretch transition-all hover:shadow-md overflow-hidden",`hover:${a.border.default}`),children:[e.jsx("div",{className:t("w-2 bg-red-500 md:w-2 md:h-auto h-2")}),e.jsxs("div",{className:"flex-1 p-6 flex flex-col md:flex-row gap-6",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx("h3",{className:t("font-bold text-lg",a.text.primary),children:r.title}),e.jsx("span",{className:t("text-xs px-2 py-0.5 rounded font-bold uppercase",a.status.success.bg,a.status.success.text),children:"Active"})]}),e.jsxs("p",{className:t("text-sm mb-4 flex items-center",a.text.secondary),children:[e.jsx(fe,{className:"h-3.5 w-3.5 mr-1.5"})," Matter Ref: ",e.jsx("span",{className:t("font-mono ml-1",a.text.primary),children:r.caseId})]}),e.jsxs("div",{className:"flex items-center text-xs text-green-600 font-medium",children:[e.jsx(ie,{className:"h-3 w-3 mr-1"})," Enforced via IAM Policy"]})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-6 md:border-l pl-0 md:pl-6 border-slate-100 dark:border-slate-800",children:[e.jsxs("div",{children:[e.jsxs("span",{className:t("text-xs font-bold uppercase mb-2 flex items-center",a.text.secondary),children:[e.jsx(Oe,{className:"h-3 w-3 mr-1"})," Restricted"]}),e.jsx("div",{className:"flex flex-wrap gap-1 max-w-[200px]",children:r.restrictedGroups.map(l=>e.jsx("span",{className:t("px-2 py-1 rounded text-xs border bg-red-50 border-red-100 text-red-700"),children:l},l))})]}),e.jsxs("div",{children:[e.jsxs("span",{className:t("text-xs font-bold uppercase mb-2 flex items-center",a.text.secondary),children:[e.jsx(de,{className:"h-3 w-3 mr-1"})," Authorized"]}),e.jsx("div",{className:"flex flex-wrap gap-1 max-w-[200px]",children:r.authorizedUsers.map(l=>e.jsx("span",{className:t("px-2 py-1 rounded text-xs border bg-green-50 border-green-100 text-green-700"),children:l},l))})]})]})]}),e.jsxs("div",{className:t("flex md:flex-col items-center justify-center p-4 border-t md:border-t-0 md:border-l gap-2",a.surface.highlight,a.border.default),children:[e.jsx(_,{variant:"ghost",size:"sm",className:"w-full",children:"Audit Log"}),e.jsx(_,{variant:"outline",size:"sm",className:"w-full",children:"Edit Policy"})]})]},r.id))})]})},oa=c.memo(di);oa.displayName="ComplianceWalls";const mi=Object.freeze(Object.defineProperty({__proto__:null,ComplianceWalls:oa},Symbol.toStringTag,{value:"Module"})),ca=z.memo(({items:s,onSelect:a,selectedId:r})=>{const{theme:l}=D(),[o,i]=c.useState(0);ys([{key:"ArrowDown",callback:()=>{const m=Math.min(o+1,s.length-1);i(m)},description:"Move down"},{key:"ArrowUp",callback:()=>{const m=Math.max(o-1,0);i(m)},description:"Move up"},{key:"Enter",callback:()=>{s[o]&&a(s[o])},description:"Open item"}]);const n=c.useCallback(m=>e.jsxs("div",{onClick:()=>a(m),className:t("flex items-center border-b px-4 h-[60px] cursor-pointer transition-colors hover:bg-slate-50",l.border.default,r===m.id?l.surface.highlight:""),children:[e.jsx("div",{className:"w-24 shrink-0",children:e.jsxs("div",{className:t("flex items-center text-xs font-bold",m.direction==="Inbound"?"text-green-600":"text-blue-600"),children:[m.direction==="Inbound"?e.jsx(Ka,{className:"h-4 w-4 mr-1"}):e.jsx(At,{className:"h-4 w-4 mr-1"}),m.direction]})}),e.jsxs("div",{className:"w-32 shrink-0 flex items-center gap-2 text-sm",children:[e.jsx(Us,{className:t("h-4 w-4",l.text.tertiary)}),e.jsx("span",{className:l.text.primary,children:m.type})]}),e.jsxs("div",{className:"flex-1 min-w-0 flex items-center gap-2 pr-4",children:[m.isPrivileged&&e.jsx("div",{title:"Privileged",className:"shrink-0",children:e.jsx(Pe,{className:"h-3 w-3 text-amber-500"})}),e.jsx("span",{className:t("font-medium truncate",l.text.primary),children:m.subject}),m.hasAttachment&&e.jsx(Ja,{className:"h-3 w-3 text-slate-400 shrink-0"})]}),e.jsxs("div",{className:"w-40 shrink-0 flex flex-col text-xs",children:[e.jsx("span",{className:l.text.primary,children:m.direction==="Inbound"?m.sender:m.recipient}),e.jsx("span",{className:l.text.tertiary,children:m.caseId})]}),e.jsx("div",{className:"w-24 shrink-0 text-xs text-right text-slate-500 mr-4",children:m.date}),e.jsx("div",{className:"w-20 shrink-0 text-right",children:e.jsx(K,{variant:m.status===ms.SENT||m.status===ms.READ?"success":m.status===ms.FAILED?"error":"warning",children:m.status})})]},m.id),[l,r,a]),d=c.useMemo(()=>s,[s]);return e.jsxs("div",{className:"flex-1 flex flex-col overflow-hidden",children:[e.jsxs("div",{className:t("flex items-center px-4 py-3 border-b font-bold text-xs uppercase tracking-wider bg-slate-50 shrink-0",l.border.default,l.text.secondary),children:[e.jsx("div",{className:"w-24",children:"Direction"}),e.jsx("div",{className:"w-32",children:"Type"}),e.jsx("div",{className:"flex-1",children:"Subject"}),e.jsx("div",{className:"w-40",children:"Correspondent"}),e.jsx("div",{className:"w-24 text-right mr-4",children:"Date"}),e.jsx("div",{className:"w-20 text-right",children:"Status"})]}),e.jsx("div",{className:"flex-1 min-h-0 relative",children:e.jsx(rs,{items:d,height:"100%",itemHeight:60,renderItem:n,emptyMessage:"No communications found."})})]})});ca.displayName="CommunicationLog";ca.displayName="CommunicationLog";const we=s=>s.trim().replace(/[<>]/g,""),da=s=>s.replace(/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi,""),ui=Vt({id:q().min(1,"ID is required"),caseId:q().min(1,"Case ID is required"),userId:q().min(1,"User ID is required"),subject:q().min(1,"Subject is required").max(500,"Subject too long").transform(we),date:q().regex(/^\d{4}-\d{2}-\d{2}$/,"Invalid date format (YYYY-MM-DD)"),type:Ps(["Letter","Email","Fax","Notice","Memo"]),direction:Ps(["Inbound","Outbound"]),sender:q().min(1,"Sender is required").max(200,"Sender name too long").transform(we),recipient:q().min(1,"Recipient is required").max(200,"Recipient name too long").transform(we),preview:q().max(5e3,"Preview content too long").transform(da),hasAttachment:nt().default(!1),status:Ft(ms),isPrivileged:nt().default(!1),attachmentIds:it(q()).optional(),threadId:q().optional(),inReplyTo:q().optional(),tags:it(q()).optional()}).strict(),xi=Vt({id:q().min(1,"ID is required"),caseId:q().min(1,"Case ID is required"),requestorId:q().min(1,"Requestor ID is required"),documentTitle:q().min(1,"Document title is required").max(300,"Document title too long").transform(we),targetPerson:q().min(1,"Target person is required").max(200,"Target person name too long").transform(we),targetAddress:q().min(1,"Target address is required").max(500,"Address too long").transform(we),serverName:q().min(1,"Server/carrier name is required").max(200,"Server name too long").transform(we),method:Ps(["Process Server","Mail"]),status:Ft(Je),dueDate:q().regex(/^\d{4}-\d{2}-\d{2}$/,"Invalid due date format (YYYY-MM-DD)").refine(s=>new Date(s)>=new Date(Zs()),"Due date cannot be in the past"),attempts:wr().int().min(0).max(10,"Attempts exceeded maximum").default(0),mailType:q().max(100).optional(),trackingNumber:q().max(100).regex(/^[A-Z0-9\s-]*$/,"Invalid tracking number format").optional(),addressedTo:q().max(200).transform(we).optional(),servedDate:q().regex(/^\d{4}-\d{2}-\d{2}$/).optional(),signerName:q().max(200).transform(we).optional(),gpsCoordinates:q().regex(/^-?\d+\.\d+,\s*-?\d+\.\d+$/,"Invalid GPS coordinates").optional(),notes:q().max(2e3).transform(da).optional(),proofDocumentId:q().optional()}).strict();ui.partial().strict();xi.partial().strict();const ma=z.memo(({jobs:s,onSelect:a,selectedId:r})=>{const{theme:l}=D(),o=c.useCallback((d,m)=>d==="Mail"?e.jsx(Za,{className:"h-4 w-4 text-purple-600"}):e.jsx(Ws,{className:"h-4 w-4 text-blue-600"}),[]),i=c.useCallback(d=>{switch(d){case Je.SERVED:case Je.FILED:return"success";case Je.OUT_FOR_SERVICE:return"warning";case Je.NON_EST:return"error";default:return"neutral"}},[]),n=c.useMemo(()=>s,[s]);return e.jsx("div",{className:"flex-1 overflow-auto custom-scrollbar p-6 bg-slate-50/50",children:e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:n.map(d=>e.jsxs("div",{onClick:()=>a(d),className:t("p-5 rounded-xl border shadow-sm cursor-pointer transition-all hover:shadow-md group flex flex-col",l.surface.default,l.border.default,r===d.id?"ring-2 ring-blue-500 border-blue-500":`hover:${l.primary.border}`),children:[e.jsxs("div",{className:"flex justify-between items-start mb-3",children:[e.jsx(K,{variant:i(d.status),children:d.status}),e.jsx("span",{className:t("text-xs font-mono",l.text.tertiary),children:d.id})]}),e.jsx("h4",{className:t("font-bold text-sm mb-1",l.text.primary),children:d.targetPerson}),e.jsxs("div",{className:t("text-xs flex items-center mb-4",l.text.secondary),children:[e.jsx(Gs,{className:"h-3 w-3 mr-1"})," ",d.targetAddress]}),e.jsxs("div",{className:t("mt-auto pt-4 border-t space-y-2",l.border.default),children:[e.jsxs("div",{className:"flex justify-between text-xs",children:[e.jsx("span",{className:l.text.secondary,children:"Document"}),e.jsx("span",{className:t("font-medium truncate max-w-[120px]",l.text.primary),children:d.documentTitle})]}),e.jsxs("div",{className:"flex justify-between text-xs items-center",children:[e.jsx("span",{className:l.text.secondary,children:"Method"}),e.jsxs("div",{className:"flex items-center gap-1 font-medium",children:[o(d.method,d.mailType),e.jsx("span",{children:d.method==="Mail"?"Mail":"Server"})]})]}),d.trackingNumber&&e.jsxs("div",{className:"flex justify-between text-xs",children:[e.jsx("span",{className:l.text.secondary,children:"Tracking"}),e.jsx("span",{className:"font-mono text-[10px]",children:d.trackingNumber})]}),e.jsxs("div",{className:"flex justify-between text-xs",children:[e.jsx("span",{className:l.text.secondary,children:"Carrier/Agent"}),e.jsx("span",{className:l.text.primary,children:d.serverName})]})]})]},d.id))})})});ma.displayName="ServiceTracker";ma.displayName="ServiceTracker";const hi=z.memo(({name:s,size:a,type:r="doc",date:l,onDownload:o,onPreview:i,className:n="",variant:d="card"})=>{const{theme:m}=D();return e.jsxs("div",{className:t("flex items-center p-3 rounded-lg transition-all group overflow-hidden",d==="card"?t(m.surface.default,m.border.default,"border hover:shadow-md"):"",n),children:[e.jsx("div",{className:t("p-2 rounded-lg mr-3 shrink-0",m.surface.highlight),children:e.jsx(vs,{type:r,className:"h-6 w-6"})}),e.jsxs("div",{className:"flex-1 min-w-0 mr-2",children:[e.jsx("h4",{className:t("text-sm font-medium truncate",m.text.primary),title:s,children:s}),e.jsxs("div",{className:t("flex items-center gap-2 text-xs mt-0.5",m.text.secondary),children:[a&&e.jsx("span",{children:a}),l&&e.jsxs(e.Fragment,{children:[e.jsx("span",{children:"•"}),e.jsx("span",{children:new Date(l).toLocaleDateString()})]})]})]}),e.jsxs("div",{className:"flex gap-1 opacity-0 group-hover:opacity-100 transition-opacity",children:[i&&e.jsx("button",{onClick:f=>{f.stopPropagation(),i()},className:t("p-1.5 rounded",m.text.secondary,`hover:${m.surface.highlight}`,`hover:${m.primary.text}`),title:"Preview",children:e.jsx(Be,{className:"h-4 w-4"})}),e.jsx("button",{onClick:f=>{f.stopPropagation(),o&&o()},className:t("p-1.5 rounded",m.text.secondary,`hover:${m.surface.highlight}`,`hover:${m.primary.text}`),title:"Download",children:e.jsx($e,{className:"h-4 w-4"})})]})]})}),ua=c.memo(function({text:a,sender:r,isMe:l,timestamp:o,status:i,isPrivileged:n,children:d}){const{theme:m}=D();return e.jsxs("div",{className:t("flex w-full group/msg animate-fade-in-up",l?"justify-end":"justify-start"),children:[!l&&e.jsx(Kt,{name:r,size:"xs",className:"mt-1 mr-2 self-start"}),e.jsxs("div",{className:t("flex flex-col max-w-[85%] md:max-w-[70%]",l?"items-end":"items-start"),children:[n&&e.jsxs("div",{className:t("text-[10px] font-bold mb-1 flex items-center px-2 py-0.5 rounded-full border shadow-sm",m.status.warning.text,m.status.warning.bg,m.status.warning.border),children:[e.jsx(Pe,{className:"h-3 w-3 mr-1"})," PRIVILEGED"]}),e.jsxs("div",{className:t("p-3 rounded-2xl text-sm shadow-sm relative",l?t(m.primary.DEFAULT,m.text.inverse,"rounded-tr-none"):t(m.surface.default,m.text.primary,m.border.default,"border rounded-tl-none")),children:[e.jsx("div",{className:"whitespace-pre-wrap leading-relaxed",children:a}),d&&e.jsx("div",{className:"mt-3 space-y-2 w-full",children:d}),e.jsxs("div",{className:t("text-[10px] mt-1.5 flex items-center justify-end",l?"text-white/80":m.text.tertiary),children:[o,l&&i&&e.jsx("span",{className:"ml-1",title:i,children:i==="read"?e.jsx(st,{className:"h-3 w-3"}):i==="delivered"?e.jsx(st,{className:"h-3 w-3 opacity-70"}):e.jsx(Bs,{className:"h-3 w-3"})})]})]})]})]})});ua.displayName="ChatBubble";const fi=c.memo(function({conversation:a,currentUserId:r,formatTime:l}){const o=c.useRef(null),{theme:i}=D();return c.useEffect(()=>{o.current?.scrollIntoView({behavior:"smooth"})},[a.messages]),e.jsxs("div",{className:t("flex-1 overflow-y-auto p-4 space-y-4 pt-8 scrollbar-thin",i.surface.highlight),children:[a.messages.map(n=>{const d=n.senderId===r;return e.jsx(ua,{text:n.text,sender:d?"Me":a.name,isMe:d,timestamp:l(n.timestamp),status:n.status,isPrivileged:n.isPrivileged,children:n.attachments&&n.attachments.map((m,f)=>e.jsx("div",{className:"mt-2 w-full max-w-sm",children:e.jsx(hi,{name:m.name,size:typeof m.size=="number"?String(m.size):m.size,type:m.type,className:t(d?t(i.primary.light,"text-current border-blue-500/30"):i.surface.default),variant:"card",onDownload:()=>console.log("Downloading",m.name)})},`msg-${n.id}-att-${m.name}-${f}`))},n.id)}),e.jsx("div",{ref:o})]})});fi.displayName="MessageList";z.memo(({sidebar:s,content:a,showSidebarOnMobile:r=!0,className:l=""})=>{const{theme:o}=D();return e.jsxs("div",{className:t("flex-1 flex flex-col md:flex-row rounded-lg overflow-hidden min-h-0",o.surface.default,o.border.default,"border shadow-sm",l),children:[e.jsx("div",{className:t("w-full md:w-80 lg:w-96 flex flex-col h-full border-r",o.border.default,o.surface.highlight,r?"flex":"hidden md:flex"),children:s}),e.jsx("div",{className:t("flex-1 flex flex-col min-w-0 h-full",o.surface.default,r?"hidden md:flex":"flex"),children:a})]})});const pi=1e3;function gi(s,a="Overview",r,l){const[o,i]=c.useState(a),[n,d]=c.useState(!1),[m]=c.useState(null),[f,u]=c.useState(""),[x]=c.useState(""),[p]=c.useState(!1),h=De(),{data:j=[]}=F(U.documents.byCaseId(s?.id),()=>I.documents.getByCaseId(s.id),{enabled:!!s?.id,initialData:r}),{data:N=[]}=F(U.tasks.byCaseId(s?.id),()=>I.tasks.getByCaseId(s.id),{enabled:!!s?.id}),{data:y=[]}=F(U.billing.timeEntries(),()=>I.billing.getTimeEntries({caseId:s.id}),{enabled:!!s?.id}),{data:v=[]}=F(U.motions.byCaseId(s?.id),()=>I.motions.getByCaseId(s.id),{enabled:!!s?.id}),{data:S=[]}=F(U.projects.byCaseId(s?.id),()=>I.projects.getByCaseId(s.id),{enabled:!!s?.id}),[C,b]=c.useState(l||s.parties||[]),w=c.useMemo(()=>!Array.isArray(N)||N.length===0?[]:[{id:"s1",title:"Active Tasks",status:"Active",tasks:N.filter(M=>M.status?.toString()!=="COMPLETED"&&M.status?.toString()!=="Done")},{id:"s2",title:"Completed",status:"Completed",tasks:N.filter(M=>M.status?.toString()==="COMPLETED"||M.status?.toString()==="Done")}],[N]),g=c.useMemo(()=>{const M=[];return M.push({id:"init",date:s.filingDate,title:"Case Filed",type:"milestone",description:`Filed in ${s.court}`}),Array.isArray(j)&&j.forEach(R=>{M.push({id:R.id,date:R.uploadDate,title:`Doc Upload: ${R.title}`,type:"document",description:R.summary||R.type,relatedId:R.id})}),Array.isArray(y)&&y.forEach(R=>{M.push({id:R.id,date:R.date,title:"Billable Time Logged",type:"billing",description:`${(R.duration/60).toFixed(1)}h - ${R.description}`,relatedId:R.id})}),Array.isArray(v)&&v.forEach(R=>{R.filingDate&&M.push({id:`mot-file-${R.id}`,date:R.filingDate,title:`Motion Filed: ${R.title}`,type:"motion",description:`Type: ${R.type} | Status: ${R.status}`,relatedId:R.id}),R.hearingDate&&M.push({id:`mot-hear-${R.id}`,date:R.hearingDate,title:`Hearing Scheduled: ${R.title}`,type:"hearing",description:"Court Appearance Required",relatedId:R.id})}),M.sort((R,te)=>new Date(te.date).getTime()-new Date(R.date).getTime())},[s,j,y,v]);return{activeTab:o,setActiveTab:i,documents:j,setDocuments:M=>{Y.setQueryData(U.documents.byCaseId(s.id),M)},stages:w,allTasks:N,parties:C,setParties:b,motions:v,projects:S,addProject:async M=>{Y.setQueryData(U.projects.byCaseId(s.id),[...S,M])},addTaskToProject:()=>{Y.invalidate(U.projects.byCaseId(s.id)),Y.invalidate(U.tasks.byCaseId(s.id))},updateProjectTaskStatus:async M=>{try{const R=N.find(P=>P.id===M);if(!R){console.warn(`Task ${M} not found`);return}const te=R.status?.toString()==="COMPLETED"||R.status?.toString()==="Done"?"Pending":"Done";await I.tasks.update(M,{status:te}),Y.invalidate(U.projects.byCaseId(s.id)),Y.invalidate(U.tasks.byCaseId(s.id)),h.success(`Task status updated to ${te}`)}catch(R){console.error("Failed to update task status",R),h.error("Failed to update task status")}},billingEntries:y,setBillingEntries:M=>{Y.setQueryData(U.billing.timeEntries(),M)},generatingWorkflow:n,generateAIWorkflow:async()=>{d(!0),setTimeout(()=>d(!1),pi+500)},analyzeWithAI:async()=>{},analyzingId:m,draftPrompt:f,setDraftPrompt:u,draftResult:x,draftDocument:async()=>{},isDrafting:p,timelineEvents:g}}function ji(s,a,r){const{performMutation:l}=Or(),[o,i]=c.useState(!1),[n,d]=c.useState(!1),[m,f]=c.useState(!1),[u,x]=c.useState([]),[p,h]=c.useState([]);return c.useEffect(()=>{(async()=>{const S=await I.cases.getAll(),C=S.filter(w=>s.linkedCaseIds?.includes(w.id));x(C);const b=S.filter(w=>w.id!==s.id&&!s.linkedCaseIds?.includes(w.id));h(b)})()},[s]),{showTimeModal:o,setShowTimeModal:i,openTimeModal:()=>i(!0),closeTimeModal:()=>i(!1),showLinkModal:n,setShowLinkModal:d,openLinkModal:()=>d(!0),closeLinkModal:()=>d(!1),showTransferModal:m,setShowTransferModal:f,openTransferModal:()=>f(!0),closeTransferModal:()=>f(!1),linkedCases:u,availableCases:p,handleSaveTime:v=>{const S={...v,id:`t-${Date.now()}`,userId:"current-user",billable:!0,caseId:s.id};l("BILLING_LOG",S,()=>I.billing.addTimeEntry(S)),a(S)},handleLinkCase:v=>{u.find(S=>S.id===v.id)||x([...u,v])},handleTransferToAppeal:async()=>{const v={...s,id:`APP-${Date.now()}`,title:`Appeal: ${s.title}`,matterType:Zr.LITIGATION,status:Jr.Appeal,jurisdiction:"Appellate Court",court:"Circuit Court of Appeals",filingDate:new Date().toISOString().split("T")[0],linkedCaseIds:[s.id,...s.linkedCaseIds||[]]};try{await I.cases.add(v),x([...u,v]),f(!1),confirm(`Appeal case created: ${v.title}. Switch to new matter?`)&&r&&r(v)}catch{alert("Failed to create appeal case.")}}}}const zs=[{id:"dashboard_parent",label:"Dashboard",subTabs:[{id:"dashboard",label:"Overview"}]},{id:"collection",label:"Collection",subTabs:[{id:"esi",label:"ESI Map"},{id:"custodians",label:"Custodians"},{id:"interviews",label:"Interviews"},{id:"holds",label:"Legal Holds"}]},{id:"review",label:"Review & Production",subTabs:[{id:"requests",label:"Requests"},{id:"productions",label:"Productions"},{id:"privilege",label:"Privilege Log"}]},{id:"proceedings",label:"Proceedings",subTabs:[{id:"depositions",label:"Depositions"},{id:"examinations",label:"Examinations"},{id:"plan",label:"Discovery Plan"}]}],bi=s=>zs.find(a=>a.subTabs.some(r=>r.id===s))||zs[0],vi=s=>{const a=zs.find(r=>r.id===s);return a&&a.subTabs.length>0?a.subTabs[0].id:"dashboard"};function yi(s){const[a,r]=c.useState("dashboard"),[l,o]=c.useState("overview"),[i,n]=c.useState(null);c.useEffect(()=>{console.log(`[useEvidenceVault] Initialized ${s?`with case scope: ${s}`:"in global mode"}`)},[s]);const{data:d,isLoading:m}=F(U.evidence.all(),()=>I.evidence.getAll()),f=c.useMemo(()=>d?Array.isArray(d)?d:typeof d=="object"&&"data"in d&&Array.isArray(d.data)?d.data:typeof d=="object"&&"items"in d&&Array.isArray(d.items)?d.items:(console.warn("[useEvidenceVault] Data is not an array:",d),[]):[],[d]),u=c.useMemo(()=>s?f.filter(g=>g.caseId===s):f,[f,s]),{mutate:x}=le(I.evidence.add,{invalidateKeys:[U.evidence.all()]}),{mutate:p}=le(g=>I.evidence.update(g.id,g),{invalidateKeys:[U.evidence.all()]}),[h,j]=c.useState({search:"",type:"",admissibility:"",caseId:s||"",custodian:"",dateFrom:"",dateTo:"",location:"",tags:"",collectedBy:"",hasBlockchain:!1});c.useEffect(()=>{s&&(j(g=>({...g,caseId:s})),console.log(`[useEvidenceVault] Filter synchronized with caseId: ${s}`))},[s]);const N=c.useCallback(g=>{if(!g||!g.id){console.error("[useEvidenceVault.handleItemClick] Invalid item:",g);return}try{n(g),r("detail"),o("overview"),console.log(`[useEvidenceVault] Item selected: ${g.id}`)}catch(T){console.error("[useEvidenceVault.handleItemClick] Navigation error:",T)}},[]),y=c.useCallback(()=>{n(null),r("inventory"),console.log("[useEvidenceVault] Returned to inventory view")},[]),v=c.useCallback(g=>{if(!g||!g.id){console.error("[useEvidenceVault.handleIntakeComplete] Invalid evidence item:",g),alert("Error: Invalid evidence item. Please check all required fields.");return}try{s&&g.caseId!==s&&(console.log(`[useEvidenceVault] Applying case scope: ${s}`),g.caseId=s),x(g),r("inventory"),console.log(`[useEvidenceVault] Evidence intake completed: ${g.id}`),alert("Item logged successfully.")}catch(T){console.error("[useEvidenceVault.handleIntakeComplete] Error:",T),alert("Error: Failed to save evidence item. Please try again.")}},[s,x]),S=c.useCallback(g=>{if(!i){console.error("[useEvidenceVault.handleCustodyUpdate] No item selected");return}if(!g||!g.actor||!g.date){console.error("[useEvidenceVault.handleCustodyUpdate] Invalid custody event:",g),alert("Error: Invalid custody event. Please check all required fields.");return}try{const T={...i,chainOfCustody:[g,...i.chainOfCustody],custodian:g.actor};n(T),p(T),console.log(`[useEvidenceVault] Custody updated for: ${i.id}`)}catch(T){console.error("[useEvidenceVault.handleCustodyUpdate] Error:",T),alert("Error: Failed to update custody. Please try again.")}},[i,p]),C=c.useMemo(()=>{try{return u.filter(g=>{const T=!h.search||g.title?.toLowerCase().includes(h.search.toLowerCase())||g.description?.toLowerCase().includes(h.search.toLowerCase()),E=!h.type||g.type===h.type,L=!h.admissibility||g.admissibility===h.admissibility,W=!h.caseId||g.caseId?.toLowerCase().includes(h.caseId.toLowerCase()),X=!h.custodian||g.custodian?.toLowerCase().includes(h.custodian.toLowerCase()),me=!h.dateFrom||g.collectionDate&&g.collectionDate>=h.dateFrom,M=!h.dateTo||g.collectionDate&&g.collectionDate<=h.dateTo,R=!h.location||g.location?.toLowerCase().includes(h.location.toLowerCase()),te=!h.tags||g.tags?.some($=>$.toLowerCase().includes(h.tags.toLowerCase())),P=!h.collectedBy||g.collectedBy?.toLowerCase().includes(h.collectedBy.toLowerCase()),O=!h.hasBlockchain||g.blockchainHash&&g.blockchainHash.length>0;return T&&E&&L&&W&&X&&me&&M&&R&&te&&P&&O})}catch(g){return console.error("[useEvidenceVault] Filtering error:",g),u}},[h,u]),b=c.useCallback((g,T)=>{j(E=>({...E,[g]:T}))},[]),w=c.useCallback(()=>{j({search:"",type:"",admissibility:"",caseId:s||"",custodian:"",dateFrom:"",dateTo:"",location:"",tags:"",collectedBy:"",hasBlockchain:!1})},[s]);return{view:a,setView:r,activeTab:l,setActiveTab:o,selectedItem:i,selectItem:n,allItems:f,evidenceItems:u,filters:h,setFilters:j,updateFilter:b,clearFilters:w,filteredItems:C,handleItemClick:N,viewDetail:N,handleBack:y,goBack:y,handleIntakeComplete:v,handleCustodyUpdate:S,isLoading:m}}c.lazy(()=>k(()=>import("./CRMDashboard-CLEhLzSW.js"),__vite__mapDeps([92,1,2,3,6,4,5,7,10,24,25,93,94,13,15,16,11,12,17,18,19,20,21,22,9,23,8,26,27,28,14,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44])).then(s=>({default:s.CRMDashboard})));c.lazy(()=>k(()=>import("./ClientDirectory-DHCcbzBr.js"),__vite__mapDeps([95,1,2,3,6,7,21,10,15,13,30,20,4,5,9,11,81,8,16,12,17,18,19,22,23,24,25,26,27,28,14,29,31,32,33,34,35,36,37,38,39,40,41,42,43,44])).then(s=>({default:s.ClientDirectory})));c.lazy(()=>k(()=>import("./CRMPipeline-fOBdLT84.js"),__vite__mapDeps([96,1,2,3,6,4,5,7,10,11,41,9,29])));c.lazy(()=>k(()=>import("./ClientAnalytics-CUxRlzq7.js"),__vite__mapDeps([97,1,2,3,24,10,6,4,5,7,13,15,16,11,12,17,18,19,20,21,22,9,23,25,8,26,27,28,14,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44])).then(s=>({default:s.ClientAnalytics})));const Ni=c.lazy(()=>k(()=>import("./ClientPortalDocuments-DmsP4pu0.js"),__vite__mapDeps([98,1,2,3,10,6])).then(s=>({default:s.ClientPortalDocuments}))),wi=c.lazy(()=>k(()=>import("./ClientPortalMessages-s3uwdTTM.js"),__vite__mapDeps([99,1,2,3,10,6])).then(s=>({default:s.ClientPortalMessages}))),Ci=c.lazy(()=>k(()=>import("./ClientPortalSecurity-CxIGDYaA.js"),__vite__mapDeps([100,1,2,3,10,6])).then(s=>({default:s.ClientPortalSecurity}))),ki=c.lazy(()=>k(()=>import("./ClientPortalActivity-DM7Q0_UC.js"),__vite__mapDeps([101,1,2,3,10,6])).then(s=>({default:s.ClientPortalActivity}))),Si=({client:s,onClose:a})=>{const[r,l]=c.useState("documents"),o=()=>e.jsxs(c.Suspense,{fallback:e.jsx(ke,{message:`Loading ${r} data...`}),children:[r==="documents"&&e.jsx(Ni,{}),r==="messages"&&e.jsx(wi,{}),r==="security"&&e.jsx(Ci,{}),r==="activity"&&e.jsx(ki,{})]});return e.jsxs("div",{className:"fixed inset-0 z-50 flex flex-col bg-slate-900",children:[e.jsxs("div",{className:"bg-slate-950 p-4 flex justify-between items-center border-b border-slate-800 shadow-md",children:[e.jsxs("div",{className:"flex items-center text-white space-x-3",children:[e.jsx("div",{className:"p-2 bg-emerald-500/10 rounded-lg border border-emerald-500/20",children:e.jsx(Oe,{className:"h-5 w-5 text-emerald-400"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"font-bold text-lg tracking-tight",children:"Secure Client Portal"}),e.jsxs("p",{className:"text-xs text-slate-400",children:["Viewing as: ",s.name]})]})]}),e.jsx("button",{onClick:a,className:"text-slate-400 hover:text-white transition-colors p-2 hover:bg-slate-800 rounded-full",children:e.jsx(Se,{className:"h-6 w-6"})})]}),e.jsx("div",{className:"flex-1 bg-slate-50 p-6 md:p-10 overflow-y-auto",children:e.jsxs("div",{className:"max-w-5xl mx-auto space-y-8",children:[e.jsxs("div",{className:"bg-white rounded-xl p-6 border border-slate-200 shadow-sm flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsxs("h3",{className:"text-xl font-bold text-slate-900",children:["Welcome, ",s.name]}),e.jsx("p",{className:"text-slate-500 text-sm mt-1",children:"You have 2 new documents and 1 unread message."})]}),e.jsx(_,{variant:"primary",icon:Ya,children:"Secure Upload"})]}),e.jsx(Jt,{tabs:[{id:"documents",label:"Documents",icon:Q},{id:"messages",label:"Messages",icon:qs},{id:"security",label:"MFA & Security",icon:Pe},{id:"activity",label:"Activity Log",icon:Hs}],activeTab:r,onChange:l,variant:"underline"}),e.jsx("div",{className:"grid grid-cols-1 gap-8",children:o()})]})})]})},_i=()=>{const{theme:s}=D();return e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-3 rounded-xl bg-blue-100 dark:bg-blue-900/20",children:e.jsx(Ds,{className:"h-8 w-8 text-blue-600 dark:text-blue-400"})}),e.jsxs("div",{children:[e.jsx("h1",{className:t("text-3xl font-bold",s.text.primary),children:"DAF Operations"}),e.jsx("p",{className:t("text-sm mt-1",s.text.secondary),children:"Data Access Framework - Security & Compliance Management"})]})]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsx("div",{className:t("p-6 rounded-xl border",s.surface.raised,s.border.default),children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Ts,{className:"h-5 w-5 text-blue-600"}),e.jsxs("div",{children:[e.jsx("p",{className:t("text-sm",s.text.secondary),children:"Data Sources"}),e.jsx("p",{className:t("text-2xl font-bold",s.text.primary),children:"12"})]})]})}),e.jsx("div",{className:t("p-6 rounded-xl border",s.surface.raised,s.border.default),children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Oe,{className:"h-5 w-5 text-emerald-600"}),e.jsxs("div",{children:[e.jsx("p",{className:t("text-sm",s.text.secondary),children:"Access Policies"}),e.jsx("p",{className:t("text-2xl font-bold",s.text.primary),children:"47"})]})]})}),e.jsx("div",{className:t("p-6 rounded-xl border",s.surface.raised,s.border.default),children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Qa,{className:"h-5 w-5 text-purple-600"}),e.jsxs("div",{children:[e.jsx("p",{className:t("text-sm",s.text.secondary),children:"Active Keys"}),e.jsx("p",{className:t("text-2xl font-bold",s.text.primary),children:"23"})]})]})})]}),e.jsxs("div",{className:t("p-12 rounded-xl border-2 border-dashed text-center",s.border.default),children:[e.jsx(Ds,{className:t("h-16 w-16 mx-auto mb-4",s.text.tertiary)}),e.jsx("h3",{className:t("text-xl font-semibold mb-2",s.text.primary),children:"DAF Operations Dashboard"}),e.jsx("p",{className:t("text-sm max-w-md mx-auto",s.text.secondary),children:"Manage data access policies, security protocols, and compliance frameworks. This module is currently in development."})]})]})},Di=c.memo(_i);Di.displayName="DafDashboard";const xa=z.memo(({id:s,title:a,status:r,client:l,clientId:o,jurisdiction:i,onBack:n,onShowTimeline:d})=>{const{theme:m}=D(),{openWindow:f,closeWindow:u}=_e(),{data:x}=F(["tasks",s,"count"],()=>I.tasks.countByCaseId(s),{staleTime:5e3}),{data:p}=F(["messages",s,"count"],()=>I.messenger.countUnread(s),{staleTime:5e3}),h=()=>{const j=`portal-${o}`;f(j,`Client Portal: ${l}`,e.jsx(Si,{client:{id:o||"unknown",name:l,industry:"General",status:Sr.ACTIVE,totalBilled:0,totalPaid:0,totalCases:1,activeCases:1,matters:[s],clientNumber:"TEMP",paymentTerms:kr.NET_30,creditLimit:0,currentBalance:0,isVip:!1,requiresConflictCheck:!1,hasRetainer:!1,email:"",phone:"",address:"",billingAddress:"",notes:""},onClose:()=>u(j)}))};return e.jsx("div",{className:t("border-b sticky top-0 z-20 shadow-sm shrink-0 backdrop-blur-sm bg-opacity-90",m.surface.default,m.border.default),children:e.jsx("div",{className:"px-4 md:px-6 py-4",children:e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("button",{onClick:n,title:"Back to cases","aria-label":"Back to case list",className:t("mt-1 p-1.5 rounded-md transition-colors border shadow-sm shrink-0",m.surface.default,m.border.default,m.text.secondary,`hover:${m.surface.highlight}`),children:e.jsx(It,{className:"h-5 w-5"})}),e.jsx("div",{className:"flex-1 min-w-0",children:e.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center justify-between gap-4",children:[e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-1 flex-wrap",children:[e.jsx("h1",{className:t("text-xl md:text-2xl font-bold truncate tracking-tight max-w-full",m.text.primary),title:a,children:a}),e.jsx(K,{variant:r==="Trial"?"warning":"info",className:"shrink-0",children:r})]}),e.jsxs("div",{className:t("flex flex-wrap items-center gap-3 text-xs md:text-sm",m.text.secondary),children:[e.jsx("span",{className:t("font-mono px-1.5 py-0.5 rounded border shrink-0",m.surface.highlight,m.border.default),children:s}),e.jsx("span",{className:"hidden sm:inline opacity-30",children:"|"}),e.jsxs("span",{className:t("flex items-center font-medium truncate max-w-[200px]",m.text.primary),children:[e.jsx(de,{className:t("h-3.5 w-3.5 mr-1.5 shrink-0",m.text.tertiary)})," ",l]}),i&&e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"hidden sm:inline opacity-30",children:"|"}),e.jsxs("span",{className:"hidden sm:flex items-center truncate max-w-[200px]",children:[e.jsx(Gs,{className:t("h-3.5 w-3.5 mr-1.5 shrink-0",m.text.tertiary)})," ",i]})]})]})]}),e.jsxs("div",{className:"flex items-center gap-3 shrink-0",children:[e.jsxs("div",{className:"hidden md:flex gap-3",children:[typeof x=="number"&&x>0&&e.jsxs("span",{className:t("flex items-center text-xs font-bold px-2 py-1 rounded border animate-in fade-in",m.status.warning.text,m.status.warning.bg,m.status.warning.border),children:[e.jsx(Ae,{className:"h-3 w-3 mr-1"})," ",x," Open Tasks"]}),typeof p=="number"&&p>0&&e.jsxs("span",{className:t("flex items-center text-xs font-bold px-2 py-1 rounded border animate-pulse",m.status.error.text,m.status.error.bg,m.status.error.border),children:[e.jsx(Pt,{className:"h-3 w-3 mr-1"})," ",p," Unread"]})]}),e.jsx(_,{variant:"outline",size:"sm",className:"hidden sm:flex",icon:At,onClick:h,children:"Client Portal"}),e.jsx("button",{className:t("lg:hidden p-2 rounded-full",m.text.secondary,`hover:${m.surface.highlight}`),onClick:d,title:"View timeline","aria-label":"Open case timeline",children:e.jsx(pe,{className:"h-6 w-6"})})]})]})})]})})})});xa.displayName="CaseDetailHeader";const Ti=({isOpen:s,onClose:a,onNavigate:r})=>{const{theme:l}=D();return s?e.jsx("div",{className:"fixed inset-0 z-50 bg-slate-900/50 backdrop-blur-sm md:hidden flex items-end justify-center pb-6",onClick:a,children:e.jsxs("div",{className:t("rounded-xl shadow-2xl w-[90%] max-w-sm p-4 animate-in slide-in-from-bottom duration-200 space-y-2",l.surface.default),onClick:o=>o.stopPropagation(),children:[e.jsx("h4",{className:t("text-sm font-bold uppercase tracking-wide mb-3 px-2",l.text.secondary),children:"Quick Actions"}),e.jsxs("button",{onClick:()=>r("Documents"),className:t("w-full flex items-center p-3 rounded-lg border font-medium",l.surface.default,l.border.default,l.text.primary,`hover:${l.surface.highlight}`),children:[e.jsx(Q,{className:t("h-5 w-5 mr-3",l.primary.text)})," Upload Document"]}),e.jsxs("button",{onClick:()=>r("Billing"),className:t("w-full flex items-center p-3 rounded-lg border font-medium",l.surface.default,l.border.default,l.text.primary,`hover:${l.surface.highlight}`),children:[e.jsx(ce,{className:t("h-5 w-5 mr-3",l.status.success.text)})," Log Billable Time"]}),e.jsxs("button",{onClick:()=>r("Workflow"),className:t("w-full flex items-center p-3 rounded-lg border font-medium",l.surface.default,l.border.default,l.text.primary,`hover:${l.surface.highlight}`),children:[e.jsx(J,{className:t("h-5 w-5 mr-3",l.action.primary.text)})," Add Task"]}),e.jsx("button",{onClick:a,className:t("w-full p-3 rounded-lg font-bold mt-2",l.surface.highlight,l.text.secondary),children:"Cancel"})]})}):null},us=[{id:"overview",label:"Overview",icon:tt,subTabs:[{id:"Overview",label:"Dashboard",icon:tt},{id:"Parties",label:"Parties",icon:de},{id:"Timeline",label:"Timeline",icon:ce}]},{id:"strategy",label:"Strategy",icon:Xa,subTabs:[{id:"Research",label:"Research",icon:Et},{id:"Arguments",label:"Argument Builder",icon:ze},{id:"Risk",label:"Risk Assessment",icon:Me},{id:"Strategy",label:"Authority & Defenses",icon:gs},{id:"Planning",label:"Case Plan",icon:pe}]},{id:"execution",label:"Execution",icon:fe,subTabs:[{id:"Projects",label:"Projects",icon:fe},{id:"Workflow",label:"Tasks",icon:Ae},{id:"Collaboration",label:"Collaboration",icon:qs}]},{id:"litigation",label:"Litigation",icon:ve,subTabs:[{id:"Motions",label:"Motions",icon:ve},{id:"Discovery",label:"Discovery",icon:at},{id:"Evidence",label:"Evidence Vault",icon:js},{id:"Exhibits",label:"Exhibits",icon:er}]},{id:"docs",label:"Documents",icon:Q,subTabs:[{id:"Documents",label:"Files",icon:sr},{id:"Drafting",label:"Drafting",icon:ss},{id:"Contract Review",label:"Review",icon:at}]},{id:"finance",label:"Finance",icon:Ce,subTabs:[{id:"Billing",label:"Billing",icon:Ce}]}],Ei=({activeTab:s,setActiveTab:a,onParentTabChange:r})=>{const{theme:l}=D(),o=c.useMemo(()=>us.find(i=>i.subTabs.some(n=>n.id===s))||us[0],[s]);return e.jsxs("div",{className:"px-6 pt-2 shrink-0",children:[e.jsx("div",{className:t("hidden md:flex space-x-6 border-b mb-4",l.border.default),children:us.map(i=>e.jsxs("button",{onClick:()=>r(i.id),className:t("flex items-center pb-3 px-1 text-sm font-medium transition-all border-b-2",o.id===i.id?t("border-current",l.primary.text):t("border-transparent",l.text.secondary,`hover:${l.text.primary}`)),children:[e.jsx(i.icon,{className:t("h-4 w-4 mr-2",o.id===i.id?l.primary.text:l.text.tertiary)}),i.label]},i.id))}),e.jsx("div",{className:t("flex space-x-2 overflow-x-auto no-scrollbar py-3 px-4 md:px-6 rounded-lg border mb-4",l.surface.highlight,l.border.default),children:o.subTabs.map(i=>e.jsxs("button",{onClick:()=>a(i.id),className:t("flex-shrink-0 px-3 py-1.5 rounded-full font-medium text-xs md:text-sm transition-all duration-200 whitespace-nowrap flex items-center gap-2 border",s===i.id?t(l.surface.default,l.primary.text,"shadow-sm border-transparent ring-1",l.primary.border):t("bg-transparent",l.text.secondary,"border-transparent",`hover:${l.surface.default}`)),children:[e.jsx(i.icon,{className:t("h-3.5 w-3.5",s===i.id?l.primary.text:l.text.tertiary)}),i.label]},i.id))})]})},Ai=z.memo(({date:s,title:a,description:r,icon:l,colorClass:o="bg-slate-400",onClick:i,isLast:n})=>{const{theme:d}=D();return e.jsxs("div",{className:"relative pl-10 h-full flex flex-col justify-center group py-2",style:{contentVisibility:"auto"},children:[!n&&e.jsx("div",{className:t("absolute left-[11px] top-6 bottom-[-24px] w-0.5 transition-colors",d.border.default,"group-hover:bg-slate-300")}),e.jsx("div",{className:t("absolute left-0 top-1/2 -translate-y-1/2 h-6 w-6 rounded-full border-2 border-white shadow-sm flex items-center justify-center text-white z-10 transition-transform duration-200 group-hover:scale-110",o),children:l}),e.jsxs("div",{className:t("flex flex-col justify-center h-full min-w-0 pr-2 transition-opacity",i?"cursor-pointer":""),onClick:i,title:r,children:[e.jsxs("div",{className:"flex justify-between items-baseline gap-2 w-full",children:[e.jsx("span",{className:t("text-sm font-semibold truncate",d.text.primary,i?"group-hover:text-blue-600 transition-colors":""),children:a}),e.jsx($r,{date:s,className:t("font-mono text-[10px] whitespace-nowrap shrink-0 opacity-60",d.text.tertiary)})]}),r&&e.jsx("p",{className:t("text-xs truncate opacity-60 mt-0.5 font-medium",d.text.secondary),children:r})]})]})}),Ii=({events:s})=>{const{theme:a}=D(),r=s.filter(i=>i.type==="milestone"||i.type==="hearing"||i.type==="motion"||i.type==="document"&&i.description?.includes("Key")),l=i=>{switch(i){case"milestone":return e.jsx(Rt,{className:"h-5 w-5 text-white"});case"hearing":return e.jsx(ve,{className:"h-5 w-5 text-white"});case"motion":return e.jsx(Q,{className:"h-5 w-5 text-white"});default:return e.jsx(pe,{className:"h-5 w-5 text-white"})}},o=i=>{switch(i){case"milestone":return a.action.primary.bg;case"hearing":return"bg-red-600";case"motion":return a.action.primary.bg;default:return"bg-slate-500"}};return e.jsxs("div",{className:"space-y-8 py-8",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("h3",{className:t("text-2xl font-bold",a.text.primary),children:"Case Narrative"}),e.jsx("p",{className:t("text-sm",a.text.secondary),children:"Key events and strategic milestones"})]}),e.jsxs("div",{className:"relative max-w-4xl mx-auto",children:[e.jsx("div",{className:t("absolute left-1/2 top-0 bottom-0 w-1 -ml-0.5",a.border.default,"bg-slate-200 dark:bg-slate-700")}),r.map((i,n)=>{const d=n%2===0;return e.jsxs("div",{className:t("relative flex items-center justify-between mb-12 w-full",d?"flex-row-reverse":""),children:[e.jsx("div",{className:"w-5/12"}),e.jsx("div",{className:t("absolute left-1/2 -ml-4 w-8 h-8 rounded-full border-4 border-white shadow-sm flex items-center justify-center z-10",o(i.type)),children:l(i.type)}),e.jsx("div",{className:"w-5/12",children:e.jsxs("div",{className:t("p-5 rounded-xl border shadow-sm relative transition-transform hover:-translate-y-1",a.surface.default,a.border.default),children:[e.jsx("div",{className:t("absolute top-6 w-3 h-3 rotate-45 border-l border-b",d?"-right-[7px] border-r border-t-0 border-l-0 border-b-0":"-left-[7px]",a.border.default,a.surface.default)}),e.jsx("span",{className:t("text-xs font-bold uppercase tracking-wider mb-1 block",o(i.type).replace("bg-","text-")),children:i.date}),e.jsx("h4",{className:t("font-bold text-lg mb-2",a.text.primary),children:i.title}),e.jsx("p",{className:t("text-sm leading-relaxed",a.text.secondary),children:i.description})]})})]},i.id)}),e.jsx("div",{className:"flex justify-center pt-4",children:e.jsxs("div",{className:"bg-slate-900 text-white px-6 py-2 rounded-full text-sm font-bold flex items-center shadow-lg",children:["Trial Ready ",e.jsx(Ks,{className:"h-4 w-4 ml-2"})]})})]})]})},ha=({events:s,onEventClick:a})=>{const{theme:r}=D(),[l,o]=c.useState("list"),[i,n]=c.useState("All"),d=x=>{switch(x){case"document":return e.jsx(Q,{className:"h-3 w-3"});case"task":return e.jsx(ie,{className:"h-3 w-3"});case"billing":return e.jsx(Ce,{className:"h-3 w-3"});case"milestone":return e.jsx(Rt,{className:"h-3 w-3"});case"motion":return e.jsx(ve,{className:"h-3 w-3"});case"hearing":return e.jsx(pe,{className:"h-3 w-3"});default:return e.jsx(fe,{className:"h-3 w-3"})}},m=x=>{switch(x){case"document":return t(r.status.info.bg,r.status.info.border,r.status.info.text);case"task":return t(r.status.success.bg,r.status.success.border,r.status.success.text);case"billing":return t(r.status.warning.bg,r.status.warning.border,r.status.warning.text);case"milestone":return t(r.surface.highlight,r.border.default,r.action.primary.text);case"motion":return"bg-indigo-100 border-indigo-500 text-indigo-600 dark:bg-indigo-900/30 dark:text-indigo-400";case"hearing":return t(r.status.error.bg,r.status.error.border,r.status.error.text);default:return t(r.surface.highlight,r.border.default,r.text.tertiary)}},f=c.useMemo(()=>s.filter(x=>i==="All"||x.type===i),[s,i]),u=(x,p)=>e.jsx("div",{className:"h-[60px] px-4",children:e.jsx(Ai,{date:x.date,title:x.title,description:x.description,icon:d(x.type),colorClass:m(x.type),onClick:a?()=>a(x):void 0,isLast:p===f.length-1})},x.id);return e.jsxs("div",{className:t("flex flex-col h-full overflow-hidden w-full",r.surface.default),children:[e.jsxs("div",{className:t("p-4 border-b flex justify-between items-center shrink-0",r.border.default,r.surface.highlight),children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("h3",{className:t("font-bold text-sm uppercase tracking-wide",r.text.primary),children:"Case Timeline"}),e.jsx("span",{className:t("text-xs px-1.5 rounded-full",r.surface.default,r.border.default,r.text.secondary,"border"),children:f.length})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("div",{className:"relative",children:[e.jsx(ps,{className:t("absolute left-2 top-1/2 -translate-y-1/2 h-3 w-3",r.text.tertiary)}),e.jsxs("select",{className:t("pl-6 pr-2 py-1 text-xs border rounded bg-transparent outline-none appearance-none cursor-pointer",r.border.default,r.text.primary),value:i,onChange:x=>n(x.target.value),"aria-label":"Filter events by type",children:[e.jsx("option",{value:"All",children:"All Types"}),e.jsx("option",{value:"milestone",children:"Milestones"}),e.jsx("option",{value:"document",children:"Documents"}),e.jsx("option",{value:"motion",children:"Motions"}),e.jsx("option",{value:"hearing",children:"Hearings"}),e.jsx("option",{value:"billing",children:"Billing"})]})]}),e.jsxs("div",{className:t("flex p-0.5 rounded-lg border",r.surface.highlight,r.border.default),children:[e.jsx("button",{onClick:()=>o("list"),className:t("p-1.5 rounded transition-all",l==="list"?t(r.surface.default,"shadow",r.primary.text):r.text.tertiary),title:"List View","aria-label":"List View",children:e.jsx(Dt,{className:"h-4 w-4"})}),e.jsx("button",{onClick:()=>o("story"),className:t("p-1.5 rounded transition-all",l==="story"?t(r.surface.default,"shadow",r.primary.text):r.text.tertiary),title:"Story Mode","aria-label":"Story Mode",children:e.jsx(as,{className:"h-4 w-4"})})]})]})]}),e.jsx("div",{className:"flex-1 overflow-hidden p-0 relative",children:f.length===0?e.jsx("p",{className:t("text-sm text-center italic py-4",r.text.tertiary),children:"No events found."}):l==="story"?e.jsx("div",{className:"overflow-y-auto h-full custom-scrollbar p-4",children:e.jsx(Ii,{events:f})}):e.jsx(rs,{items:f,height:"100%",itemHeight:60,renderItem:u})})]})},Pi=({isOpen:s,onClose:a,events:r,onEventClick:l})=>{const{theme:o}=D();return s?e.jsx("div",{className:"fixed inset-0 z-50 bg-slate-900/50 backdrop-blur-sm lg:hidden",onClick:a,children:e.jsxs("div",{className:t("absolute right-0 top-0 bottom-0 w-80 shadow-2xl p-4 animate-in slide-in-from-right h-full flex flex-col",o.surface.default),onClick:i=>i.stopPropagation(),children:[e.jsxs("div",{className:"flex justify-between items-center mb-4 shrink-0",children:[e.jsx("h3",{className:t("font-bold",o.text.primary),children:"Case Timeline"}),e.jsx("button",{onClick:a,title:"Close timeline",className:t("p-2 rounded-full transition-colors",o.text.secondary,`hover:${o.surface.highlight}`),children:e.jsx(Se,{className:"h-5 w-5"})})]}),e.jsx("div",{className:"flex-1 overflow-y-auto",children:e.jsx(ha,{events:r,onEventClick:l})})]})}):null},Ri=({argumentsList:s,selectedId:a,onSelect:r})=>{const{theme:l}=D();return s.length===0?e.jsx("div",{className:t("flex flex-col items-center justify-center h-full p-8 text-center",l.text.tertiary),children:e.jsx("p",{children:"No arguments found matching your criteria."})}):e.jsx("div",{className:t("flex-1 overflow-y-auto p-4 space-y-3",l.surface.highlight),children:s.map(o=>e.jsxs("div",{onClick:()=>r(o.id),className:t("group relative p-5 rounded-xl border transition-all cursor-pointer hover:shadow-md",l.surface.default,a===o.id?t(l.action.primary.border,"ring-1 shadow-md z-10"):t(l.border.default,`hover:${l.primary.border}`)),children:[e.jsxs("div",{className:"flex justify-between items-start mb-3",children:[e.jsxs("div",{className:"flex-1 pr-4",children:[e.jsx("h4",{className:t("font-bold text-base mb-1",l.text.primary),children:o.title}),e.jsx("p",{className:t("text-xs line-clamp-2 leading-relaxed",l.text.secondary),children:o.description})]}),e.jsx(K,{variant:o.status==="Active"?"success":o.status==="Draft"?"warning":"neutral",children:o.status})]}),e.jsxs("div",{className:t("flex items-center justify-between pt-4 border-t",l.border.default),children:[e.jsxs("div",{className:"flex gap-3",children:[e.jsxs("div",{className:t("flex items-center text-xs px-2 py-1 rounded border",l.surface.highlight,l.action.primary.text,l.border.default,!o.relatedCitationIds.length&&"opacity-50 grayscale"),children:[e.jsx(Ee,{className:"h-3 w-3 mr-1.5"}),e.jsx("span",{className:"font-bold",children:o.relatedCitationIds.length})]}),e.jsxs("div",{className:t("flex items-center text-xs px-2 py-1 rounded bg-amber-50 text-amber-700 border border-amber-100",(!o.relatedEvidenceIds||!o.relatedEvidenceIds.length)&&"opacity-50 grayscale"),children:[e.jsx(js,{className:"h-3 w-3 mr-1.5"}),e.jsx("span",{className:"font-bold",children:o.relatedEvidenceIds?.length||0})]})]}),e.jsx("div",{className:"w-32",children:e.jsx(ta,{value:o.strength,label:"Win Probability"})})]}),e.jsx("div",{className:t("absolute right-4 top-1/2 -translate-y-1/2 text-slate-300 opacity-0 group-hover:opacity-100 transition-opacity",a===o.id&&t("opacity-100",l.action.primary.text)),children:e.jsx(Fs,{className:"h-6 w-6"})})]},o.id))})},Li=({argument:s,onUpdate:a,onAnalyze:r})=>{const{theme:l}=D();return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:t("block text-xs font-bold uppercase mb-2",l.text.secondary),children:"Argument Narrative"}),e.jsx(Ge,{value:s.description,onChange:o=>a({...s,description:o.target.value}),rows:8,className:"font-serif text-base leading-relaxed",placeholder:"Detail the legal reasoning..."})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:t("block text-xs font-bold uppercase mb-2",l.text.secondary),children:"Strength Assessment"}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("input",{type:"range",min:"0",max:"100",value:s.strength,onChange:o=>a({...s,strength:parseInt(o.target.value)}),title:"Adjust argument strength",className:"flex-1 h-2 bg-slate-200 rounded-lg appearance-none cursor-pointer accent-blue-600"}),e.jsxs("span",{className:t("text-lg font-bold w-12 text-right",l.text.primary),children:[s.strength,"%"]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:t("block text-xs font-bold uppercase mb-2",l.text.secondary),children:"Status"}),e.jsx("div",{className:"flex gap-2",children:["Draft","Active","Dismissed"].map(o=>e.jsx("button",{onClick:()=>a({...s,status:o}),className:t("px-3 py-1.5 text-xs rounded border transition-all",s.status===o?"bg-slate-800 text-white border-slate-800":"bg-white text-slate-600 border-slate-200 hover:border-slate-400"),children:o},o))})]})]}),e.jsxs("div",{className:t("p-4 rounded-lg border bg-indigo-50 border-indigo-100 flex items-center justify-between"),children:[e.jsxs("div",{className:"flex items-center gap-3 text-indigo-800",children:[e.jsx("div",{className:"p-2 bg-white rounded-full shadow-sm",children:e.jsx(oe,{className:"h-5 w-5 text-indigo-600"})}),e.jsx("div",{className:"text-sm font-medium",children:"AI Stress Test Available"})]}),e.jsx(_,{size:"sm",onClick:r,className:"bg-indigo-600 hover:bg-indigo-700 text-white border-transparent",children:"Run Analysis"})]})]})},Mi=({argument:s,onUpdate:a,onDelete:r,onClose:l,allEvidence:o,allCitations:i})=>{const{theme:n}=D(),[d,m]=c.useState("core"),[f,u]=c.useState(!1),[x,p]=c.useState(null),[h,j]=c.useState(!1),[N,y]=c.useState(!1),v=async()=>{u(!0),m("analysis");const C=`Analyze this legal argument for weaknesses and suggest counter-arguments: "${s.title}: ${s.description}"`,b=await qe.generateDraft(C,"Analysis");p(b),u(!1)},S=(C,b)=>{if(b==="evidence"){const w="relatedEvidenceIds",g=s[w]||[],T=C,E=g.includes(T)?g.filter(L=>L!==T):[...g,T];a({...s,[w]:E})}else{const w="relatedCitationIds",g=s[w]||[],T=g.includes(C)?g.filter(E=>E!==C):[...g,C];a({...s,[w]:T})}};return e.jsxs("div",{className:"flex flex-col h-full",children:[e.jsxs("div",{className:t("p-5 border-b flex justify-between items-start",n.surface.highlight,n.border.default),children:[e.jsxs("div",{className:"flex-1 mr-4",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsxs("span",{className:t("text-xs font-mono border px-1.5 rounded",n.text.tertiary,n.border.default),children:["ID: ",s.id.slice(-6)]}),e.jsx(K,{variant:s.status==="Active"?"success":"warning",children:s.status})]}),e.jsx(Z,{value:s.title,onChange:C=>a({...s,title:C.target.value}),className:t("text-lg font-bold border-transparent bg-transparent px-2 -ml-2 transition-all",n.text.primary,`hover:${n.surface.default}`,`hover:${n.border.default}`,`focus:${n.surface.default}`,`focus:${n.border.default}`)})]}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsx("button",{onClick:l,title:"Close argument",className:t("p-2 rounded transition-colors",n.text.tertiary,`hover:${n.surface.default}`),children:e.jsx(Se,{className:"h-5 w-5"})})})]}),e.jsx("div",{className:t("px-4 border-b",n.border.default),children:e.jsx(Jt,{tabs:["core","authority","evidence","analysis"],activeTab:d,onChange:C=>m(C),variant:"underline"})}),e.jsxs("div",{className:"flex-1 overflow-y-auto p-6",children:[d==="core"&&e.jsx(Li,{argument:s,onUpdate:a,onAnalyze:v}),d==="authority"&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsxs("h4",{className:t("text-sm font-bold uppercase",n.text.secondary),children:["Linked Citations (",s.relatedCitationIds.length,")"]}),e.jsx(_,{size:"sm",variant:"outline",icon:J,onClick:()=>y(!N),children:N?"Done":"Link Authority"})]}),N&&e.jsx("div",{className:t("p-3 rounded-lg border mb-4 max-h-48 overflow-y-auto",n.surface.highlight,n.border.default),children:i.map(C=>e.jsxs("div",{onClick:()=>S(C.id,"citation"),className:t("flex items-center p-2 rounded cursor-pointer transition-colors",s.relatedCitationIds.includes(C.id)?n.surface.highlight:`hover:${n.surface.default}`),children:[e.jsx("div",{className:t("w-4 h-4 border rounded mr-3 flex items-center justify-center",n.surface.default,s.relatedCitationIds.includes(C.id)?n.action.primary.border:n.border.default),children:s.relatedCitationIds.includes(C.id)&&e.jsx("div",{className:t("w-2 h-2 rounded-full",n.action.primary.bg)})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:t("text-xs font-bold truncate",n.text.primary),children:C.citation}),e.jsx("p",{className:t("text-[10px] truncate",n.text.secondary),children:C.title})]})]},C.id))}),e.jsxs("div",{className:"space-y-3",children:[s.relatedCitationIds.map(C=>{const b=i.find(w=>w.id===C);return b?e.jsxs("div",{className:t("flex items-start p-3 rounded border shadow-sm group",n.surface.default,n.border.default),children:[e.jsx(Ee,{className:t("h-5 w-5 mt-0.5 mr-3 shrink-0",n.action.primary.text)}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("p",{className:t("text-sm font-bold hover:underline cursor-pointer",n.text.link),children:b.citation}),e.jsx("button",{onClick:()=>S(C,"citation"),title:"Remove citation",className:t("opacity-0 group-hover:opacity-100 hover:text-red-500",n.text.tertiary),children:e.jsx(Ze,{className:"h-4 w-4"})})]}),e.jsx("p",{className:t("text-xs font-medium",n.text.primary),children:b.title}),e.jsx("p",{className:t("text-xs mt-1 italic",n.text.secondary),children:b.description})]})]},C):null}),s.relatedCitationIds.length===0&&e.jsx("p",{className:t("text-sm italic text-center py-4",n.text.tertiary),children:"No authorities linked."})]})]}),d==="evidence"&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsxs("h4",{className:t("text-sm font-bold uppercase",n.text.secondary),children:["Supporting Evidence (",s.relatedEvidenceIds?.length||0,")"]}),e.jsx(_,{size:"sm",variant:"outline",icon:J,onClick:()=>j(!h),children:h?"Done":"Link Evidence"})]}),h&&e.jsx("div",{className:t("p-3 rounded-lg border mb-4 max-h-48 overflow-y-auto",n.surface.highlight,n.border.default),children:o.map(C=>e.jsxs("div",{onClick:()=>S(C.id,"evidence"),className:t("flex items-center p-2 rounded cursor-pointer transition-colors",s.relatedEvidenceIds?.includes(C.id)?n.surface.highlight:`hover:${n.surface.default}`),children:[e.jsx("div",{className:t("w-4 h-4 border rounded mr-3 flex items-center justify-center",n.surface.default,s.relatedEvidenceIds?.includes(C.id)?n.action.primary.border:n.border.default),children:s.relatedEvidenceIds?.includes(C.id)&&e.jsx("div",{className:t("w-2 h-2 rounded-full",n.action.primary.bg)})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:t("text-xs font-bold truncate",n.text.primary),children:C.title}),e.jsxs("p",{className:t("text-[10px] truncate",n.text.secondary),children:[C.type," • ",C.collectionDate]})]})]},C.id))}),e.jsxs("div",{className:"space-y-3",children:[s.relatedEvidenceIds?.map(C=>{const b=o.find(w=>w.id===C);return b?e.jsxs("div",{className:t("flex items-start p-3 rounded border shadow-sm group",n.surface.default,n.border.default),children:[e.jsx(js,{className:t("h-5 w-5 mt-0.5 mr-3 shrink-0",n.status.warning.text)}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("p",{className:t("text-sm font-bold",n.text.primary),children:b.title}),e.jsx("button",{onClick:()=>S(C,"evidence"),title:"Remove evidence",className:t("opacity-0 group-hover:opacity-100 hover:text-red-500",n.text.tertiary),children:e.jsx(Ze,{className:"h-4 w-4"})})]}),e.jsx("p",{className:t("text-xs mt-1",n.text.secondary),children:b.description}),e.jsxs("div",{className:"flex gap-2 mt-2",children:[e.jsx("span",{className:t("text-[10px] border px-1.5 py-0.5 rounded",n.surface.highlight,n.border.default),children:b.id}),e.jsx("span",{className:t("text-[10px] border px-1.5 py-0.5 rounded",n.surface.highlight,n.border.default),children:b.type})]})]})]},C):null}),(!s.relatedEvidenceIds||s.relatedEvidenceIds.length===0)&&e.jsx("p",{className:t("text-sm italic text-center py-4",n.text.tertiary),children:"No evidence linked."})]})]}),d==="analysis"&&e.jsx("div",{className:"space-y-6",children:f?e.jsxs("div",{className:"flex flex-col items-center justify-center py-12",children:[e.jsx(oe,{className:"h-8 w-8 text-indigo-500 animate-pulse mb-3"}),e.jsx("p",{className:"text-sm font-medium text-indigo-700",children:"Consulting Gemini AI..."})]}):x?e.jsxs("div",{className:"prose prose-sm max-w-none",children:[e.jsxs("div",{className:"p-4 bg-red-50 border border-red-100 rounded-lg mb-4",children:[e.jsxs("h4",{className:"text-sm font-bold text-red-800 mb-1 flex items-center",children:[e.jsx(be,{className:"h-4 w-4 mr-2"})," Counter-Argument Risk"]}),e.jsx("p",{className:"text-xs text-red-700",children:"AI has identified 2 potential weaknesses in your jurisdiction argument."})]}),e.jsx("div",{className:t("whitespace-pre-wrap leading-relaxed",n.text.secondary),children:x}),e.jsx(_,{variant:"outline",className:"w-full mt-6",onClick:v,children:"Regenerate Analysis"})]}):e.jsx("div",{className:"text-center py-12",children:e.jsx(_,{variant:"primary",icon:oe,onClick:v,children:"Start AI Stress Test"})})})]}),e.jsxs("div",{className:t("p-4 border-t flex justify-between items-center",n.surface.highlight,n.border.default),children:[e.jsxs("button",{onClick:()=>r(s.id),className:"text-red-600 text-xs font-bold hover:underline flex items-center",children:[e.jsx(Ze,{className:"h-3 w-3 mr-1"})," Delete"]}),e.jsx(_,{variant:"primary",icon:es,onClick:l,children:"Save Changes"})]})]})},Oi=({caseData:s,evidence:a})=>{const{theme:r}=D(),[l,o]=c.useState(null),[i,n]=c.useState(""),[d,m]=c.useState("All"),[f,u]=c.useState(s.arguments||[]),x=f.filter(y=>{const v=y.title.toLowerCase().includes(i.toLowerCase()),S=d==="All"||y.status===d;return v&&S}),p=f.find(y=>y.id===l)||null,h=()=>{const y={id:`arg-${Date.now()}`,title:"New Legal Argument",description:"Describe the legal basis...",strength:50,status:"Draft",relatedCitationIds:[],relatedEvidenceIds:[]};u([y,...f]),o(y.id)},j=y=>{u(f.map(v=>v.id===y.id?y:v))},N=y=>{u(f.filter(v=>v.id!==y)),l===y&&o(null)};return e.jsxs("div",{className:t("flex flex-col h-full rounded-lg shadow-sm border overflow-hidden",r.surface.default,r.border.default),children:[e.jsxs("div",{className:t("p-4 border-b flex justify-between items-center gap-4",r.surface.highlight,r.border.default),children:[e.jsxs("div",{className:"flex items-center gap-4 flex-1",children:[e.jsx("div",{className:t("p-2 rounded-lg border",r.surface.highlight,r.text.link,r.border.default),children:e.jsx(ze,{className:"h-5 w-5"})}),e.jsxs("div",{children:[e.jsx("h3",{className:t("font-bold text-lg whitespace-nowrap",r.text.primary),children:"Argument Builder"}),e.jsx("p",{className:t("text-xs hidden md:block",r.text.secondary),children:"Construct and strengthen core case theories."})]}),e.jsx("div",{className:t("h-8 w-px mx-2 hidden md:block",r.border.default)}),e.jsx(Xs,{value:i,onChange:n,placeholder:"Search arguments...",className:"w-full max-w-md border-none shadow-none p-0 bg-transparent hidden md:flex"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("div",{className:t("hidden md:flex items-center border rounded-lg px-3",r.surface.default,r.border.default),children:[e.jsx(ps,{className:t("h-4 w-4 mr-2",r.text.tertiary)}),e.jsxs("select",{className:t("text-sm bg-transparent outline-none py-1.5",r.text.primary),value:d,onChange:y=>m(y.target.value),"aria-label":"Filter arguments by status",children:[e.jsx("option",{value:"All",children:"All Status"}),e.jsx("option",{value:"Active",children:"Active"}),e.jsx("option",{value:"Draft",children:"Draft"}),e.jsx("option",{value:"Dismissed",children:"Dismissed"})]})]}),e.jsx(_,{variant:"primary",icon:J,onClick:h,children:"New Argument"})]})]}),e.jsxs("div",{className:"flex-1 flex overflow-hidden",children:[e.jsx("div",{className:t("flex-1 flex flex-col overflow-hidden",l?"hidden lg:flex lg:w-1/2 border-r":"w-full",r.border.default),children:e.jsx(Ri,{argumentsList:x,selectedId:l,onSelect:o})}),l&&p&&e.jsx("div",{className:t("flex-1 flex flex-col overflow-hidden animate-in slide-in-from-right duration-200",r.surface.default),children:e.jsx(Mi,{argument:p,onUpdate:j,onDelete:N,onClose:()=>o(null),allEvidence:a,allCitations:s.citations||[]})}),!l&&e.jsx("div",{className:t("hidden lg:flex flex-1 items-center justify-center",r.surface.highlight,r.text.tertiary),children:e.jsxs("div",{className:"text-center",children:[e.jsx(ze,{className:"h-16 w-16 mx-auto mb-4 opacity-20"}),e.jsx("h3",{className:"text-lg font-medium",children:"Select an argument to refine"}),e.jsx("p",{className:"text-sm max-w-xs mx-auto mt-2 opacity-70",children:"Link evidence, citations, and use AI to stress-test your legal theory."})]})})]})]})},zi=({billingModel:s,value:a,entries:r})=>{const{theme:l}=D(),o=r.filter(d=>d.status==="Unbilled").reduce((d,m)=>d+m.total,0),i=r.filter(d=>d.status==="Billed").reduce((d,m)=>d+m.total,0),n=r.reduce((d,m)=>d+m.duration/60,0);return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:t("p-5 rounded-lg shadow-md flex flex-col justify-between bg-slate-900 text-white border border-slate-800"),children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs opacity-70 uppercase font-bold tracking-wider",children:"Unbilled WIP"}),e.jsxs("p",{className:"text-2xl font-mono font-bold mt-1",children:["$",o.toLocaleString(void 0,{minimumFractionDigits:2})]})]}),e.jsx("div",{className:"w-full bg-slate-700 h-1 mt-4 rounded-full overflow-hidden",children:e.jsx("div",{className:t("h-full w-[65%]",l.action.primary.bg)})})]}),e.jsxs("div",{className:t("p-5 rounded-lg shadow-sm flex flex-col justify-between border",l.surface.default,l.border.default),children:[e.jsx("p",{className:t("text-xs uppercase font-bold tracking-wider",l.text.secondary),children:"Total Billed"}),e.jsxs("div",{className:"flex items-end justify-between",children:[e.jsxs("p",{className:t("text-2xl font-mono font-bold",l.text.primary),children:["$",i.toLocaleString(void 0,{minimumFractionDigits:2})]}),e.jsx(bs,{className:"h-5 w-5 text-green-600 mb-1"})]})]}),e.jsxs("div",{className:t("p-5 rounded-lg shadow-sm flex flex-col justify-between border",l.surface.default,l.border.default),children:[e.jsx("p",{className:t("text-xs uppercase font-bold tracking-wider",l.text.secondary),children:"Hours Logged"}),e.jsxs("div",{className:"flex items-end justify-between",children:[e.jsxs("p",{className:t("text-2xl font-bold",l.text.primary),children:[n.toFixed(1)," ",e.jsx("span",{className:t("text-sm font-normal",l.text.tertiary),children:"hrs"})]}),e.jsx(ce,{className:t("h-5 w-5 mb-1",l.text.link)})]})]}),e.jsxs("div",{className:t("p-5 rounded-lg shadow-sm flex flex-col justify-between border",l.surface.default,l.border.default),children:[e.jsx("p",{className:t("text-xs uppercase font-bold tracking-wider",l.text.secondary),children:"Matter Budget"}),e.jsxs("div",{className:"flex items-end justify-between",children:[e.jsxs("p",{className:t("text-2xl font-mono font-bold",l.text.primary),children:["$",a.toLocaleString()]}),e.jsx(K,{variant:"neutral",children:s})]})]})]}),e.jsx(ye,{title:"Time Ledger",action:e.jsx(_,{size:"sm",variant:"outline",icon:$e,children:"Export LEDES"}),noPadding:!0,children:e.jsxs(We,{responsive:"card",children:[e.jsxs(He,{children:[e.jsx(B,{children:"Date"}),e.jsx(B,{children:"Description"}),e.jsx(B,{children:"Rate"}),e.jsx(B,{children:"Hours"}),e.jsx(B,{children:"Total"}),e.jsx(B,{children:"Status"})]}),e.jsx(Ue,{children:r.length>0?r.map(d=>{const m=d;return e.jsxs(Ie,{children:[e.jsx(V,{className:t("font-mono",l.text.secondary),children:m.date}),e.jsx(V,{className:t("font-medium",l.text.primary),children:m.description}),e.jsxs(V,{className:t("text-right font-mono",l.text.secondary),children:["$",m.rate,"/hr"]}),e.jsx(V,{className:t("text-right font-bold",l.text.primary),children:(m.duration/60).toFixed(1)}),e.jsxs(V,{className:t("text-right font-mono",l.text.primary),children:["$",m.total.toFixed(2)]}),e.jsx(V,{className:"text-center",children:e.jsx(K,{variant:m.status==="Billed"?"success":"warning",children:m.status})})]},m.id)}):e.jsx(Ie,{children:e.jsx(V,{colSpan:6,className:t("px-6 py-12 text-center italic",l.text.tertiary),children:"No time entries recorded for this matter."})})}),r.length>0&&e.jsx("tfoot",{className:t("border-t",l.border.default,l.surface.highlight),children:e.jsxs("tr",{children:[e.jsx("td",{colSpan:4,"data-label":"",className:t("px-6 py-3 text-right text-xs font-bold uppercase",l.text.secondary),children:"Ledger Total"}),e.jsxs("td",{"data-label":"Total",className:t("px-6 py-3 text-right text-sm font-mono font-bold",l.text.primary),children:["$",(o+i).toFixed(2)]}),e.jsx("td",{"data-label":""})]})})]})})]})},$i=()=>{const{theme:s}=D(),[a,r]=c.useState(""),[l,o]=c.useState(null),[i,n]=c.useState(!1),d=async()=>{if(!a.trim())return;n(!0);const m=await qe.reviewContract(a);o(m),n(!1)};return e.jsxs("div",{className:"h-full flex flex-col md:flex-row gap-6",children:[e.jsxs("div",{className:t("flex-1 flex flex-col rounded-lg shadow-sm border overflow-hidden",s.surface.default,s.border.default),children:[e.jsxs("div",{className:t("p-4 border-b flex justify-between items-center",s.border.default,s.surface.highlight),children:[e.jsxs("h3",{className:t("font-bold flex items-center",s.text.primary),children:[e.jsx(Q,{className:t("mr-2 h-5 w-5",s.text.link)})," Contract Text"]}),e.jsxs("button",{className:t("text-xs flex items-center transition-colors",s.text.secondary,`hover:${s.text.link}`),children:[e.jsx(Es,{className:"h-3 w-3 mr-1"})," Import Doc"]})]}),e.jsx("textarea",{className:t("flex-1 p-4 resize-none outline-none font-mono text-sm leading-relaxed",s.text.primary,s.surface.default),placeholder:"Paste contract text here for analysis...",value:a,onChange:m=>r(m.target.value)}),e.jsx("div",{className:t("p-4 border-t",s.border.default,s.surface.highlight),children:e.jsxs("button",{onClick:d,disabled:i||!a,className:"w-full py-2 bg-indigo-600 text-white rounded font-medium hover:bg-indigo-700 disabled:opacity-50 flex justify-center items-center transition-colors",children:[i?e.jsx(Js,{className:"h-4 w-4 animate-spin mr-2"}):e.jsx(Me,{className:"h-4 w-4 mr-2"}),"Analyze Risks & Suggest Edits"]})})]}),e.jsxs("div",{className:t("flex-1 rounded-lg shadow-sm border flex flex-col overflow-hidden",s.surface.default,s.border.default),children:[e.jsx("div",{className:t("p-4 border-b",s.border.default,s.surface.highlight),children:e.jsxs("h3",{className:t("font-bold flex items-center",s.text.primary),children:[e.jsx(be,{className:t("mr-2 h-5 w-5",s.status.warning.text)})," AI Risk Analysis"]})}),e.jsx("div",{className:"flex-1 p-6 overflow-y-auto",children:l?e.jsxs("div",{className:"prose prose-sm prose-indigo max-w-none",children:[e.jsx("div",{className:t("border-l-4 p-4 mb-4",s.surface.highlight,s.status.warning.border),children:e.jsxs("div",{className:"flex",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx(be,{className:t("h-5 w-5",s.status.warning.text),"aria-hidden":"true"})}),e.jsx("div",{className:"ml-3",children:e.jsx("p",{className:t("text-sm",s.text.secondary),children:"Gemini has identified potential risks in this contract. Please review the redlines below."})})]})}),e.jsx("div",{className:t("whitespace-pre-wrap font-sans",s.text.secondary),children:l})]}):e.jsxs("div",{className:t("h-full flex flex-col items-center justify-center",s.text.tertiary),children:[e.jsx(Me,{className:"h-12 w-12 mb-3 opacity-20"}),e.jsx("p",{children:"Enter contract text to generate a risk profile."})]})})]})]})};c.lazy(()=>k(()=>import("./StrategyCanvas-BBt76zo3.js"),__vite__mapDeps([102,1,2,3,10,17,11,4,5,6,7,103,9,13,28,14,39,34,35,15,16,12,18,19,20,21,22,23,24,25,8,26,27,29,30,31,32,33,36,37,38,40,41,42,43,44])).then(s=>({default:s.StrategyCanvas})));c.lazy(()=>k(()=>import("./PlaybookLibrary-D1a1fex9.js"),__vite__mapDeps([104,1,2,3,6,4,5,7,8,10,11,13,33,24,25,17,18,19,20,15,16,21,22,12,27,28,14,29,9,23,26,30,31,32,34,35,36,37,38,39,40,41,42,43,44])).then(s=>({default:s.PlaybookLibrary})));c.lazy(()=>k(()=>import("./OutcomeSimulator-cfffWpMn.js"),__vite__mapDeps([105,1,2,3,13,10,6,34,24,42,15,16,11,4,5,7,12,17,18,19,20,21,22,9,23,25,8,26,27,28,14,29,30,31,32,33,35,36,37,38,39,40,41,43,44])).then(s=>({default:s.OutcomeSimulator})));c.lazy(()=>k(()=>import("./LitigationScheduleView-CBIjPhRw.js"),__vite__mapDeps([106,1,2,3,15,10,6,11,4,5,7,13,16,12,17,18,19,20,21,22,9,23,24,25,8,26,27,28,14,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44])).then(s=>({default:s.LitigationScheduleView})));const Vi=({phases:s,tasks:a,collapsedPhases:r,activeTaskId:l,onTogglePhase:o,onHoverTask:i,onAddTask:n})=>{const{theme:d}=D();return e.jsxs("div",{className:t("w-96 border-r flex flex-col overflow-hidden shadow-lg z-10",d.surface.default,d.border.default),children:[e.jsx("div",{className:t("h-8 border-b flex items-center px-4 font-bold text-xs uppercase",d.surface.highlight,d.border.default,d.text.secondary),children:"Work Breakdown Structure"}),e.jsx("div",{className:"flex-1 overflow-y-auto custom-scrollbar",children:s.map(m=>e.jsxs("div",{className:t("border-b last:border-0",d.border.default),children:[e.jsxs("div",{className:t("flex items-center justify-between p-3 cursor-pointer transition-colors sticky top-0 z-10 border-b border-transparent",d.surface.default,`hover:${d.surface.highlight}`,r.has(m.id)&&t("border-b",d.border.default)),onClick:()=>o(m.id),children:[e.jsxs("div",{className:t("flex items-center gap-2 font-bold text-sm",d.text.primary),children:[r.has(m.id)?e.jsx(Fs,{className:t("h-4 w-4",d.text.tertiary)}):e.jsx(ts,{className:t("h-4 w-4",d.text.tertiary)}),m.name]}),e.jsx(K,{variant:m.status==="Active"?"success":"neutral",children:m.status})]}),!r.has(m.id)&&e.jsxs("div",{className:t(d.surface.highlight),children:[a.filter(()=>!0).slice(0,3).map(f=>e.jsxs("div",{className:t("flex items-center gap-3 pl-8 pr-3 py-2 text-sm cursor-pointer border-l-2 border-transparent group transition-colors hover:border-blue-500",l===f.id?t(d.primary.light,d.action.primary.border):d.surface.default),onMouseEnter:()=>i(f.id),children:[e.jsx("div",{className:t("p-1 rounded cursor-grab active:cursor-grabbing",d.text.tertiary,`group-hover:${d.primary.text}`),children:e.jsx(tr,{className:"h-3 w-3"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:t("truncate font-medium",d.text.primary),children:f.title}),e.jsxs("p",{className:t("text-[10px]",d.text.secondary),children:[f.assignee," • ",f.dueDate]})]}),f.priority==="High"&&e.jsx(je,{className:"h-3 w-3 text-red-500"})]},f.id)),e.jsx("div",{className:"pl-8 p-2",children:e.jsxs("button",{onClick:n,className:t("text-xs flex items-center transition-colors",d.text.tertiary,`hover:${d.primary.text}`),children:[e.jsx(J,{className:"h-3 w-3 mr-1"})," Add Task"]})})]})]},m.id))})]})},Fi={findCriticalPath:s=>{if(s.length===0)return[];const a=new Map,r=new Map,l=new Map;s.forEach(x=>{const p=x.dueDate||new Date().toISOString(),h=x.startDate?new Date(x.startDate):new Date(p),N=(new Date(p).getTime()-h.getTime())/(1e3*60*60*24)||1;r.set(x.id,N),l.set(x.id,0),a.has(x.id)||a.set(x.id,[])}),s.forEach(x=>{x.dependencies&&x.dependencies.forEach(p=>{a.has(p)&&(a.get(p).push(x.id),l.set(x.id,(l.get(x.id)||0)+1))})});const o=[];l.forEach((x,p)=>{x===0&&o.push(p)});const i=new Map,n=new Map;for(;o.length>0;){const x=o.shift(),p=(i.get(x)||0)+(r.get(x)||0);(a.get(x)||[]).forEach(j=>{const N=i.get(j)||0;p>N&&(i.set(j,p),n.set(j,x)),l.set(j,(l.get(j)||1)-1),l.get(j)===0&&o.push(j)})}let d=null,m=-1;if(i.forEach((x,p)=>{const h=x+(r.get(p)||0);h>m&&(m=h,d=p)}),!d)return s.length>0?[s[0].id]:[];const f=[];let u=d;for(;u;)f.unshift(u),u=n.get(u)||null;return f}},Nt=c.lazy(()=>k(()=>import("./CommandCenter-DN6bEOxi.js"),__vite__mapDeps([107,1,2,3,4,5,6,7,10,24,25])).then(s=>({default:s.CommandCenter}))),Bi=c.lazy(()=>k(()=>import("./EvidenceWall-D8VJd9rR.js"),__vite__mapDeps([108,1,2,3,54,10,11,4,5,6,7,16,12,13,15,17,18,19,20,21,22,32,24,25,29,9,23,8,26,27,28,14,30,31,33,34,35,36,37,38,39,40,41,42,43,44])).then(s=>({default:s.EvidenceWall}))),Wi=c.lazy(()=>k(()=>import("./WitnessPrep-C2Pw4det.js"),__vite__mapDeps([109,1,2,3,6,4,5,7,10,11,41,13,32,24])).then(s=>({default:s.WitnessPrep}))),Hi=c.lazy(()=>k(()=>import("./TrialBinder-Bv01NOcT.js"),__vite__mapDeps([110,1,2,3,10,13,6])).then(s=>({default:s.TrialBinder}))),Ui=c.lazy(()=>k(()=>import("./AdvisoryBoard-B2YVw2cV.js"),__vite__mapDeps([111,1,2,3,6,4,5,7,8,54,112,39,10,13,31,14,11,21,32,15,16,12,17,18,19,20,22,9,23,24,25,26,27,28,29,30,33,34,35,36,37,38,40,41,42,43,44])).then(s=>({default:s.AdvisoryBoard}))),Gi=c.lazy(()=>k(()=>import("./OppositionManager-Bc2SW7dn.js"),__vite__mapDeps([113,1,2,3,6,4,5,7,8,54,39,10,13,31,27,14,11,22,21,32,15,16,12,17,18,19,20,9,23,24,25,26,28,29,30,33,34,35,36,37,38,40,41,42,43,44])).then(s=>({default:s.OppositionManager}))),qi=c.lazy(()=>k(()=>import("./WarRoomSidebar-woW1ITC-.js"),__vite__mapDeps([114,1,2,3,10,11,4,5,6,7])).then(s=>({default:s.WarRoomSidebar}))),os=[{id:"strategy",label:"Strategy",icon:ze,subTabs:[{id:"command",label:"Command Center",icon:ar},{id:"advisory",label:"Advisory Board",icon:fe},{id:"opposition",label:"Opposition Intel",icon:rr}]},{id:"presentation",label:"Presentation",icon:gs,subTabs:[{id:"evidence",label:"Evidence Wall",icon:Q},{id:"binder",label:"Trial Notebook",icon:ve}]},{id:"witnesses",label:"Witnesses",icon:de,subTabs:[{id:"witnesses",label:"Witness Prep",icon:As}]}];function fc({initialTab:s,caseId:a}){const{theme:r}=D(),[l,o]=c.useState("command"),[i,n]=c.useState("elevated"),[d,m]=c.useState(a||""),[f,u]=c.useState(null),{data:x}=F([xs.CASES,"all"],async()=>I.cases.getAll(),{enabled:!a}),p=c.useMemo(()=>x?Array.isArray(x)?x:[]:[],[x]),{data:h,isLoading:j,isError:N,error:y}=F([xs.CASES,d,"warRoom"],async()=>I.warRoom.getData(d),{enabled:!!d});c.useEffect(()=>{N&&console.error("[WarRoom] Failed to load war room data:",y)},[N,y]);const v=c.useMemo(()=>os.find(g=>g.subTabs.some(T=>T.id===l))||os[0],[l]),S=c.useCallback(g=>{const T=os.find(E=>E.id===g);T&&T.subTabs.length>0&&o(T.subTabs[0].id)},[]),C=(g,T)=>{o(g),g==="witnesses"&&T?.witnessId&&u(T.witnessId)};c.useEffect(()=>{a&&m(a)},[a]),c.useEffect(()=>{!a&&p.length>0&&(!d||!p.find(g=>g.id===d))&&m(p[0].id)},[p,d,a]);const b=c.useMemo(()=>p.find(g=>g.id===d),[p,d]);c.useEffect(()=>{s&&o(s)},[s]);const w=()=>{if(!h)return e.jsx("div",{className:t("flex items-center justify-center h-full",r.surface.default),children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:t("animate-pulse mb-4",r.text.tertiary),children:e.jsx(Loader2,{className:"h-8 w-8 mx-auto animate-spin"})}),e.jsx("p",{className:t("text-sm",r.text.secondary),children:"Loading trial data..."})]})});switch(l){case"command":return e.jsx(Nt,{caseId:d,warRoomData:h,onNavigate:C});case"evidence":return e.jsx(Bi,{caseId:d,warRoomData:h});case"witnesses":return e.jsx(Wi,{caseId:d,warRoomData:h,initialWitnessId:f,onClearSelection:()=>u(null)});case"binder":return e.jsx(Hi,{caseId:d,warRoomData:h});case"advisory":return e.jsx(Ui,{caseId:d});case"opposition":return e.jsx(Gi,{caseId:d});default:return e.jsx(Nt,{caseId:d,warRoomData:h,onNavigate:C})}};return j?e.jsx(ke,{message:"Initializing War Room..."}):N?e.jsx("div",{className:t("h-full flex flex-col items-center justify-center p-6",r.background),children:e.jsxs("div",{className:"text-center",children:[e.jsx(ze,{className:t("h-12 w-12 mx-auto mb-4 opacity-20 text-red-500")}),e.jsx("h3",{className:t("text-lg font-bold mb-2",r.text.primary),children:"Failed to Load War Room"}),e.jsx("p",{className:t("text-sm mb-4",r.text.secondary),children:y instanceof Error?y.message:"An error occurred while loading war room data."}),e.jsx(_,{variant:"primary",size:"sm",onClick:()=>window.location.reload(),children:"Retry"})]})}):h?e.jsxs("div",{className:t("h-full flex flex-col animate-fade-in",r.background),children:[e.jsxs("div",{className:"px-6 pt-6 shrink-0",children:[e.jsxs("div",{className:"flex flex-col md:flex-row md:justify-between md:items-start gap-4 mb-6",children:[e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("h2",{className:t("text-2xl font-bold tracking-tight leading-tight",r.text.primary),children:"Trial War Room"}),i==="critical"&&e.jsx("span",{className:"bg-red-600 text-white text-xs font-bold px-2 py-1 rounded animate-pulse",children:"DEFCON 1"}),i==="elevated"&&e.jsx("span",{className:"bg-amber-500 text-white text-xs font-bold px-2 py-1 rounded",children:"ACTIVE APPEAL"}),i==="normal"&&e.jsx("span",{className:"bg-blue-600 text-white text-xs font-bold px-2 py-1 rounded",children:"READY"})]}),!a&&b?e.jsxs("div",{className:"mt-2 flex items-center gap-3",children:[e.jsxs("div",{className:"relative group",children:[e.jsx("select",{value:d||"",onChange:g=>m(g.target.value),className:t("appearance-none bg-transparent font-semibold text-sm pr-6 py-1 outline-none cursor-pointer border-b border-dashed transition-colors hover:border-solid max-w-[300px] md:max-w-[500px] truncate",r.text.secondary,r.border.default,`hover:${r.text.primary}`,`hover:${r.border.default}`),children:p.map(g=>e.jsx("option",{value:g.id,children:g.title},g.id))}),e.jsx(ts,{className:t("absolute right-0 top-1/2 -translate-y-1/2 h-4 w-4 pointer-events-none",r.text.tertiary)})]}),e.jsx("span",{className:t("text-sm font-mono px-1.5 py-0.5 rounded border",r.surface.highlight,r.text.tertiary,r.border.default),children:b.caseNumber})]}):a&&b&&e.jsxs("div",{className:"mt-2",children:[e.jsx("p",{className:t("font-semibold text-lg",r.text.primary),children:b.title}),e.jsx("p",{className:t("text-sm font-mono",r.text.secondary),children:b.caseNumber})]})]}),e.jsxs("div",{className:"flex items-center gap-3 shrink-0 flex-wrap",children:[e.jsx(_,{variant:"outline",size:"sm",icon:Pe,className:i==="critical"?"bg-red-50 text-red-700 border-red-200":"",onClick:()=>n(i==="critical"?"normal":"critical"),children:"Escalate"}),e.jsx(_,{variant:"primary",size:"sm",icon:ie,children:"Readiness Check"})]})]}),e.jsx("div",{className:t("hidden md:flex space-x-6 border-b mb-4",r.border.default),children:os.map(g=>e.jsxs("button",{onClick:()=>S(g.id),className:t("flex items-center pb-3 px-1 text-sm font-medium transition-all border-b-2",v.id===g.id?t("border-current",r.primary.text):t("border-transparent",r.text.secondary,`hover:${r.text.primary}`)),children:[e.jsx(g.icon,{className:t("h-4 w-4 mr-2",v.id===g.id?r.primary.text:r.text.tertiary)}),g.label]},g.id))}),v.subTabs.length>1&&e.jsx("div",{className:t("flex space-x-2 overflow-x-auto no-scrollbar py-3 px-4 md:px-6 rounded-lg border mb-4",r.surface.highlight,r.border.default),children:v.subTabs.map(g=>e.jsxs("button",{onClick:()=>o(g.id),className:t("flex-shrink-0 px-3 py-1.5 rounded-full font-medium text-xs md:text-sm transition-all duration-200 whitespace-nowrap flex items-center gap-2 border",l===g.id?t(r.surface.default,r.primary.text,"shadow-sm border-transparent ring-1",r.primary.border):t("bg-transparent",r.text.secondary,"border-transparent",`hover:${r.surface.default}`)),children:[e.jsx(g.icon,{className:t("h-3.5 w-3.5",l===g.id?r.primary.text:r.text.tertiary)}),g.label]},g.id))})]}),e.jsxs("div",{className:t("flex-1 flex overflow-hidden border-t",r.border.default),children:[e.jsx(c.Suspense,{fallback:e.jsx("div",{className:t("w-64 border-r hidden md:block",r.surface.highlight,r.border.default)}),children:e.jsx(qi,{caseData:h.case})}),e.jsx("div",{className:t("flex-1 overflow-y-auto px-6 py-6 custom-scrollbar"),children:e.jsx(c.Suspense,{fallback:e.jsx(ke,{message:"Loading War Room Module..."}),children:w()})})]})]}):e.jsx("div",{className:t("h-full flex flex-col items-center justify-center p-6",r.background),children:e.jsxs("div",{className:"text-center",children:[e.jsx(ze,{className:t("h-12 w-12 mx-auto mb-4 opacity-20",r.text.tertiary)}),e.jsx("h3",{className:t("text-lg font-bold mb-2",r.text.primary),children:"Select a Matter"}),e.jsx("p",{className:t("text-sm mb-4",r.text.secondary),children:"Choose a case to enter the War Room."}),e.jsx("select",{value:d,onChange:g=>m(g.target.value),className:t("p-2 border rounded-md outline-none",r.surface.default,r.border.default,r.text.primary),children:p.map(g=>e.jsx("option",{value:g.id,children:g.title},g.id))})]})})}const Ki=c.memo(({node:s,isDragging:a,onMouseDown:r})=>e.jsx("div",{"data-drag-id":s.id,onMouseDown:l=>r(l,s.id),style:{position:"absolute",left:s.x,top:s.y,cursor:a?"grabbing":"grab"}}),(s,a)=>s.node.id===a.node.id&&s.node.x===a.node.x&&s.node.y===a.node.y&&s.node.label===a.node.label&&s.node.type===a.node.type&&s.isSelected===a.isSelected&&s.isDragging===a.isDragging&&JSON.stringify(s.node.config)===JSON.stringify(a.node.config));Ki.displayName="MemoizedNode";const Ji=c.memo(({connection:s,fromNode:a,toNode:r,onSelect:l})=>!a||!r?null:e.jsx("g",{onClick:()=>l(s.id)}),(s,a)=>s.connection.id===a.connection.id&&s.connection.from===a.connection.from&&s.connection.to===a.connection.to&&s.isSelected===a.isSelected&&s.fromNode?.x===a.fromNode?.x&&s.fromNode?.y===a.fromNode?.y&&s.toNode?.x===a.toNode?.x&&s.toNode?.y===a.toNode?.y);Ji.displayName="MemoizedConnection";const Zi=c.memo(()=>null,(s,a)=>s.isOpen===a.isOpen&&s.selectedNode?.id===a.selectedNode?.id&&s.selectedConnection?.id===a.selectedConnection?.id&&JSON.stringify(s.selectedNode?.config)===JSON.stringify(a.selectedNode?.config));Zi.displayName="MemoizedPropertiesPanel";const cs=(s,a)=>{let r="";switch(s){case"Physical":r="text-amber-600";break;case"Digital":r="text-blue-600";break;case"Document":r="text-slate-600";break;default:r="text-purple-600";break}return`${r} ${a}`};function Yi({type:s,className:a="h-5 w-5"}){switch(s){case"Physical":return e.jsx(Vs,{className:cs(s,a)});case"Digital":return e.jsx(Hs,{className:cs(s,a)});case"Document":return e.jsx(Q,{className:cs(s,a)});default:return e.jsx(js,{className:cs(s,a)})}}const pc=z.memo(({steps:s,currentStep:a,onStepClick:r,className:l=""})=>{const{theme:o}=D();return e.jsx("div",{className:t("w-full py-4",l),children:e.jsxs("div",{className:"flex items-center justify-between relative",children:[e.jsx("div",{className:t("absolute left-0 top-1/2 -translate-y-1/2 w-full h-0.5 -z-10",o.border.default)}),s.map((i,n)=>{const d=n+1,m=d<a,f=d===a;return e.jsxs("div",{className:t("flex flex-col items-center group",r?"cursor-pointer":"cursor-default"),onClick:()=>r&&d<a&&r(d),children:[e.jsx("div",{className:t("w-8 h-8 rounded-full flex items-center justify-center text-sm font-bold border-2 transition-colors z-10",m?t(o.primary.DEFAULT,"border-transparent text-white"):f?t(o.surface.default,o.primary.border,o.primary.text):t(o.surface.default,o.border.default,o.text.tertiary)),children:m?e.jsx(Bs,{className:"h-4 w-4"}):d}),e.jsx("span",{className:t("mt-2 text-xs font-medium px-2 py-0.5 rounded",o.surface.default,f?o.primary.text:o.text.secondary),children:i})]},i)})]})})}),gc=z.memo(({tags:s,onAdd:a,onRemove:r,suggestions:l=[],placeholder:o="Add tag..."})=>{const{theme:i}=D(),[n,d]=c.useState(""),m=c.useId(),f=u=>{u.key==="Enter"&&(u.preventDefault(),n.trim()&&(a(n.trim()),d("")))};return e.jsxs("div",{className:"space-y-3",children:[e.jsx("div",{className:"flex flex-wrap gap-2",children:s.map(u=>e.jsxs("span",{className:t("inline-flex items-center px-2.5 py-1 rounded-full text-xs font-medium border",i.primary.light,i.primary.text,i.primary.border),children:[u,e.jsx("button",{onClick:()=>r(u),className:t("ml-1.5 focus:outline-none hover:opacity-75",i.primary.text),children:e.jsx(Se,{className:"h-3 w-3"})})]},u))}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{id:m,className:t("w-full px-3 py-2 border rounded-md text-sm outline-none transition-colors",i.surface.default,i.border.default,i.text.primary,i.border.focused),placeholder:o,value:n,onChange:u=>d(u.target.value),onKeyDown:f}),e.jsx(J,{className:t("absolute right-3 top-1/2 -translate-y-1/2 h-4 w-4",i.text.tertiary)})]}),l.length>0&&e.jsx("div",{className:"flex flex-wrap gap-2 mt-2",children:l.filter(u=>!s.includes(u)).slice(0,5).map(u=>e.jsxs("button",{type:"button",onClick:()=>a(u),className:t("text-xs px-2 py-1 border rounded transition-colors",i.surface.default,i.border.default,i.text.secondary,`hover:${i.surface.highlight}`),children:["+ ",u]},u))})]})}),Qi=({items:s,filters:a,setFilters:r,onItemClick:l,onIntakeClick:o})=>{const{theme:i}=D(),n=Ys(),[d,m]=c.useState(null),{filteredItems:f,isSearching:u}=ul({items:s,query:a.search,fields:["title","description","custodian","trackingUuid","caseId"]}),x=z.useMemo(()=>f.filter(y=>{const v=!a.type||y.type===a.type,S=!a.admissibility||y.admissibility===a.admissibility,C=!a.caseId||y.caseId.toLowerCase().includes(a.caseId.toLowerCase());return v&&S&&C}),[f,a]),p=c.useCallback((y,v)=>{r(S=>({...S,[y]:v}))},[r]),h=c.useCallback(()=>{r({search:"",type:"",admissibility:"",caseId:"",custodian:"",dateFrom:"",dateTo:"",location:"",tags:"",collectedBy:"",hasBlockchain:!1})},[r]),j=c.useCallback(y=>{switch(y){case Cs.ADMISSIBLE:return"success";case Cs.CHALLENGED:return"warning";case Cs.INADMISSIBLE:return"error";default:return"neutral"}},[]),N=c.useCallback(y=>e.jsxs("div",{onClick:()=>l(y),className:t("flex items-center border-b h-[72px] px-6 hover:bg-slate-50 transition-colors cursor-pointer group",i.border.default),children:[e.jsx("div",{className:"w-[15%] font-mono text-xs text-slate-500",children:y.id}),e.jsx("div",{className:"w-[25%]",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:t("mr-3 p-1.5 rounded border self-start md:self-center",i.surface.highlight,i.border.default),children:e.jsx(Yi,{type:y.type})}),e.jsxs("div",{className:"min-w-0",children:[e.jsx("div",{className:t("font-medium",i.text.primary),children:y.title}),e.jsx("div",{className:t("text-xs text-slate-400 md:truncate"),children:y.description})]})]})}),e.jsx("div",{className:"w-[10%] text-sm",children:y.type}),e.jsx("div",{className:"w-[15%] text-sm",children:y.custodian}),e.jsx("div",{className:"w-[15%] text-xs",children:y.collectionDate}),e.jsx("div",{className:"w-[10%]",children:e.jsx(K,{variant:j(y.admissibility),children:y.admissibility})}),e.jsx("div",{className:"w-[10%] text-right",children:e.jsxs("div",{className:"flex justify-end gap-2",onClick:v=>v.stopPropagation(),children:[e.jsx(_,{size:"sm",variant:"ghost",className:i.text.tertiary,icon:Ae,onClick:()=>m(y),title:"Create Task"}),e.jsx(_,{size:"sm",variant:"ghost",className:i.primary.text,onClick:()=>l(y),children:"Manage"})]})})]},y.id),[l,i,j]);return ys([{key:"n",ctrlOrCmd:!0,action:o,description:"Log new evidence"},{key:"f",ctrlOrCmd:!0,action:()=>n.toggle(),description:"Toggle filters"}]),e.jsxs("div",{className:"space-y-4 h-full flex flex-col",children:[d&&e.jsx(Ke,{isOpen:!0,onClose:()=>m(null),initialTitle:`Audit Evidence: ${d.title}`,relatedModule:"Evidence",relatedItemId:d.id,relatedItemTitle:d.title}),e.jsxs("div",{className:"flex flex-col md:flex-row md:justify-between md:items-center gap-4 mb-2 shrink-0",children:[e.jsxs("div",{children:[e.jsx("h2",{className:t("text-2xl font-bold tracking-tight",i.text.primary),children:"Inventory Index"}),e.jsx("p",{className:t("mt-1 text-sm",i.text.secondary),children:"Master Chain of Custody & Asset Tracking"})]}),e.jsxs("div",{className:"flex gap-2 w-full md:w-auto",children:[e.jsx(_,{variant:"secondary",icon:ps,onClick:n.toggle,className:"w-full md:w-auto justify-center",children:n.isOpen?"Hide Filters":"Filters"}),e.jsx(_,{variant:"primary",icon:J,onClick:o,className:"w-full md:w-auto justify-center",children:"Log New Item"})]})]}),e.jsxs(Wr,{isOpen:n.isOpen,onClose:n.close,onClear:h,children:[e.jsxs("div",{className:"relative",children:[e.jsx("input",{className:t("p-2 border rounded text-sm w-full outline-none",i.border.default,i.surface.default),placeholder:"Search...",value:a.search,onChange:y=>p("search",y.target.value)}),u&&e.jsx("div",{className:"absolute right-3 top-1/2 -translate-y-1/2",children:e.jsx(re,{className:"h-4 w-4 animate-spin text-blue-500"})})]}),e.jsxs("select",{className:t("p-2 border rounded text-sm w-full outline-none",i.border.default,i.surface.default),value:a.type,onChange:y=>p("type",y.target.value),children:[e.jsx("option",{value:"",children:"All Types"}),e.jsx("option",{value:"Physical",children:"Physical"}),e.jsx("option",{value:"Digital",children:"Digital"}),e.jsx("option",{value:"Document",children:"Document"})]}),e.jsx("input",{className:t("p-2 border rounded text-sm w-full outline-none",i.border.default,i.surface.default),placeholder:"Case ID",value:a.caseId,onChange:y=>p("caseId",y.target.value)}),e.jsx("input",{className:t("p-2 border rounded text-sm w-full outline-none",i.border.default,i.surface.default),placeholder:"Custodian",value:a.custodian,onChange:y=>p("custodian",y.target.value)})]}),e.jsxs("div",{className:t("flex-1 min-h-0 flex flex-col border rounded-lg overflow-hidden shadow-sm bg-white",i.border.default),children:[e.jsxs("div",{className:t("flex items-center px-6 py-3 border-b font-bold text-xs uppercase tracking-wider bg-slate-50 shrink-0",i.border.default,i.text.secondary),children:[e.jsx("div",{className:"w-[15%]",children:"Evidence ID"}),e.jsx("div",{className:"w-[25%]",children:"Description"}),e.jsx("div",{className:"w-[10%]",children:"Type"}),e.jsx("div",{className:"w-[15%]",children:"Custodian"}),e.jsx("div",{className:"w-[15%]",children:"Date"}),e.jsx("div",{className:"w-[10%]",children:"Status"}),e.jsx("div",{className:"w-[10%] text-right",children:"Action"})]}),e.jsx("div",{className:"flex-1 relative",children:e.jsx(rs,{items:x,height:"100%",itemHeight:72,renderItem:N,emptyMessage:"No evidence found."})})]})]})},fa=z.memo(Qi),Xi=Object.freeze(Object.defineProperty({__proto__:null,EvidenceInventory:fa},Symbol.toStringTag,{value:"Module"}));c.lazy(()=>k(()=>import("./EvidenceDashboard-_t9vysT3.js"),__vite__mapDeps([115,1,2,3,24,10,6,13,25,4,5,7,8])).then(s=>({default:s.EvidenceDashboard})));c.lazy(()=>k(()=>Promise.resolve().then(()=>Xi),void 0).then(s=>({default:s.EvidenceInventory})));c.lazy(()=>k(()=>import("./EvidenceCustodyLog-DQfdchh_.js"),__vite__mapDeps([116,1,2,3,13,10,6,21,4,5,7])).then(s=>({default:s.EvidenceCustodyLog})));c.lazy(()=>k(()=>import("./EvidenceIntake-BKyDZ84K.js"),__vite__mapDeps([117,1,2,3,13,10,6,24,9,11,4,5,7,118,119,15,16,12,17,18,19,20,21,22,23,25,8,26,27,28,14,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44])).then(s=>({default:s.EvidenceIntake})));c.lazy(()=>k(()=>import("./EvidenceDetail-BeGC3Tls.js"),__vite__mapDeps([120,1,2,3,13,10,6,33,15,24,14,4,5,7,11,37,8,9,34,35,38,32,41,23,51,119,36,16,12,17,18,19,20,21,22,25,26,27,28,29,30,31,39,40,42,43,44])).then(s=>({default:s.EvidenceDetail})));c.lazy(()=>k(()=>import("./DiscoveryDashboard-D_znYq9M.js"),__vite__mapDeps([121,1,2,3,24,10,6,13,15,4,5,7,25,93,16,11,12,17,18,19,20,21,22,9,23,8,26,27,28,14,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44])));c.lazy(()=>k(()=>Promise.resolve().then(()=>pa),void 0));c.lazy(()=>k(()=>import("./PrivilegeLog-CJKAEtyb.js"),__vite__mapDeps([122,1,2,3,21,10,6,15,13,31,9,11,4,5,7,51,16,12,17,18,19,20,22,23,24,25,8,26,27,28,14,29,30,32,33,34,35,36,37,38,39,40,41,42,43,44])));c.lazy(()=>k(()=>import("./LegalHolds-dzt5ONiz.js"),__vite__mapDeps([123,1,2,3,13,10,6,15,21,31,9,11,4,5,7,51,16,12,17,18,19,20,22,23,24,25,8,26,27,28,14,29,30,32,33,34,35,36,37,38,39,40,41,42,43,44])));c.lazy(()=>k(()=>import("./DiscoveryDocumentViewer-CZSbRo-r.js"),__vite__mapDeps([124,1,2,3,13,10,6,4,5,7])));c.lazy(()=>k(()=>import("./DiscoveryResponse-7z1Cl_mA.js"),__vite__mapDeps([125,1,2,3,15,10,6,13,4,5,7,11,9,36,16,126,12,17,18,19,20,21,22,23,24,25,8,26,27,28,14,29,30,31,32,33,34,35,37,38,39,40,41,42,43,44])));c.lazy(()=>k(()=>import("./DiscoveryProduction-W8-aaZ6R.js"),__vite__mapDeps([127,5,1,2,3,13,10,6,24,51,126,7,15,16,11,4,12,17,18,19,20,21,22,9,23,25,8,26,27,28,14,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44])));c.lazy(()=>k(()=>import("./DiscoveryProductions-Di82MD_p.js"),__vite__mapDeps([128,1,2,3,6,4,5,7,9,10,11,21,15,13,127,24,51,126,16,12,17,18,19,20,22,23,25,8,26,27,28,14,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44])));c.lazy(()=>k(()=>import("./DiscoveryDepositions-B8kkgiCu.js"),__vite__mapDeps([129,1,2,3,15,10,6,13,34,35,21,37,4,5,7,8,9,11,14,38,32])));c.lazy(()=>k(()=>import("./DiscoveryESI-DIFdAqVw.js"),__vite__mapDeps([130,1,2,3,15,10,6,13,91,24,4,5,7,9,11,51,116,21,25,16,12,17,18,19,20,22,23,8,26,27,28,14,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44])));c.lazy(()=>k(()=>import("./DiscoveryInterviews-Dl49KfuM.js"),__vite__mapDeps([131,1,2,3,4,5,6,7,13,10,21,15,14,11,34,35,41])));c.lazy(()=>k(()=>import("./InitialDisclosureWizard-BTNlSaqB.js"),__vite__mapDeps([132,1,2,3,24,10,6,13,34,35,9,11,4,5,7,118,15,16,12,17,18,19,20,21,22,23,25,8,26,27,28,14,29,30,31,32,33,36,37,38,39,40,41,42,43,44])));c.lazy(()=>k(()=>import("./MotionToCompelBuilder-DaSA2i_T.js"),__vite__mapDeps([133,1,2,3,24,10,6,13,15,40,36,16,4,5,7,9,11,12,17,18,19,20,21,22,23,25,8,26,27,28,14,29,30,31,32,33,34,35,37,38,39,41,42,43,44])));c.lazy(()=>k(()=>import("./DiscoveryStipulations-zpeTLweA.js"),__vite__mapDeps([134,1,2,3,21,10,6,15,13,34,35,14,4,5,7,11,41,9])));c.lazy(()=>k(()=>import("./RequestForAdmission-BwsLboYW.js"),__vite__mapDeps([135,1,2,3,21,10,6,15,13,4,5,7])));c.lazy(()=>k(()=>import("./Examinations-BY0L3o6C.js"),__vite__mapDeps([136,1,2,3,21,10,6,13,15,4,5,7,14,11,34,35,41])));c.lazy(()=>k(()=>import("./TranscriptManager-BK-bb49J.js"),__vite__mapDeps([137,1,2,3,21,10,6,13,4,5,7,11,41,14,34])));c.lazy(()=>k(()=>import("./VendorManagement-AezQQ3hs.js"),__vite__mapDeps([138,1,2,3,21,10,6,15,13,34,14,4,5,7,11,41])));c.lazy(()=>k(()=>import("./PerpetuateTestimony-C-VYmdCX.js"),__vite__mapDeps([139,1,2,3,24,10,6,13,4,5,7])));const Ss=[{id:"dashboard_parent",label:"Dashboard",icon:Ee,subTabs:[{id:"dashboard",label:"Overview",icon:Ee}]},{id:"collection",label:"Collection",icon:Ts,subTabs:[{id:"esi",label:"ESI Map",icon:Ts},{id:"custodians",label:"Custodians",icon:de},{id:"interviews",label:"Interviews",icon:lr},{id:"holds",label:"Legal Holds",icon:Oe}]},{id:"review",label:"Review & Production",icon:Q,subTabs:[{id:"requests",label:"Requests",icon:Pt},{id:"productions",label:"Productions",icon:ir},{id:"privilege",label:"Privilege Log",icon:Pe}]},{id:"proceedings",label:"Proceedings",icon:As,subTabs:[{id:"depositions",label:"Depositions",icon:As},{id:"examinations",label:"Examinations",icon:Ee},{id:"plan",label:"Discovery Plan",icon:de}]}],en=({activeTab:s,setActiveTab:a,activeParentTabId:r,onParentTabChange:l})=>{const{theme:o}=D(),i=Ss.find(n=>n.id===r)||Ss[0];return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:t("hidden md:flex space-x-6 border-b mb-4",o.border.default),children:Ss.map(n=>e.jsxs("button",{onClick:()=>l(n.id),className:t("flex items-center pb-3 px-1 text-sm font-medium transition-all border-b-2",r===n.id?t("border-current",o.primary.text):t("border-transparent",o.text.secondary,`hover:${o.text.primary}`)),children:[e.jsx(n.icon,{className:t("h-4 w-4 mr-2",r===n.id?o.primary.text:o.text.tertiary)}),n.label]},n.id))}),i.subTabs.length>1&&e.jsx("div",{className:t("flex space-x-2 overflow-x-auto no-scrollbar py-3 px-4 md:px-6 rounded-lg border mb-4 touch-pan-x",o.surface.highlight,o.border.default),children:i.subTabs.map(n=>e.jsxs("button",{onClick:()=>a(n.id),className:t("flex-shrink-0 px-3 py-1.5 rounded-full font-medium text-xs md:text-sm transition-all duration-200 whitespace-nowrap flex items-center gap-2 border",s===n.id?t(o.surface.default,o.primary.text,"shadow-sm border-transparent ring-1",o.primary.border):t("bg-transparent",o.text.secondary,"border-transparent",`hover:${o.surface.default}`)),children:[e.jsx(n.icon,{className:t("h-3.5 w-3.5",s===n.id?o.primary.text:o.text.tertiary)}),n.label]},n.id))})]})},sn=({error:s,errorInfo:a,onReset:r,onReturnHome:l})=>e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-slate-50 dark:bg-slate-900 p-4",children:e.jsxs("div",{className:"max-w-2xl w-full bg-white dark:bg-slate-800 rounded-lg shadow-xl border border-slate-200 dark:border-slate-700 p-8",children:[e.jsxs("div",{className:"flex items-center gap-4 mb-6",children:[e.jsx("div",{className:"p-3 bg-red-100 dark:bg-red-900/20 rounded-full",children:e.jsx(be,{className:"h-8 w-8 text-red-600 dark:text-red-400"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-slate-900 dark:text-slate-100",children:"Discovery Center Error"}),e.jsx("p",{className:"text-sm text-slate-600 dark:text-slate-400 mt-1",children:"Something went wrong while loading the discovery platform"})]})]}),e.jsxs("div",{className:"mb-6 p-4 bg-slate-50 dark:bg-slate-900 rounded-lg border border-slate-200 dark:border-slate-700",children:[e.jsx("h3",{className:"text-sm font-semibold text-slate-700 dark:text-slate-300 mb-2",children:"Error Details:"}),e.jsx("p",{className:"text-sm font-mono text-red-600 dark:text-red-400 mb-2",children:s.message}),!1]}),e.jsxs("div",{className:"mb-6 p-4 bg-blue-50 dark:bg-blue-900/20 rounded-lg border border-blue-200 dark:border-blue-800",children:[e.jsx("h3",{className:"text-sm font-semibold text-blue-900 dark:text-blue-300 mb-2",children:"Troubleshooting Tips:"}),e.jsxs("ul",{className:"text-sm text-blue-800 dark:text-blue-400 space-y-1 list-disc list-inside",children:[e.jsx("li",{children:"Check if discovery requests or legal holds have valid data"}),e.jsx("li",{children:"Verify your network connection and try again"}),e.jsx("li",{children:"Clear browser cache and refresh the page"}),e.jsx("li",{children:"Try accessing a different discovery view (Dashboard, Requests, etc.)"}),e.jsx("li",{children:"Contact support if the issue persists"})]})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx(_,{variant:"primary",icon:Is,onClick:r,className:"flex-1",children:"Try Again"}),e.jsx(_,{variant:"outline",icon:nr,onClick:l,className:"flex-1",children:"Return to Dashboard"})]}),e.jsxs("p",{className:"text-xs text-slate-500 dark:text-slate-400 text-center mt-6",children:["Error ID: ",Date.now().toString(36)," • This error has been logged for investigation"]})]})});class tn extends c.Component{state={hasError:!1,error:null,errorInfo:null};static getDerivedStateFromError(a){return{hasError:!0,error:a,errorInfo:null}}componentDidCatch(a,r){console.error("Discovery Error Boundary caught:",a,r),this.setState({error:a,errorInfo:r})}handleReset=()=>{this.setState({hasError:!1,error:null,errorInfo:null}),this.props.onReset&&this.props.onReset()};handleReturnHome=()=>{window.location.href="/"};render(){return this.state.hasError&&this.state.error?e.jsx(sn,{error:this.state.error,errorInfo:this.state.errorInfo,onReset:this.handleReset,onReturnHome:this.handleReturnHome}):this.props.children}}const A=({className:s})=>{const{theme:a}=D();return e.jsx("div",{className:t("animate-pulse rounded",a.surface.highlight,s)})},an=()=>{const{theme:s}=D();return e.jsxs("div",{className:"space-y-4 animate-fade-in",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx(A,{className:"h-8 w-48"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(A,{className:"h-9 w-32"}),e.jsx(A,{className:"h-9 w-32"})]})]}),e.jsxs("div",{className:t("rounded-lg border overflow-hidden",s.border.default),children:[e.jsx("div",{className:t("p-4 border-b",s.surface.highlight,s.border.default),children:e.jsxs("div",{className:"flex gap-4",children:[e.jsx(A,{className:"h-4 w-[30%]"}),e.jsx(A,{className:"h-4 w-[15%]"}),e.jsx(A,{className:"h-4 w-[15%]"}),e.jsx(A,{className:"h-4 w-[20%]"}),e.jsx(A,{className:"h-4 w-[10%]"}),e.jsx(A,{className:"h-4 w-[10%]"})]})}),[...Array(5)].map((a,r)=>e.jsx("div",{className:t("p-6 border-b",s.border.default),children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"w-[30%] space-y-2",children:[e.jsx(A,{className:"h-5 w-3/4"}),e.jsx(A,{className:"h-3 w-1/2"})]}),e.jsx("div",{className:"w-[15%]",children:e.jsx(A,{className:"h-6 w-24 rounded-full"})}),e.jsx("div",{className:"w-[15%]",children:e.jsx(A,{className:"h-4 w-20"})}),e.jsxs("div",{className:"w-[20%] space-y-1",children:[e.jsx(A,{className:"h-4 w-24"}),e.jsx(A,{className:"h-3 w-20"})]}),e.jsx("div",{className:"w-[10%]",children:e.jsx(A,{className:"h-6 w-20 rounded-full"})}),e.jsxs("div",{className:"w-[10%] flex gap-2",children:[e.jsx(A,{className:"h-8 w-8 rounded"}),e.jsx(A,{className:"h-8 w-8 rounded"})]})]})},`discovery-request-row-${r}`))]})]})},rn=()=>{const{theme:s}=D();return e.jsxs("div",{className:"space-y-4 animate-fade-in",children:[e.jsx("div",{className:t("p-4 rounded-lg border",s.surface.highlight,s.border.default),children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(A,{className:"h-6 w-64"}),e.jsx(A,{className:"h-4 w-96"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(A,{className:"h-9 w-28"}),e.jsx(A,{className:"h-9 w-32"})]})]})}),e.jsxs("div",{className:t("rounded-lg border overflow-hidden",s.border.default),children:[e.jsx("div",{className:t("p-4 border-b",s.surface.highlight,s.border.default),children:e.jsxs("div",{className:"flex gap-4",children:[e.jsx(A,{className:"h-4 w-[15%]"}),e.jsx(A,{className:"h-4 w-[15%]"}),e.jsx(A,{className:"h-4 w-[15%]"}),e.jsx(A,{className:"h-4 w-[20%]"}),e.jsx(A,{className:"h-4 w-[35%]"})]})}),[...Array(4)].map((a,r)=>e.jsx("div",{className:t("p-4 border-b",s.border.default),children:e.jsxs("div",{className:"flex gap-4",children:[e.jsx("div",{className:"w-[15%] space-y-1",children:e.jsx(A,{className:"h-4 w-full"})}),e.jsx("div",{className:"w-[15%]",children:e.jsx(A,{className:"h-4 w-full"})}),e.jsx("div",{className:"w-[15%]",children:e.jsx(A,{className:"h-6 w-32 rounded-full"})}),e.jsxs("div",{className:"w-[20%] space-y-1",children:[e.jsx(A,{className:"h-3 w-full"}),e.jsx(A,{className:"h-3 w-3/4"})]}),e.jsx("div",{className:"w-[35%]",children:e.jsx(A,{className:"h-4 w-full"})})]})},r))]})]})},ln=()=>{const{theme:s}=D();return e.jsxs("div",{className:"space-y-6 animate-fade-in",children:[e.jsx("div",{className:t("p-6 rounded-lg shadow-sm border",s.surface.overlay,s.border.default),children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(A,{className:"h-7 w-48"}),e.jsx(A,{className:"h-4 w-96"})]}),e.jsxs("div",{className:"text-right space-y-1",children:[e.jsx(A,{className:"h-8 w-24 ml-auto"}),e.jsx(A,{className:"h-3 w-32 ml-auto"})]})]})}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[...Array(6)].map((a,r)=>e.jsxs("div",{className:t("p-6 rounded-lg border shadow-sm",s.surface.default,s.border.default),children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(A,{className:"h-10 w-10 rounded"}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(A,{className:"h-5 w-32"}),e.jsx(A,{className:"h-3 w-24"})]})]}),e.jsx(A,{className:"h-6 w-20 rounded-full"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx(A,{className:"h-4 w-20"}),e.jsx(A,{className:"h-4 w-16"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx(A,{className:"h-4 w-24"}),e.jsx(A,{className:"h-4 w-20"})]}),e.jsx(A,{className:"h-2 w-full rounded-full mt-4"}),e.jsxs("div",{className:"flex gap-2 mt-4",children:[e.jsx(A,{className:"h-8 flex-1 rounded"}),e.jsx(A,{className:"h-8 flex-1 rounded"})]})]})]},r))})]})},nn=()=>{const{theme:s}=D();return e.jsxs("div",{className:"space-y-4 animate-fade-in",children:[e.jsxs("div",{className:t("border p-4 rounded-lg flex gap-3",s.status.warning.bg,s.status.warning.border),children:[e.jsx(A,{className:"h-6 w-6 rounded shrink-0"}),e.jsxs("div",{className:"flex-1 space-y-2",children:[e.jsx(A,{className:"h-4 w-48"}),e.jsx(A,{className:"h-3 w-full"})]})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx(A,{className:"h-6 w-40"}),e.jsx(A,{className:"h-9 w-36"})]}),e.jsxs("div",{className:t("rounded-lg border overflow-hidden",s.border.default),children:[e.jsx("div",{className:t("p-4 border-b",s.surface.highlight,s.border.default),children:e.jsxs("div",{className:"flex gap-4",children:[e.jsx(A,{className:"h-4 w-[25%]"}),e.jsx(A,{className:"h-4 w-[20%]"}),e.jsx(A,{className:"h-4 w-[20%]"}),e.jsx(A,{className:"h-4 w-[20%]"}),e.jsx(A,{className:"h-4 w-[15%]"})]})}),[...Array(4)].map((a,r)=>e.jsx("div",{className:t("p-4 border-b",s.border.default),children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-[25%]",children:e.jsx(A,{className:"h-5 w-3/4"})}),e.jsx("div",{className:"w-[20%]",children:e.jsx(A,{className:"h-4 w-2/3"})}),e.jsx("div",{className:"w-[20%]",children:e.jsx(A,{className:"h-4 w-1/2"})}),e.jsx("div",{className:"w-[20%]",children:e.jsx(A,{className:"h-6 w-24 rounded-full"})}),e.jsx("div",{className:"w-[15%] text-right",children:e.jsx(A,{className:"h-8 w-20 ml-auto rounded"})})]})},r))]})]})},on=c.lazy(()=>k(()=>import("./DiscoveryDashboard-D_znYq9M.js"),__vite__mapDeps([121,1,2,3,24,10,6,13,15,4,5,7,25,93,16,11,12,17,18,19,20,21,22,9,23,8,26,27,28,14,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44]))),cn=c.lazy(()=>k(()=>Promise.resolve().then(()=>pa),void 0)),dn=c.lazy(()=>k(()=>import("./PrivilegeLog-CJKAEtyb.js"),__vite__mapDeps([122,1,2,3,21,10,6,15,13,31,9,11,4,5,7,51,16,12,17,18,19,20,22,23,24,25,8,26,27,28,14,29,30,32,33,34,35,36,37,38,39,40,41,42,43,44]))),mn=c.lazy(()=>k(()=>import("./LegalHolds-dzt5ONiz.js"),__vite__mapDeps([123,1,2,3,13,10,6,15,21,31,9,11,4,5,7,51,16,12,17,18,19,20,22,23,24,25,8,26,27,28,14,29,30,32,33,34,35,36,37,38,39,40,41,42,43,44]))),un=c.lazy(()=>k(()=>import("./DiscoveryDocumentViewer-CZSbRo-r.js"),__vite__mapDeps([124,1,2,3,13,10,6,4,5,7]))),xn=c.lazy(()=>k(()=>import("./DiscoveryResponse-7z1Cl_mA.js"),__vite__mapDeps([125,1,2,3,15,10,6,13,4,5,7,11,9,36,16,126,12,17,18,19,20,21,22,23,24,25,8,26,27,28,14,29,30,31,32,33,34,35,37,38,39,40,41,42,43,44]))),hn=c.lazy(()=>k(()=>import("./DiscoveryProduction-W8-aaZ6R.js"),__vite__mapDeps([127,5,1,2,3,13,10,6,24,51,126,7,15,16,11,4,12,17,18,19,20,21,22,9,23,25,8,26,27,28,14,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44]))),fn=c.lazy(()=>k(()=>import("./DiscoveryProductions-Di82MD_p.js"),__vite__mapDeps([128,1,2,3,6,4,5,7,9,10,11,21,15,13,127,24,51,126,16,12,17,18,19,20,22,23,25,8,26,27,28,14,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44]))),pn=c.lazy(()=>k(()=>import("./DiscoveryDepositions-B8kkgiCu.js"),__vite__mapDeps([129,1,2,3,15,10,6,13,34,35,21,37,4,5,7,8,9,11,14,38,32]))),gn=c.lazy(()=>k(()=>import("./DiscoveryESI-DIFdAqVw.js"),__vite__mapDeps([130,1,2,3,15,10,6,13,91,24,4,5,7,9,11,51,116,21,25,16,12,17,18,19,20,22,23,8,26,27,28,14,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44]))),jn=c.lazy(()=>k(()=>import("./DiscoveryInterviews-Dl49KfuM.js"),__vite__mapDeps([131,1,2,3,4,5,6,7,13,10,21,15,14,11,34,35,41]))),bn=c.lazy(()=>k(()=>import("./Examinations-BY0L3o6C.js"),__vite__mapDeps([136,1,2,3,21,10,6,13,15,4,5,7,14,11,34,35,41]))),vn=c.lazy(()=>k(()=>import("./Custodians-DgOpVbj5.js"),__vite__mapDeps([140,1,2,3,21,10,6,15,13,34,35,14,4,5,7,11,8,41,112,9]))),yn=({initialTab:s,caseId:a})=>{const{theme:r}=D(),l=De(),[o,i]=Ht(a?`discovery_active_tab_${a}`:"discovery_active_tab",s||"dashboard"),[n,d]=c.useState(null);c.useEffect(()=>{["doc_viewer","response","production_wizard"].includes(o)&&!n&&(console.warn("[DiscoveryPlatform] Wizard view without context, resetting to dashboard"),i("dashboard"))},[o,n,i]);const{data:m=[]}=F([xs.REQUESTS,a||"all"],async()=>I.discovery.getRequests(a)),{mutate:f,isLoading:u}=le(async()=>I.discovery.syncDeadlines(),{onSuccess:()=>{l.success("Synced discovery deadlines with court calendar."),Y.invalidate(U.discovery.all()),Y.invalidate(U.calendar.events())},onError:C=>{l.error("Failed to sync deadlines. Please try again later."),console.error("Sync error:",C)}});c.useEffect(()=>{s&&i(s)},[s,i]);const x=c.useMemo(()=>bi(o),[o]),p=c.useCallback(C=>{i(vi(C))},[i]),h=(C,b)=>{b&&d(b),i(C)},j=()=>{i("dashboard"),d(null)};ys({"mod+d":()=>i("dashboard"),"mod+r":()=>i("requests"),"mod+p":()=>i("privilege"),"mod+h":()=>i("holds"),"mod+e":()=>i("esi"),escape:()=>{y&&j()}});const N=async C=>{await I.discovery.updateRequestStatus(C,"Responded"),Y.invalidate(a?U.discovery.byCaseId(a):U.discovery.all()),alert(`Response saved for ${C}. Status updated to Responded.`),i("requests")},y=["doc_viewer","response","production_wizard"].includes(o),v=c.useMemo(()=>({dashboard:e.jsx(on,{onNavigate:h}),requests:e.jsx(cn,{items:m,onNavigate:h}),depositions:e.jsx(pn,{}),examinations:e.jsx(bn,{}),custodians:e.jsx(vn,{}),esi:e.jsx(gn,{}),productions:e.jsx(fn,{onCreateClick:()=>i("production_wizard")}),interviews:e.jsx(jn,{}),privilege:e.jsx(dn,{}),holds:e.jsx(mn,{}),plan:e.jsxs("div",{className:t("p-12 flex flex-col items-center justify-center h-full text-center rounded-lg border-2 border-dashed",r.border.default),children:[e.jsx(de,{className:t("h-16 w-16 mb-4 opacity-20",r.text.primary)}),e.jsx("p",{className:t("font-medium text-lg",r.text.primary),children:"Rule 26(f) Discovery Plan Builder"}),e.jsx("p",{className:t("text-sm mb-6",r.text.secondary),children:"Collaborative editor for joint discovery plans."}),e.jsx(_,{variant:"outline",onClick:j,children:"Return to Dashboard"})]})}),[m,r,h,j]);if(y)return e.jsx("div",{className:t("h-full flex flex-col animate-fade-in",r.background),children:e.jsxs(c.Suspense,{fallback:e.jsx(ke,{message:"Loading Discovery Wizard..."}),children:[o==="doc_viewer"&&e.jsx(un,{docId:n||"",onBack:j}),o==="response"&&e.jsx("div",{className:"p-6 h-full",children:e.jsx(xn,{request:m.find(C=>C.id===n)||null,onBack:()=>i("requests"),onSave:N})}),o==="production_wizard"&&e.jsx("div",{className:"p-6 h-full",children:e.jsx(hn,{request:m.find(C=>C.id===n)||null,onBack:()=>i("productions")})})]})});const S=()=>{switch(o){case"requests":return e.jsx(an,{});case"privilege":return e.jsx(rn,{});case"holds":return e.jsx(nn,{});case"esi":return e.jsx(ln,{});default:return e.jsx(ke,{message:"Loading Discovery Module..."})}};return e.jsxs("div",{className:t("h-full flex flex-col animate-fade-in",r.background),children:[e.jsxs("div",{className:t("px-6 pt-6 shrink-0",a?"pt-2":""),children:[!a&&e.jsx(Vr,{title:"Discovery Center",subtitle:"Manage Requests, Legal Holds, and FRCP Compliance.",actions:e.jsxs("div",{className:"flex gap-2",children:[e.jsx(_,{variant:"secondary",icon:ce,onClick:()=>f(void 0),isLoading:u,children:"Sync Deadlines"}),e.jsx(_,{variant:"primary",icon:J,onClick:()=>alert("New Request Wizard"),children:"Create Request"})]})}),e.jsx(en,{activeTab:o,setActiveTab:i,activeParentTabId:x.id,onParentTabChange:p})]}),e.jsx("div",{className:"flex-1 overflow-hidden px-6 pb-6 min-h-0",children:e.jsx("div",{className:"h-full overflow-y-auto custom-scrollbar",children:e.jsx(c.Suspense,{fallback:S(),children:v[o]})})})]})},Nn=s=>e.jsx(tn,{onReset:()=>window.location.reload(),children:e.jsx(yn,{...s})}),wn=({onNavigate:s,items:a=[]})=>{const{theme:r}=D(),{openWindow:l,closeWindow:o}=_e(),i=Ys(),n=c.useCallback(u=>{const x=new Date(u),p=new Date;return Math.ceil((x.getTime()-p.getTime())/(1e3*60*60*24))},[]),d=c.useCallback(u=>{switch(u){case xt.OVERDUE:return"error";case xt.RESPONDED:return"success";default:return"info"}},[]),m=c.useCallback((u,x)=>{x.stopPropagation();const p=`task-create-${u.id}`;l(p,"Create Discovery Task",e.jsx("div",{className:"p-4",children:e.jsx(Ke,{isOpen:!0,onClose:()=>o(p),initialTitle:`Respond to: ${u.title}`,relatedModule:"Discovery",relatedItemId:u.id,relatedItemTitle:u.title})}))},[l,o]);ys({"mod+n":()=>{s("requests")},"mod+f":()=>{i.toggle()}});const f=c.useCallback(u=>{const x=n(u.dueDate);return e.jsxs("div",{onClick:()=>s("response",u.id),className:t("flex items-center border-b h-[72px] px-6 transition-colors cursor-pointer group",r.border.default,`hover:${r.surface.highlight}`),children:[e.jsx("div",{className:"w-[30%] pr-4",children:e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:t("font-medium truncate",r.text.primary),children:u.title}),e.jsx("span",{className:t("text-xs font-mono",r.text.secondary),children:u.id})]})}),e.jsx("div",{className:"w-[15%]",children:e.jsx(K,{variant:"neutral",children:u.type})}),e.jsx("div",{className:"w-[15%] text-sm text-slate-600",children:u.serviceDate}),e.jsx("div",{className:"w-[20%]",children:e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:t("font-medium text-sm",r.text.primary),children:u.dueDate}),u.status!=="Responded"&&e.jsx("span",{className:`text-[10px] font-bold ${x<5?"text-red-600":r.text.secondary}`,children:x<0?`${Math.abs(x)} days overdue`:`${x} days remaining`})]})}),e.jsx("div",{className:"w-[10%]",children:e.jsx(K,{variant:d(u.status),children:u.status})}),e.jsxs("div",{className:"w-[10%] flex justify-end gap-2",onClick:p=>p.stopPropagation(),children:[e.jsx(_,{size:"sm",variant:"ghost",className:r.text.secondary,icon:Ae,onClick:p=>m(u,p),title:"Create Task"}),u.type==="Production"&&e.jsx(_,{size:"sm",variant:"outline",icon:Es,onClick:()=>s("production_wizard",u.id),title:"Produce"}),e.jsx(_,{size:"sm",variant:"ghost",icon:oe,onClick:()=>s("response",u.id),title:"Draft Response"})]})]},u.id)},[r,d,m,s,n]);return e.jsxs("div",{className:"animate-fade-in space-y-4 h-full flex flex-col",children:[e.jsxs("div",{className:t("hidden md:flex flex-col flex-1 border rounded-lg overflow-hidden",r.surface.default,r.border.default),children:[e.jsxs("div",{className:t("flex items-center px-6 py-3 border-b font-bold text-xs uppercase tracking-wider shrink-0",r.surface.highlight,r.border.default,r.text.secondary),children:[e.jsx("div",{className:"w-[30%]",children:"Request"}),e.jsx("div",{className:"w-[15%]",children:"Type"}),e.jsx("div",{className:"w-[15%]",children:"Service Date"}),e.jsx("div",{className:"w-[20%]",children:"Deadline"}),e.jsx("div",{className:"w-[10%]",children:"Status"}),e.jsx("div",{className:"w-[10%] text-right",children:"Action"})]}),e.jsx("div",{className:"flex-1 relative",children:e.jsx(rs,{items:a,height:"100%",itemHeight:72,renderItem:f,emptyMessage:"No discovery requests found."})})]}),e.jsx("div",{className:"md:hidden space-y-4",children:a.map(u=>{const x=n(u.dueDate);return e.jsxs("div",{onClick:()=>s("response",u.id),className:t("p-4 rounded-lg shadow-sm border cursor-pointer active:scale-[0.98] transition-transform",r.surface.default,r.border.default),children:[e.jsxs("div",{className:"flex justify-between items-start mb-2",children:[e.jsx("span",{className:t("text-xs font-mono",r.text.secondary),children:u.id}),e.jsx(K,{variant:u.status==="Overdue"?"error":u.status==="Responded"?"success":"info",children:u.status})]}),e.jsx("h4",{className:t("font-bold mb-1",r.text.primary),children:u.title}),e.jsx("div",{className:"flex gap-2 mb-3",children:e.jsx(K,{variant:"neutral",children:u.type})}),e.jsxs("div",{className:t("flex justify-between items-center text-xs p-2 rounded mb-3",r.surface.highlight,r.text.secondary),children:[e.jsxs("span",{className:"flex items-center",children:["Due: ",u.dueDate]}),u.status!=="Responded"&&e.jsx("span",{className:`font-bold ${x<5?"text-red-600":r.text.secondary}`,children:x<0?"OVERDUE":`${x}d left`})]}),e.jsxs("div",{className:"flex justify-end gap-2",onClick:p=>p.stopPropagation(),children:[e.jsx(_,{size:"sm",variant:"ghost",icon:Ae,onClick:p=>m(u,p),children:"Task"}),u.type==="Production"&&e.jsx(_,{size:"sm",variant:"outline",icon:Es,onClick:()=>s("production_wizard",u.id),children:"Produce"}),e.jsx(_,{size:"sm",variant:"ghost",icon:oe,onClick:()=>s("response",u.id),children:"Draft"})]})]},u.id)})})]})},wt=z.memo(wn),pa=Object.freeze(Object.defineProperty({__proto__:null,DiscoveryRequests:wt,default:wt},Symbol.toStringTag,{value:"Module"}));function Cn(s,a){if(typeof s!="function")throw new he(`[WorkerPool.${a}] Factory must be a function`,{factory:typeof s})}function kn(s,a){if(typeof s!="number"||s<=0||!Number.isInteger(s))throw new he(`[WorkerPool.${a}] Pool size must be a positive integer`,{size:s})}class Sn{constructor(a,r=Math.max(1,Math.floor((navigator.hardwareConcurrency||4)/2))){this.factory=a,this.size=r,Cn(a,"constructor"),kn(r,"constructor"),this.initialize()}workers=[];available=[];queue=[];isTerminated=!1;initialize(){console.log(`[WorkerPool] Initializing pool with ${this.size} workers...`);for(let a=0;a<this.size;a++)try{const r=this.factory();this.workers.push(r),this.available.push(r)}catch(r){console.error(`[WorkerPool] Failed to create worker ${a}:`,r)}if(this.workers.length===0)throw new _r(this.size);console.log(`[WorkerPool] Successfully created ${this.workers.length}/${this.size} workers`)}acquire(a){if(this.isTerminated)return Promise.reject(new Error("[WorkerPool.acquire] Worker pool has been terminated"));if(this.available.length>0){const r=this.available.pop();return Promise.resolve(r)}return new Promise((r,l)=>{const o={resolve:r,reject:l,timeout:a};this.queue.push(o),a&&setTimeout(()=>{const i=this.queue.indexOf(o);i!==-1&&(this.queue.splice(i,1),l(new Error(`[WorkerPool.acquire] Worker acquisition timed out after ${a}ms`)))},a)})}release(a){if(this.isTerminated){a.terminate();return}this.queue.length>0?this.queue.shift().resolve(a):this.available.includes(a)||this.available.push(a)}async execute(a,r){if(typeof a!="function")throw new he("[WorkerPool.execute] Task must be a function",{task:typeof a});const l=await this.acquire(r);try{const o=await a(l);return this.release(l),o}catch(o){throw this.release(l),o}}async executeAll(a){if(!Array.isArray(a))throw new he("[WorkerPool.executeAll] Tasks must be an array",{tasks:typeof a});return Promise.all(a.map(r=>this.execute(r)))}terminate(){if(this.isTerminated){console.warn("[WorkerPool.terminate] Pool already terminated");return}this.isTerminated=!0,this.queue.forEach(r=>{r.reject(new Error("[WorkerPool] Pool terminated while task was queued"))}),this.queue=[];let a=0;this.workers.forEach(r=>{try{r.terminate(),a++}catch(l){console.error("[WorkerPool] Error terminating worker:",l)}}),console.log(`[WorkerPool] Terminated ${a}/${this.workers.length} workers`),this.workers=[],this.available=[]}getStats(){return{size:this.workers.length,available:this.available.length,queued:this.queue.length,busy:this.workers.length-this.available.length}}isHealthy(){return!this.isTerminated&&this.workers.length>0}}class _n{pools=new Map;devStatsInterval=null;windowAdapter;constructor(a=Rs){this.windowAdapter=a}getPool(a,r,l){if(!this.pools.has(a)){const o=new Sn(r,l);this.pools.set(a,o)}return this.pools.get(a)}terminatePool(a){const r=this.pools.get(a);r&&(r.terminate(),this.pools.delete(a))}terminateAll(){this.pools.forEach(a=>a.terminate()),this.pools.clear(),this.devStatsInterval!==null&&(clearInterval(this.devStatsInterval),this.devStatsInterval=null)}getAllStats(){const a={};return this.pools.forEach((r,l)=>{a[l]=r.getStats()}),a}startDevStatsLogging(){this.devStatsInterval===null&&(this.devStatsInterval=this.windowAdapter.setInterval(()=>{const a=this.getAllStats();Object.entries(a).filter(([,l])=>l.size>0).length>0&&console.debug("[WorkerPool] Active pools:",a)},60*1e3))}initDevMode(){this.startDevStatsLogging()}}const Dn=new _n;Rs.isBrowser()&&Rs.addEventListener("beforeunload",(()=>{Dn.terminateAll()}));c.lazy(()=>k(()=>Promise.resolve().then(()=>Mn),void 0));c.lazy(()=>k(()=>import("./PleadingDrafts-CGBToQS4.js"),__vite__mapDeps([141,1,2,3,10,6,13,15,16,11,4,5,7,12,17,18,19,20,21,22,9,23,24,25,8,26,27,28,14,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44])).then(s=>({default:s.PleadingDrafts})));c.lazy(()=>k(()=>import("./PleadingTemplates-DuCtb3mU.js"),__vite__mapDeps([142,1,2,3,10,6,13,15,16,11,4,5,7,12,17,18,19,20,21,22,9,23,24,25,8,26,27,28,14,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44])).then(s=>({default:s.PleadingTemplates})));c.lazy(()=>k(()=>import("./ClauseLibrary-DAisxU19.js"),__vite__mapDeps([63,1,2,3,15,10,6,13,34,31,24,22,27,4,5,7])));c.lazy(()=>k(()=>import("./PleadingFilingQueue-D6NaIK-N.js"),__vite__mapDeps([143,1,2,3,9,10,11,4,5,6,7,15,13,22,21])).then(s=>({default:s.PleadingFilingQueue})));c.lazy(()=>k(()=>import("./PleadingAnalytics-BSACt7lv.js"),__vite__mapDeps([144,1,2,3,6,10,24,25,4,5,7,93])).then(s=>({default:s.PleadingAnalytics})));const Tn=c.lazy(()=>k(()=>import("./PleadingPaper-CbogjtHk.js"),__vite__mapDeps([145,1,2,3,6]))),En=c.lazy(()=>k(()=>import("./PleadingCanvas-CsbKMzBI.js"),__vite__mapDeps([146,1,2,3,6,40]))),An=c.lazy(()=>k(()=>import("./AIDraftingAssistant-B2lmoIdD.js"),__vite__mapDeps([147,1,2,3,13,10,6,35,36,16,4,5,7])).then(s=>({default:s.AIDraftingAssistant}))),In=c.lazy(()=>k(()=>import("./ContextPanel-DxWvC-6x.js"),__vite__mapDeps([148,1,2,3,13,10,6,4,5,7,38]))),Pn=c.lazy(()=>k(()=>import("./ComplianceHUD-nty1NNzQ.js"),__vite__mapDeps([149,1,2,3,10,6]))),Rn=c.lazy(()=>k(()=>import("./LogicOverlay-CiIVJL8I.js"),__vite__mapDeps([150,1,2,3,10,6]))),Ln=({pleading:s,onBack:a})=>{const{theme:r}=D(),l=De(),[o,i]=c.useState(s),n=sa(null,(E,L)=>E.id===L.id),[d,m]=c.useState("write"),[f,u]=c.useState(null),{data:x,isLoading:p,error:h,refetch:j}=F(["format_rules",o.jurisdictionRulesId],()=>I.pleadings.getFormattingRules()),{data:N,isLoading:y,error:v,refetch:S}=F(["cases",o.caseId],()=>I.cases.getById(o.caseId)),C=al({initialState:o,maxHistory:50,onStateChange:c.useCallback(E=>{i(E)},[])}),{forceSave:b,isSaving:w}=il({data:o,onSave:c.useCallback(async E=>{try{await I.pleadings.update(E.id,E),Y.invalidate(U.pleadings.byCaseId(E.caseId)),u(null)}catch(L){throw L instanceof Er&&u("Document was modified by another user. Please refresh."),L}},[]),delay:2e3,onSuccess:()=>l.success("Document auto-saved."),onError:E=>{l.error("Save failed: "+E.message),u(E.message)}}),g=c.useCallback((E,L)=>{C.execute({execute:W=>({...W,sections:W.sections.map(X=>X.id===E?{...X,...L}:X),updatedAt:new Date().toISOString()}),undo:W=>({...W,sections:o.sections}),description:`Update section ${E}`})},[C,o.sections]),T=E=>{if(n.selected){const L=o.sections.find(W=>W.id===n.selected?.id);L&&g(n.selected.id,{content:L.content+`

`+E})}};return p||y?e.jsx(ke,{message:"Loading Designer Environment..."}):h?e.jsx(mt,{message:"Failed to load formatting rules",onRetry:j}):v?e.jsx(mt,{message:"Failed to load case data",onRetry:S}):x?e.jsxs("div",{className:"flex flex-col h-full overflow-hidden bg-slate-100 dark:bg-slate-900",children:[e.jsxs("div",{className:t("h-16 border-b flex justify-between items-center px-4 shrink-0 z-20",r.surface.default,r.border.default),children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(_,{variant:"ghost",icon:It,onClick:a,children:"Back to Workspace"}),e.jsx("div",{className:t("h-6 w-px",r.border.default)}),e.jsx("h2",{className:t("font-bold",r.text.primary),children:o.title}),f&&e.jsx("span",{className:"text-xs text-rose-600 font-medium",children:f})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(_,{variant:"ghost",icon:or,onClick:C.undo,disabled:!C.canUndo,title:"Undo"}),e.jsx(_,{variant:"ghost",icon:cr,onClick:C.redo,disabled:!C.canRedo,title:"Redo"})]}),e.jsx("div",{className:t("h-6 w-px",r.border.default)}),e.jsx("div",{className:t("flex p-1 rounded-lg border",r.surface.highlight,r.border.default),children:["write","logic","preview"].map(E=>e.jsxs("button",{onClick:()=>m(E),className:t("px-3 py-1.5 text-xs font-bold rounded-md flex items-center gap-2 transition-all",d===E?t(r.surface.default,"shadow",r.primary.text):r.text.secondary),children:[E==="write"&&e.jsx(ss,{className:"h-3 w-3"}),E==="logic"&&e.jsx(dr,{className:"h-3 w-3"}),E==="preview"&&e.jsx(Be,{className:"h-3 w-3"}),e.jsx("span",{className:"capitalize",children:E})]},E))}),e.jsx(_,{variant:"primary",icon:es,onClick:b,isLoading:w,children:"Save"})]})]}),e.jsxs("div",{className:"flex-1 flex overflow-hidden",children:[e.jsx("aside",{className:t("w-80 border-r flex flex-col shrink-0",r.surface.default,r.border.default),children:e.jsx(c.Suspense,{fallback:e.jsx("div",{className:"p-4",children:e.jsx(re,{className:"animate-spin"})}),children:e.jsx(In,{caseId:o.caseId,onInsertFact:T})})}),e.jsx("main",{className:"flex-1 overflow-auto p-8 relative",children:e.jsxs(c.Suspense,{fallback:e.jsx("div",{className:"p-4",children:e.jsx(re,{className:"animate-spin"})}),children:[e.jsxs(Tn,{rules:x,children:[e.jsx(En,{document:o,rules:x,readOnly:d==="preview",viewMode:d,onUpdateSection:g,relatedCase:N}),d==="logic"&&e.jsx(Rn,{document:o})]}),e.jsx(Pn,{rules:x,sections:o.sections,score:100})]})}),e.jsx("aside",{className:t("w-80 border-l flex flex-col shrink-0",r.surface.default,r.border.default),children:e.jsx(c.Suspense,{fallback:e.jsx("div",{className:"p-4",children:e.jsx(re,{className:"animate-spin"})}),children:e.jsx(An,{onInsert:T,caseContext:{title:N?.title||"",summary:N?.description}})})})]})]}):e.jsx(ke,{message:"Loading formatting rules..."})},Mn=Object.freeze(Object.defineProperty({__proto__:null,default:Ln},Symbol.toStringTag,{value:"Module"})),On=({caseId:s})=>e.jsx("div",{className:"h-full -mx-6 -my-6",children:e.jsx(Nn,{caseId:s})}),zn=({doc:s,analyzingId:a,onAnalyze:r,onTaskClick:l,theme:o})=>{const i=a===s.id;return e.jsxs("div",{className:t("p-4 rounded-lg border shadow-sm transition-all flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",o.surface.default,o.border.default,`hover:${o.surface.highlight}`),children:[e.jsxs("div",{className:"flex items-center gap-4 flex-1 min-w-0",children:[e.jsx("div",{className:t("p-3 rounded-lg border",o.surface.highlight,o.border.default),children:e.jsx(Q,{className:t("h-6 w-6",o.primary.text)})}),e.jsxs("div",{className:"min-w-0",children:[e.jsx("h4",{className:t("font-bold truncate",o.text.primary),children:s.title}),e.jsxs("div",{className:t("flex items-center gap-3 text-xs mt-1",o.text.secondary),children:[e.jsx("span",{children:s.type}),e.jsx("span",{children:"•"}),e.jsx("span",{children:s.uploadDate}),e.jsx("span",{children:"•"}),e.jsx("span",{className:t("font-medium",o.text.primary),children:s.status})]})]})]}),e.jsxs("div",{className:"flex items-center gap-2 self-end sm:self-center",children:[e.jsx(Qs,{tags:s.tags.slice(0,2)}),e.jsx(_,{variant:"outline",size:"sm",icon:i?re:oe,onClick:()=>r(s),isLoading:i,className:"w-28",children:i?"Analyzing...":"AI Analyze"}),e.jsx(_,{variant:"secondary",size:"sm",icon:Ae,onClick:()=>l(s),children:"Task"})]})]})},$n=c.lazy(()=>k(()=>import("./DocumentAssembly-CbSNSniz.js"),__vite__mapDeps([151,1,2,3,36,16,4,5,6,7,11,8,10,9,23,13,15,12,17,18,19,20,21,22,24,25,26,27,28,14,29,30,31,32,33,34,35,37,38,39,40,41,42,43,44])).then(s=>({default:s.DocumentAssembly}))),Vn=({documents:s,analyzingId:a,onAnalyze:r,onDocumentCreated:l})=>{const{theme:o}=D(),{openWindow:i,closeWindow:n}=_e(),d=De(),m=c.useRef(null),[f,u]=c.useState(null),[x,p]=c.useState(!1),[h,j]=c.useState(!1),N=()=>{const S="doc-assembly-wizard";i(S,"Drafting Wizard",e.jsx(c.Suspense,{fallback:e.jsx(re,{className:t("animate-spin h-8 w-8",o.text.link)}),children:e.jsx($n,{caseTitle:"Current Case",onClose:()=>n(S),onSave:C=>{l&&l(C),n(S)}})}))},y=S=>{I.tasks.add(S),Y.invalidate(U.tasks.all()),Y.invalidate(U.dashboard.stats()),d.success(`Task "${S.title}" created.`)},v=async S=>{if(S.target.files&&S.target.files.length>0&&l){p(!0);try{const C=S.target.files[0],b=await Zt.uploadDocument(C,{caseId:s.length>0?s[0].caseId:"General",sourceModule:"General",tags:h?["Evidence"]:[]});if(await Ar.publish(Ir.DOCUMENT_UPLOADED,{document:b}),h){const w={id:`ev-${Date.now()}`,trackingUuid:crypto.randomUUID(),caseId:b.caseId,title:b.title,type:"Document",description:"Auto-logged via Document Upload",collectionDate:new Date().toISOString().split("T")[0],collectedBy:"System",custodian:"Firm DMS",location:"Evidence Vault",admissibility:"Pending",chainOfCustody:[{id:`cc-${Date.now()}`,date:new Date().toISOString(),action:"Intake from DMS",actor:"System",notes:"Linked from Case Documents"}],tags:["Document"],fileSize:typeof b.fileSize=="string"?b.fileSize:String(b.fileSize)};await I.evidence.add(w),Y.invalidate(U.evidence.all()),d.success("Document uploaded and logged to Evidence Vault.")}else d.success(`Uploaded ${C.name} successfully.`);l(b)}catch(C){d.error("Failed to upload document."),console.error(C)}finally{p(!1),j(!1),m.current&&(m.current.value="")}}};return e.jsxs("div",{className:"space-y-6 relative",children:[f&&e.jsx(Ke,{isOpen:!0,onClose:()=>u(null),onSave:y,initialTitle:`Review Document: ${f.title}`,relatedModule:"Documents",relatedItemId:f.id,relatedItemTitle:f.title}),e.jsx("input",{type:"file",ref:m,className:"hidden",onChange:v,"aria-label":"Upload document"}),e.jsxs("div",{className:"flex flex-col md:flex-row md:justify-between md:items-center gap-4",children:[e.jsx("div",{className:"flex gap-2",children:e.jsx("input",{placeholder:"Search documents...",className:t("px-4 py-2 border rounded-md text-sm w-full md:w-64 outline-none focus:ring-2 focus:ring-blue-500",o.surface.default,o.border.default,o.text.primary)})}),e.jsxs("div",{className:"flex flex-col md:flex-row gap-2 w-full md:w-auto items-center",children:[e.jsxs("label",{className:t("flex items-center text-sm cursor-pointer select-none",o.text.secondary),children:[e.jsx("input",{type:"checkbox",className:t("mr-2 rounded focus:ring-2 focus:ring-blue-500",o.action.primary.text),checked:h,onChange:S=>j(S.target.checked)}),e.jsx(Ds,{className:t("h-4 w-4 mr-1",h?o.text.link:o.text.tertiary)}),"Log as Evidence"]}),e.jsxs("button",{onClick:N,className:t("flex-1 md:flex-none flex items-center justify-center px-4 py-2 rounded-md text-sm font-medium transition-colors shadow-sm hover:shadow",o.primary.DEFAULT,o.text.inverse,o.primary.hover),children:[e.jsx(oe,{className:"h-4 w-4 mr-2"})," Assemble Doc"]}),e.jsxs("button",{onClick:()=>m.current?.click(),disabled:x,className:t("flex-1 md:flex-none flex items-center justify-center px-4 py-2 text-white rounded-md text-sm font-medium transition-colors",o.primary.DEFAULT,o.primary.hover,x?"opacity-70 cursor-not-allowed":""),children:[x?e.jsx(re,{className:"h-4 w-4 mr-2 animate-spin"}):e.jsx(J,{className:"h-4 w-4 mr-2"}),x?"Uploading...":"Upload"]})]})]}),e.jsx("div",{className:"grid gap-4",children:s.map(S=>e.jsx(zn,{doc:S,analyzingId:a,onAnalyze:r,onTaskClick:u,theme:o},S.id))})]})},Fn=({caseTitle:s,draftPrompt:a,setDraftPrompt:r,draftResult:l,isDrafting:o,onDraft:i})=>{const{theme:n}=D(),[d,m]=c.useState(""),[f,u]=c.useState(""),[x,p]=c.useState("edit"),[h,j]=c.useState(!1);c.useEffect(()=>{if(l){const S=l.replace(/\n\n/g,"</p><p>").replace(/\n/g,"<br/>");m(C=>C+`<p>${S}</p>`)}},[l]);const N=async()=>{if(!d)return;j(!0),p("review");const S=d.replace(/<\/p>/gi,`
`).replace(/<br\s*\/?>/gi,`
`).replace(/<[^>]*>/g,""),C=await qe.reviewContract(S);u(C),j(!1)},y=S=>{const C=`<p><strong>[${S.name}]:</strong> ${S.content}</p>`;m(b=>b+C)},v=()=>{r(`For the case "${s}", draft a standard motion to compel discovery regarding ...`)};return e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6 h-full relative",children:[e.jsxs("div",{className:"lg:col-span-2 flex flex-col h-full space-y-4",children:[e.jsxs("div",{className:t("p-2 rounded-lg border shadow-sm flex gap-2 items-center",n.surface.default,n.border.default),children:[e.jsx("button",{onClick:v,className:t("p-2 rounded-md transition-colors",n.surface.highlight,n.action.primary.text,`hover:${n.surface.active}`),title:"AI Assist",children:e.jsx(oe,{className:t("h-5 w-5",n.action.primary.text)})}),e.jsx("input",{value:a,onChange:S=>r(S.target.value),onKeyDown:S=>S.key==="Enter"&&i(),placeholder:"Describe a clause or section to draft (e.g. 'Force Majeure for a pandemic')...",className:t("flex-1 bg-transparent border-none outline-none text-sm placeholder:text-slate-400",n.text.primary)}),e.jsx("button",{onClick:i,disabled:o||!a,className:"px-4 py-2 bg-slate-900 text-white text-xs font-bold rounded-md hover:bg-slate-800 disabled:opacity-50 transition-colors",children:o?"Generating...":"Generate Draft"})]}),e.jsx(ol,{initialContent:d,onSave:S=>{m(S),alert("Document saved to case file.")},placeholder:"Begin drafting your legal document here..."},d.length)]}),e.jsxs("div",{className:t("rounded-lg shadow-sm border overflow-hidden flex flex-col h-full",n.surface.default,n.border.default),children:[e.jsxs("div",{className:t("flex border-b",n.border.subtle),children:[e.jsx("button",{onClick:()=>p("edit"),className:t("flex-1 py-3 text-sm font-medium",x!=="review"?t(n.text.link,"border-b-2",n.action.primary.border,n.surface.highlight):t(n.text.secondary,`hover:${n.surface.highlight}`)),children:"Clause Library"}),e.jsx("button",{onClick:()=>p("review"),className:t("flex-1 py-3 text-sm font-medium",x==="review"?t(n.status.warning.text,"border-b-2",n.status.warning.border,n.surface.highlight):t(n.text.secondary,`hover:${n.surface.highlight}`)),children:"Risk Analysis"})]}),e.jsx("div",{className:t("flex-1 overflow-y-auto flex flex-col",n.surface.highlight),children:x==="review"?e.jsxs("div",{className:"p-4 space-y-4",children:[e.jsxs("div",{className:"bg-amber-50 border border-amber-200 rounded p-3 text-xs text-amber-800 flex items-start",children:[e.jsx(be,{className:"h-4 w-4 mr-2 shrink-0 mt-0.5"}),e.jsx("p",{children:"AI Analysis detects potential risks. Review suggestions carefully."})]}),h?e.jsxs("div",{className:t("flex flex-col items-center justify-center py-12",n.text.tertiary),children:[e.jsx(Js,{className:"h-8 w-8 animate-spin mb-2"}),e.jsx("span",{className:"text-xs",children:"Analyzing contract structure..."})]}):e.jsx("div",{className:t("prose prose-sm leading-relaxed whitespace-pre-wrap",n.text.secondary),children:f||e.jsxs("div",{className:t("text-center py-8 italic",n.text.tertiary),children:['Click "Review Risks" to analyze the current document content.',e.jsx("button",{onClick:N,className:t("mt-4 px-4 py-2 border rounded shadow-sm block mx-auto transition-colors",n.surface.default,n.border.default,n.text.secondary,`hover:${n.surface.highlight}`),children:"Run Analysis"})]})})]}):e.jsx(Ul,{onSelectClause:y})})]})]})},Ct=({caseId:s})=>{const{evidenceItems:a,filteredItems:r,filters:l,setFilters:o,handleItemClick:i}=yi(s);return a?e.jsx("div",{className:"space-y-4 h-full flex flex-col",children:a.length===0?e.jsx(Wt,{icon:mr,title:"No evidence logged",description:"No evidence items have been logged for this case yet."}):e.jsx(fa,{items:a,filteredItems:r,filters:l,setFilters:o,onItemClick:i,onIntakeClick:()=>alert("Please go to the main Evidence Vault to log new items.")})}):e.jsx("div",{className:"flex justify-center items-center p-8",children:e.jsx(re,{className:"animate-spin h-6 w-6"})})},Bn=({parties:s=[],onUpdate:a})=>{const{theme:r}=D(),l=hs(),o=hs(),[i,n]=c.useState({}),[d,m]=c.useState("group"),[f,u]=c.useState({}),[x,p]=c.useState(null),{data:h=[]}=F(["organizations","all"],()=>I.organization.getOrgs());c.useEffect(()=>{Xr.defer(()=>{if(d==="none"){u({"All Parties":s});return}const b={};s.forEach(w=>{const g=d==="role"?w.role:w.partyGroup||"Ungrouped";b[g]||(b[g]=[]),b[g].push(w)}),u(b)})},[s,d]);const j=()=>{if(!i.name||!i.role)return;let b=[...s];if(i.id)b=b.map(w=>w.id===i.id?{...w,...i}:w);else{const w=s.length>0?s[0].caseId:"",g={id:`p-${Date.now()}`,name:i.name,role:i.role,partyGroup:i.partyGroup,contact:i.contact||"",type:i.type||"Individual",counsel:i.counsel,linkedOrgId:i.linkedOrgId,address:i.address,phone:i.phone,email:i.email,representationType:i.representationType,attorneys:i.attorneys,caseId:w};b.push(g)}a(b),l.close(),n({})},N=b=>{p(b),o.open()},y=()=>{x&&(a(s.filter(b=>b.id!==x)),p(null))},v=b=>{n(b),l.open()},S=()=>{n({type:"Individual"}),l.open()},C=b=>b==="Corporation"?e.jsx(ur,{className:t("h-4 w-4",r.text.secondary)}):b==="Government"?e.jsx(ve,{className:t("h-4 w-4",r.text.secondary)}):e.jsx(Ws,{className:t("h-4 w-4",r.text.secondary)});return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:t("flex flex-col sm:flex-row justify-between items-start sm:items-center p-4 rounded-lg border shadow-sm gap-4",r.surface.default,r.border.default),children:[e.jsxs("div",{children:[e.jsx("h3",{className:t("text-lg font-bold",r.text.primary),children:"Involved Parties"}),e.jsx("p",{className:t("text-sm",r.text.secondary),children:"Manage plaintiffs, defendants, and groups."})]}),e.jsxs("div",{className:"flex gap-2 w-full sm:w-auto",children:[e.jsxs("select",{className:t("text-sm border rounded-md px-2 py-1.5 outline-none flex-1 sm:flex-none",r.surface.highlight,r.border.default,r.text.primary),value:d,onChange:b=>m(b.target.value),"aria-label":"Group parties by",children:[e.jsx("option",{value:"none",children:"No Grouping"}),e.jsx("option",{value:"group",children:"Group by Party Type"}),e.jsx("option",{value:"role",children:"Group by Role"})]}),e.jsx(_,{variant:"primary",icon:J,onClick:S,children:"Add Party"})]})]}),Object.entries(f).map(([b,w])=>e.jsxs("div",{className:"space-y-2",children:[d!=="none"&&e.jsxs("div",{className:"flex items-center gap-2 px-1",children:[e.jsx(gs,{className:t("h-4 w-4",r.text.tertiary)}),e.jsx("h4",{className:t("font-bold text-sm uppercase",r.text.secondary),children:b}),e.jsxs("span",{className:t("text-xs",r.text.tertiary),children:["(",w.length,")"]})]}),e.jsxs(We,{responsive:"card",children:[e.jsxs(He,{children:[e.jsx(B,{children:"Entity Name"}),e.jsx(B,{children:"Role"}),e.jsx(B,{children:"Contact Details"}),e.jsx(B,{children:"Legal Team"}),e.jsx(B,{className:"text-right",children:"Actions"})]}),e.jsx(Ue,{children:w.map(g=>{const T=h.find(E=>E.id===g.linkedOrgId);return e.jsxs(Ie,{children:[e.jsx(V,{className:t("font-medium min-w-[200px]",r.text.primary),children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:t("p-2 rounded-full mt-0.5",r.surface.highlight),children:C(g.type)}),e.jsxs("div",{className:"min-w-0",children:[e.jsx("div",{className:"truncate font-semibold",children:g.name}),T&&e.jsxs("div",{className:t("text-[10px] flex items-center mt-0.5",r.text.link),children:[e.jsx(ds,{className:"h-3 w-3 mr-1"})," Linked: ",T.name]}),g.representationType&&e.jsxs("div",{className:"text-[10px] text-slate-500 mt-0.5 font-semibold",children:["[",g.representationType,"]"]})]})]})}),e.jsxs(V,{children:[e.jsx(K,{variant:g.role.includes("Plaintiff")||g.role.includes("Appellant")?"info":g.role.includes("Defendant")||g.role.includes("Appellee")?"warning":"neutral",children:g.role}),e.jsx("div",{className:"text-[10px] text-slate-500 mt-1 ml-1",children:g.partyGroup})]}),e.jsx(V,{className:t("text-xs min-w-[180px]",r.text.secondary),children:e.jsxs("div",{className:"space-y-1",children:[g.address&&e.jsxs("div",{className:"flex items-start gap-1",children:[e.jsx(Gs,{className:"h-3 w-3 mt-0.5 shrink-0"})," ",e.jsx("span",{className:"truncate",children:g.address})]}),g.phone&&e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(Lt,{className:"h-3 w-3 shrink-0"})," ",g.phone]}),g.email&&e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(Us,{className:"h-3 w-3 shrink-0"})," ",e.jsx("span",{className:"truncate",children:g.email})]}),!g.address&&!g.phone&&!g.email&&g.contact&&e.jsx("div",{children:g.contact})]})}),e.jsx(V,{className:t("text-xs min-w-[150px]",r.text.secondary),children:g.attorneys&&g.attorneys.length>0?e.jsx("div",{className:"space-y-2",children:g.attorneys.map((E,L)=>e.jsxs("div",{className:t("p-2 rounded border text-xs",r.surface.highlight,r.border.default),children:[e.jsxs("div",{className:"font-bold flex items-center gap-1 truncate",title:E.name,children:[e.jsx(fe,{className:t("h-3 w-3 shrink-0",r.text.tertiary)})," ",E.name]}),E.firm&&e.jsx("div",{className:t("text-[10px] ml-4 truncate",r.text.secondary),children:E.firm}),E.email&&e.jsx("div",{className:t("text-[10px] ml-4 hover:underline cursor-pointer truncate",r.text.link),onClick:()=>window.location.href=`mailto:${E.email}`,children:E.email})]},L))}):e.jsx("div",{className:"max-w-xs whitespace-normal",children:g.counsel||"-"})}),e.jsx(V,{className:"text-right",children:e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx("button",{type:"button",onClick:()=>v(g),className:t("p-1 rounded transition-colors",r.text.primary,`hover:${r.surface.highlight}`,`hover:${r.primary.text}`),title:"Edit party","aria-label":"Edit party",children:e.jsx(Mt,{className:"h-4 w-4"})}),e.jsx("button",{type:"button",onClick:()=>N(g.id),className:t("p-1 rounded transition-colors",r.text.primary,`hover:${r.surface.highlight}`,`hover:${r.status.error.text}`),title:"Delete party","aria-label":"Delete party",children:e.jsx(Ze,{className:"h-4 w-4"})})]})})]},g.id)})})]})]},b)),s.length===0&&e.jsx("div",{className:t("text-center py-8 italic rounded-lg",r.surface.highlight,r.text.tertiary),children:"No parties recorded."}),e.jsx(Ne,{isOpen:l.isOpen,onClose:l.close,title:i.id?"Edit Party":"Add New Party",children:e.jsxs("div",{className:"p-6 space-y-4",children:[e.jsx(Z,{label:"Name",value:i.name||"",onChange:b=>n({...i,name:b.target.value}),placeholder:"e.g. John Doe or Acme Corp"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"partyRole",className:t("block text-xs font-semibold uppercase mb-1.5",r.text.secondary),children:"Role"}),e.jsxs("select",{id:"partyRole","aria-label":"Party Role",className:t("w-full px-3 py-2 border rounded-md text-sm outline-none",r.surface.default,r.border.default,r.text.primary),value:i.role||"",onChange:b=>n({...i,role:b.target.value}),children:[e.jsx("option",{value:"",children:"Select Role..."}),e.jsx("option",{value:"Plaintiff",children:"Plaintiff"}),e.jsx("option",{value:"Defendant",children:"Defendant"}),e.jsx("option",{value:"Debtor - Appellant",children:"Debtor - Appellant"}),e.jsx("option",{value:"Creditor - Appellee",children:"Creditor - Appellee"}),e.jsx("option",{value:"Witness",children:"Witness"}),e.jsx("option",{value:"Expert",children:"Expert"})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"partyType",className:t("block text-xs font-semibold uppercase mb-1.5",r.text.secondary),children:"Type"}),e.jsxs("select",{id:"partyType","aria-label":"Party Type",className:t("w-full px-3 py-2 border rounded-md text-sm outline-none",r.surface.default,r.border.default,r.text.primary),value:i.type||"Individual",onChange:b=>n({...i,type:b.target.value}),children:[e.jsx("option",{value:"Individual",children:"Individual"}),e.jsx("option",{value:"Corporation",children:"Corporation"}),e.jsx("option",{value:"Government",children:"Government"})]})]})]}),e.jsx(Z,{label:"Party Group",value:i.partyGroup||"",onChange:b=>n({...i,partyGroup:b.target.value}),placeholder:"e.g. Class Reps, Subsidiaries"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(Z,{label:"Email",value:i.email||"",onChange:b=>n({...i,email:b.target.value})}),e.jsx(Z,{label:"Phone",value:i.phone||"",onChange:b=>n({...i,phone:b.target.value})})]}),e.jsx(Z,{label:"Address",value:i.address||"",onChange:b=>n({...i,address:b.target.value})}),e.jsx(Z,{label:"Representation Type",value:i.representationType||"",onChange:b=>n({...i,representationType:b.target.value}),placeholder:"e.g. Pro Se, Retained"}),!(i.attorneys&&Array.isArray(i.attorneys)&&i.attorneys.length>0)&&e.jsx(Z,{label:"Legal Counsel (Simple String)",value:i.counsel||"",onChange:b=>n({...i,counsel:b.target.value}),placeholder:"Firm or Attorney Name"}),i.type==="Corporation"&&e.jsxs("div",{children:[e.jsx("label",{htmlFor:"linkedOrgId",className:t("block text-xs font-semibold uppercase mb-1.5",r.text.secondary),children:"Link to Organization (Internal DB)"}),e.jsxs("select",{id:"linkedOrgId","aria-label":"Link to Organization",className:t("w-full px-3 py-2 border rounded-md text-sm outline-none",r.surface.default,r.border.default,r.text.primary),value:i.linkedOrgId||"",onChange:b=>n({...i,linkedOrgId:b.target.value||void 0}),children:[e.jsx("option",{value:"",children:"No Link"}),h.map(b=>e.jsxs("option",{value:b.id,children:[b.name," (",b.type,")"]},b.id))]})]}),e.jsxs("div",{className:t("pt-4 flex justify-end gap-2 border-t mt-4",r.border.default),children:[e.jsx(_,{variant:"secondary",onClick:l.close,children:"Cancel"}),e.jsx(_,{variant:"primary",onClick:j,children:"Save Party"})]})]})}),e.jsx(Fr,{isOpen:o.isOpen,onClose:o.close,onConfirm:y,title:"Remove Party",message:"Are you sure you want to remove this party from the case? This action cannot be undone.",confirmText:"Remove Party",variant:"danger"})]})},Wn=({caseData:s})=>{const{theme:a}=D(),r=De(),[l,o]=c.useState("Month"),[i,n]=c.useState(null),[d,m]=c.useState(new Set),f=hs(),[u,x]=c.useState(!1),[p]=c.useState(new Date(new Date().setMonth(new Date().getMonth()-1))),{data:h=[]}=F(["cases",s.id,"phases"],()=>I.phases.getByCaseId(s.id)),{data:j=[]}=F(["tasks",s.id],()=>I.tasks.getByCaseId(s.id)),{mutate:N}=le(b=>I.tasks.update(b.id,b),{invalidateKeys:[["tasks",s.id]],onSuccess:b=>{const g=(Y.getQueryState(["tasks",s.id])?.data||[]).map(T=>T.id===b.id?b:T);Y.setQueryData(["tasks",s.id],g)}}),y=c.useMemo(()=>{switch(l){case"Day":return 60;case"Week":return 20;case"Month":return 5;case"Quarter":return 2;default:return 5}},[l]),v=c.useMemo(()=>u?new Set(Fi.findCriticalPath(j)):new Set,[j,u]),S=(b,w,g)=>{const T=j.find(E=>E.id===b);T&&N({...T,startDate:w,dueDate:g})},C=b=>{const w=new Set(d);w.has(b)?w.delete(b):w.add(b),m(w)};return e.jsxs("div",{className:t("h-full flex flex-col overflow-hidden animate-fade-in",a.background),children:[e.jsx(Ke,{isOpen:f.isOpen,onClose:()=>f.close(),onSave:()=>{r.success("Task added"),f.close()}}),e.jsxs("div",{className:t("p-4 border-b flex flex-col md:flex-row gap-4 justify-between shrink-0",a.surface.default,a.border.default),children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:t("p-2 rounded-lg bg-indigo-50 border border-indigo-100"),children:e.jsx(gs,{className:"h-5 w-5 text-indigo-600"})}),e.jsxs("div",{children:[e.jsx("h3",{className:t("text-lg font-bold",a.text.primary),children:"Master Case Plan"}),e.jsxs("p",{className:t("text-xs",a.text.secondary),children:[h.length," Phases • ",j.length," Tasks"]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("button",{onClick:()=>x(!u),className:t("flex items-center px-3 py-1.5 text-xs font-bold rounded-md border transition-all",u?"bg-red-50 text-red-600 border-red-200":"bg-white text-slate-500"),children:[e.jsx(bs,{className:"h-3 w-3 mr-1"})," Critical Path"]}),e.jsx("div",{className:t("flex items-center bg-slate-100 p-1 rounded-lg border",a.border.default),children:["Quarter","Month","Week","Day"].map(b=>e.jsx("button",{onClick:()=>o(b),className:t("px-3 py-1.5 text-xs font-bold rounded-md transition-all",l===b?"bg-white shadow text-slate-900":"text-slate-500 hover:text-slate-700"),children:b},b))}),e.jsx(_,{variant:"primary",icon:J,onClick:()=>f.open(),children:"Add Task"})]})]}),e.jsxs("div",{className:"flex-1 flex overflow-hidden",children:[e.jsx(Vi,{phases:h,tasks:j,collapsedPhases:d,activeTaskId:i,onTogglePhase:C,onHoverTask:n,onAddTask:()=>f.open()}),e.jsx(GanttTimeline,{phases:h,tasks:j.map(b=>({...b,isCritical:v.has(b.id)})),collapsedPhases:d,zoom:l,viewStartDate:p,activeTaskId:i,onHoverTask:n,pixelsPerDay:y,onUpdateTask:S})]})]})},Hn=({risks:s,selectedId:a,onSelect:r})=>{const{theme:l}=D(),o=n=>{switch(n){case"Legal":return e.jsx(Pe,{className:"h-4 w-4"});case"Financial":return e.jsx(Ce,{className:"h-4 w-4"});case"Reputational":return e.jsx(Be,{className:"h-4 w-4"});default:return e.jsx(Ot,{className:"h-4 w-4"})}},i=(n,d)=>{const u=(n==="High"?3:n==="Medium"?2:1)*(d==="High"?3:d==="Medium"?2:1);return u>=6?"border-l-red-500 bg-red-50/50 dark:bg-red-900/10":u>=3?"border-l-amber-500 bg-amber-50/50 dark:bg-amber-900/10":"border-l-green-500 bg-green-50/50 dark:bg-green-900/10"};return e.jsxs("div",{className:t("divide-y",l.border.default),children:[s.map(n=>e.jsxs("div",{onClick:()=>r(n),className:t("p-4 cursor-pointer border-l-4 transition-colors group",i(n.probability,n.impact),a===n.id?l.surface.highlight:`hover:${l.surface.highlight}`),children:[e.jsxs("div",{className:"flex justify-between items-start mb-1",children:[e.jsxs("div",{className:t("flex items-center gap-2 text-xs font-bold uppercase tracking-wider",l.text.secondary),children:[o(n.category||"Other"),n.category||"Other"]}),e.jsx(K,{variant:n.status==="Mitigated"?"success":"warning",children:n.status})]}),e.jsx("h4",{className:t("font-bold text-sm mb-1 line-clamp-2",l.text.primary),children:n.title}),e.jsxs("div",{className:t("flex gap-3 text-xs",l.text.secondary),children:[e.jsxs("span",{children:["Prob: ",e.jsx("strong",{className:t(n.probability==="High"?"text-red-600":""),children:n.probability})]}),e.jsxs("span",{children:["Imp: ",e.jsx("strong",{className:t(n.impact==="High"?"text-red-600":""),children:n.impact})]})]})]},n.id)),s.length===0&&e.jsx("div",{className:t("p-8 text-center text-sm italic",l.text.tertiary),children:"No risks identified yet."})]})},Un=({probability:s,impact:a})=>{const{theme:r}=D(),l=(n,d)=>{const m=n*d;return m>=6?"bg-red-500":m>=3?"bg-amber-400":"bg-green-400"},o=s==="High"?3:s==="Medium"?2:1,i=a==="High"?3:a==="Medium"?2:1;return e.jsxs("div",{className:"relative w-full max-w-[240px] aspect-square mx-auto",children:[e.jsx("div",{className:t("absolute -left-6 top-1/2 -translate-y-1/2 -rotate-90 text-xs font-bold uppercase tracking-wide",r.text.secondary),children:"Probability"}),e.jsx("div",{className:"grid grid-rows-3 gap-1 w-full h-full",children:[3,2,1].map(n=>e.jsx("div",{className:"grid grid-cols-3 gap-1",children:[1,2,3].map(d=>e.jsx("div",{className:t("rounded flex items-center justify-center transition-all w-full h-full",l(n,d),n===o&&d===i?"ring-4 ring-white ring-offset-2 shadow-lg scale-105 z-10":"opacity-30"),children:n===o&&d===i&&e.jsx("div",{className:"w-3 h-3 bg-slate-900 rounded-full shadow-sm"})},`${n}-${d}`))},n))}),e.jsx("div",{className:t("text-center mt-2 text-xs font-bold uppercase tracking-wide",r.text.secondary),children:"Impact"})]})},Gn=({risk:s,onUpdate:a,onDelete:r,onClose:l})=>{const{theme:o}=D(),[i,n]=c.useState(!1),d=async()=>{if(!s.title)return;n(!0);const m=`Suggest a legal mitigation strategy for the following risk in a litigation case:
      Risk: ${s.title}
      Description: ${s.description}
      Category: ${s.category}
      Severity: ${s.probability} Probability, ${s.impact} Impact.`,f=await qe.generateDraft(m,"Mitigation Plan");a({...s,mitigationPlan:f}),n(!1)};return e.jsxs("div",{className:"h-full flex flex-col animate-in slide-in-from-right duration-200",children:[e.jsxs("div",{className:t("p-6 border-b flex justify-between items-center sticky top-0 z-10",o.surface.default,o.border.default),children:[e.jsxs("div",{children:[e.jsx("h3",{className:t("font-bold text-lg",o.text.primary),children:"Risk Assessment"}),e.jsxs("p",{className:t("text-xs font-mono",o.text.tertiary),children:["ID: ",s.id]})]}),e.jsx("div",{className:"flex gap-2",children:e.jsx(_,{variant:"ghost",size:"sm",onClick:l,children:e.jsx(Se,{className:"h-4 w-4"})})})]}),e.jsxs("div",{className:"flex-1 overflow-y-auto p-6 space-y-8",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsx(Z,{label:"Risk Title",value:s.title,onChange:m=>a({...s,title:m.target.value})}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:t("block text-xs font-semibold uppercase mb-1.5",o.text.secondary),children:"Category"}),e.jsxs("select",{title:"Select risk category",className:t("w-full px-3 py-2 border rounded-md text-sm",o.surface.default,o.border.default,o.text.primary),value:s.category,onChange:m=>a({...s,category:m.target.value}),children:[e.jsx("option",{value:"Legal",children:"Legal"}),e.jsx("option",{value:"Financial",children:"Financial"}),e.jsx("option",{value:"Reputational",children:"Reputational"}),e.jsx("option",{value:"Operational",children:"Operational"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:t("block text-xs font-semibold uppercase mb-1.5",o.text.secondary),children:"Status"}),e.jsxs("select",{title:"Select risk status",className:t("w-full px-3 py-2 border rounded-md text-sm",o.surface.default,o.border.default,o.text.primary),value:s.status,onChange:m=>a({...s,status:m.target.value}),children:[e.jsx("option",{value:Le.IDENTIFIED,children:"Identified"}),e.jsx("option",{value:Le.OPEN,children:"Open"}),e.jsx("option",{value:Le.MONITORING,children:"Monitoring"}),e.jsx("option",{value:Le.MITIGATED,children:"Mitigated"}),e.jsx("option",{value:Le.CLOSED,children:"Closed"})]})]})]}),e.jsx(Ge,{label:"Description",rows:3,value:s.description,onChange:m=>a({...s,description:m.target.value})})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8 items-start",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:t("block text-xs font-semibold uppercase mb-1.5",o.text.secondary),children:"Probability"}),e.jsx("div",{className:"flex gap-2",children:[Qe.LOW,Qe.MEDIUM,Qe.HIGH].map(m=>e.jsx("button",{onClick:()=>a({...s,probability:m}),className:t("flex-1 py-2 text-xs font-bold rounded border transition-all",s.probability===m?t(o.action.primary.bg,"text-white",o.action.primary.border,"shadow-md"):t(o.surface.default,o.text.secondary,o.border.default,`hover:${o.surface.highlight}`)),children:m},m))})]}),e.jsxs("div",{children:[e.jsx("label",{className:t("block text-xs font-semibold uppercase mb-1.5",o.text.secondary),children:"Impact"}),e.jsx("div",{className:"flex gap-2",children:[Ye.LOW,Ye.MEDIUM,Ye.HIGH].map(m=>e.jsx("button",{onClick:()=>a({...s,impact:m}),className:t("flex-1 py-2 text-xs font-bold rounded border transition-all",s.impact===m?t(o.action.primary.bg,"text-white",o.action.primary.border,"shadow-md"):t(o.surface.default,o.text.secondary,o.border.default,`hover:${o.surface.highlight}`)),children:m},m))})]})]}),e.jsx("div",{className:t("flex justify-center p-4 rounded-lg border shadow-sm",o.surface.default,o.border.default),children:e.jsx(Un,{probability:s.probability,impact:s.impact})})]}),e.jsxs("div",{className:t("space-y-3 pt-4 border-t",o.border.default),children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h4",{className:t("font-bold text-sm",o.text.primary),children:"Mitigation Strategy"}),e.jsx(_,{size:"sm",variant:"outline",icon:oe,onClick:d,disabled:i,children:i?"Generating...":"AI Suggest"})]}),e.jsx("textarea",{className:t("w-full p-4 border rounded-lg text-sm leading-relaxed h-40 focus:ring-2 focus:ring-blue-500 outline-none resize-none",o.surface.default,o.border.default,o.text.primary),placeholder:"Outline steps to reduce probability or impact...",value:s.mitigationPlan||"",onChange:m=>a({...s,mitigationPlan:m.target.value})})]})]}),e.jsxs("div",{className:t("p-4 border-t flex justify-between items-center",o.surface.highlight,o.border.default),children:[e.jsx("button",{onClick:()=>r(s.id),title:"Delete risk",className:"text-red-600 hover:bg-red-50 p-2 rounded transition-colors",children:e.jsx(Ze,{className:"h-5 w-5"})}),e.jsx(_,{variant:"primary",icon:es,onClick:()=>{l()},children:"Save Changes"})]})]})},qn=({caseData:s})=>{const{theme:a}=D(),{openWindow:r,closeWindow:l}=_e(),{data:o=[],isLoading:i}=F(["risks",s.id],()=>I.risks.getByCaseId(s.id)),{mutate:n}=le(I.risks.add,{invalidateKeys:[["risks",s.id]]}),{mutate:d}=le(h=>I.risks.update(h.id,h),{invalidateKeys:[["risks",s.id]],onSuccess:h=>l(`risk-detail-${h.id}`)}),{mutate:m}=le(I.risks.delete,{invalidateKeys:[["risks",s.id]],onSuccess:(h,j)=>l(`risk-detail-${j}`)}),f=()=>{const h={id:`risk-${Date.now()}`,caseId:s.id,title:"New Risk",description:"",category:"Legal",probability:Qe.MEDIUM,impact:Ye.MEDIUM,status:Le.IDENTIFIED,dateIdentified:new Date().toISOString().split("T")[0],lastUpdated:new Date().toISOString().split("T")[0]};n(h),u(h)},u=h=>{const j=`risk-detail-${h.id}`;r(j,`Risk: ${h.title}`,e.jsx(Gn,{risk:h,onUpdate:d,onDelete:m,onClose:()=>l(j)}))},x=o.filter(h=>h.probability==="High"||h.impact==="High").length,p=o.length*15e4;return i?e.jsx("div",{className:"flex justify-center p-12",children:e.jsx(re,{className:t("animate-spin",a.text.link)})}):e.jsxs("div",{className:"flex flex-col h-full space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 shrink-0",children:[e.jsx(ne,{label:"Total Risks Identified",value:o.length,icon:Me,className:"border-l-4 border-l-blue-500"}),e.jsx(ne,{label:"Critical Exposure",value:x,icon:be,trend:"Requires Action",trendUp:!1,className:"border-l-4 border-l-red-500"}),e.jsx(ne,{label:"Est. Financial Impact",value:`$${(p/1e3).toFixed(0)}k`,icon:bs,className:"border-l-4 border-l-amber-500"})]}),e.jsxs("div",{className:t("flex-1 flex flex-col rounded-lg border shadow-sm overflow-hidden min-h-0",a.surface.default,a.border.default),children:[e.jsxs("div",{className:t("p-4 border-b flex justify-between items-center",a.border.default,a.surface.highlight),children:[e.jsx("h3",{className:t("font-bold text-sm uppercase tracking-wide",a.text.secondary),children:"Risk Register"}),e.jsx(_,{size:"sm",variant:"ghost",icon:J,onClick:f,children:"Add"})]}),e.jsx("div",{className:"flex-1 overflow-y-auto",children:e.jsx(Hn,{risks:o,onSelect:u})})]})]})},_s=({title:s,items:a,type:r,icon:l,colorClass:o,evidence:i=[],citations:n=[],onEdit:d,onDelete:m})=>{const{theme:f}=D();return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(l,{className:t("h-5 w-5",o)}),e.jsx("h4",{className:t("font-bold uppercase text-sm tracking-wide",f.text.primary),children:s}),e.jsx("span",{className:t("text-xs px-2 py-0.5 rounded-full",f.surface.highlight,f.text.secondary),children:a.length})]}),r==="Citation"?e.jsxs("div",{className:t("rounded-lg border shadow-sm overflow-hidden",f.surface.default,f.border.default),children:[a.map(u=>e.jsxs("div",{className:t("p-3 border-b last:border-0 transition-colors group relative",f.border.default,`hover:${f.surface.highlight}`),children:[e.jsxs("div",{className:"flex justify-between items-start mb-1",children:[e.jsxs("div",{className:"flex items-center flex-1",children:[u.shepardsSignal==="Positive"&&e.jsx(ie,{className:"h-3 w-3 text-green-500 mr-1.5"}),u.shepardsSignal==="Caution"&&e.jsx(be,{className:t("h-3 w-3 mr-1.5",f.status.warning.text)}),u.shepardsSignal==="Negative"&&e.jsx(Se,{className:"h-3 w-3 text-red-500 mr-1.5"}),e.jsx("span",{className:"font-bold text-sm text-blue-700 hover:underline cursor-pointer",children:u.citation})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[d&&e.jsx(_,{size:"sm",variant:"ghost",onClick:x=>{x.stopPropagation(),d(u)},className:"h-6 px-2 text-[10px]",children:"Edit"}),m&&e.jsx(_,{size:"sm",variant:"ghost",onClick:x=>{x.stopPropagation(),m(u.id)},className:"h-6 px-2 text-[10px] text-red-600 hover:text-red-700",children:"Delete"}),e.jsx(K,{variant:"neutral",children:u.type})]})]}),e.jsx("p",{className:t("text-xs font-medium mb-1",f.text.primary),children:u.title}),e.jsx("p",{className:t("text-xs line-clamp-2",f.text.secondary),children:u.description})]},u.id)),a.length===0&&e.jsx("div",{className:t("text-center p-8 text-sm",f.text.tertiary),children:"No citations linked."})]}):e.jsxs(e.Fragment,{children:[a.map(u=>{const x=u;return e.jsx(ye,{noPadding:!0,className:`border-l-4 hover:shadow-md transition-shadow cursor-pointer ${r==="Argument"?"border-l-blue-500":"border-l-amber-500"}`,children:e.jsxs("div",{className:"p-4",children:[e.jsxs("div",{className:"flex justify-between items-start mb-2",children:[e.jsx("div",{className:"flex-1",children:e.jsx("h5",{className:t("font-bold text-sm",f.text.primary),children:x.title})}),e.jsxs("div",{className:"flex items-center gap-2",children:[d&&e.jsx(_,{size:"sm",variant:"ghost",onClick:p=>{p.stopPropagation(),d(x)},className:"h-7 px-2 text-xs",children:"Edit"}),m&&e.jsx(_,{size:"sm",variant:"ghost",onClick:p=>{p.stopPropagation(),m(x.id)},className:"h-7 px-2 text-xs text-red-600 hover:text-red-700",children:"Delete"}),e.jsx(K,{variant:x.status==="Active"||x.status==="Asserted"?"success":"neutral",children:x.status})]})]}),e.jsx("p",{className:t("text-xs line-clamp-3 mb-3",f.text.secondary),children:x.description}),r==="Argument"&&e.jsxs(e.Fragment,{children:[e.jsx(ta,{value:x.strength,label:"Strength",type:"strength"}),e.jsx("div",{className:t("mt-3 pt-3 border-t flex flex-col gap-2",f.border.default),children:e.jsxs("div",{className:"flex gap-1 flex-wrap",children:[x.relatedCitationIds.map(p=>{const h=n.find(j=>j.id===p);return h?e.jsxs("span",{className:t("text-[10px] px-1.5 py-0.5 rounded flex items-center border",f.surface.highlight,f.border.default,f.text.secondary),children:[e.jsx(as,{className:"h-3 w-3 mr-1"})," ",h.citation]},p):null}),x.relatedEvidenceIds?.map(p=>{const h=i.find(j=>j.id===p);return h?e.jsxs("span",{className:"text-[10px] bg-purple-50 border border-purple-100 px-1.5 py-0.5 rounded text-purple-700 flex items-center",children:[e.jsx(Vs,{className:"h-3 w-3 mr-1"})," ",h.title]},p):null})]})})]}),r==="Defense"&&e.jsxs("div",{className:t("flex justify-between items-center pt-2 border-t",f.border.default),children:[e.jsx("span",{className:t("text-[10px] uppercase font-bold",f.text.tertiary),children:x.type}),e.jsx("button",{"aria-label":"View external defense details",className:t("transition-colors",f.text.tertiary,`hover:${f.text.link}`),children:e.jsx(fs,{className:"h-3 w-3"})})]})]})},x.id)}),a.length===0&&e.jsxs("div",{className:t("text-center p-8 border-2 border-dashed rounded-lg text-sm",f.border.default,f.text.tertiary),children:["No ",s.toLowerCase()," added."]})]})]})},kt=({caseId:s,citations:a=[],arguments:r=[],defenses:l=[],evidence:o=[]})=>{const{theme:i}=D(),{success:n,error:d}=De(),[m,f]=c.useState(a),[u,x]=c.useState(r),[p,h]=c.useState(l),j=hs(),[N,y]=c.useState("Citation"),[v,S]=c.useState({}),[C,b]=c.useState(null),[w,g]=c.useState(!1),[T,E]=c.useState(null),{mutate:L,isLoading:W}=le(async({type:P,item:O})=>{const $={...O,type:P,caseId:s,userId:"current-user",createdAt:O.createdAt||new Date().toISOString(),updatedAt:new Date().toISOString()};return C?await I.strategy.update(O.id,$):await I.strategy.add($)},{onSuccess:(P,O)=>{n(`${O.type} ${C?"updated":"saved"} successfully`),Y.invalidate(U.caseStrategy.detail(s))},onError:P=>{d(`Failed to save: ${P.message}`)}}),{mutate:X}=le(async({type:P,id:O})=>(await I.strategy.delete(O,P),{type:P,id:O}),{onSuccess:P=>{n(`${P.type} deleted successfully`),Y.invalidate(U.caseStrategy.detail(s)),P.type==="Citation"?f(m.filter(O=>O.id!==P.id)):P.type==="Argument"?x(u.filter(O=>O.id!==P.id)):h(p.filter(O=>O.id!==P.id)),g(!1),E(null)},onError:P=>{d(`Failed to delete: ${P.message}`)}}),me=()=>{const P=C?.id||crypto.randomUUID();let O;if(N==="Citation"){const $=v;if(!$.title&&!$.citation){d("Title/Citation is required");return}O={...$,id:P,citation:$.citation||$.title||"",relevance:$.relevance||"Medium"},f(C?m.map(H=>H.id===P?O:H):[...m,O])}else if(N==="Argument"){const $=v;if(!$.title){d("Title is required");return}O={...$,id:P,title:$.title,strength:$.strength||50,status:$.status||"Draft",relatedCitationIds:$.relatedCitationIds||[],relatedEvidenceIds:$.relatedEvidenceIds||[]},x(C?u.map(H=>H.id===P?O:H):[...u,O])}else{const $=v;if(!$.title){d("Title is required");return}O={...$,id:P,title:$.title,status:$.status||"Asserted",type:$.type||"Affirmative"},h(C?p.map(H=>H.id===P?O:H):[...p,O])}L({type:N,item:O}),j.close(),S({}),b(null)},M=(P,O)=>{y(P),b(O),S(O),j.open()},R=(P,O)=>{E({type:P,id:O}),g(!0)},te=()=>{T&&X(T)};return e.jsxs("div",{className:"space-y-6 animate-fade-in",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h3",{className:t("text-xl font-bold",i.text.primary),children:"Legal Strategy & Authority"}),e.jsx("p",{className:t("text-sm",i.text.secondary),children:"Manage case law, affirmative arguments, and defenses."})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(_,{variant:"outline",size:"sm",onClick:()=>{y("Citation"),j.open()},icon:J,children:"Citation"}),e.jsx(_,{variant:"outline",size:"sm",onClick:()=>{y("Argument"),j.open()},icon:J,children:"Argument"}),e.jsx(_,{variant:"outline",size:"sm",onClick:()=>{y("Defense"),j.open()},icon:J,children:"Defense"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[e.jsx(_s,{title:"Arguments",items:u,type:"Argument",icon:ze,colorClass:i.text.link,evidence:o,citations:m,onEdit:P=>M("Argument",P),onDelete:P=>R("Argument",P)}),e.jsx(_s,{title:"Defenses",items:p,type:"Defense",icon:Pe,colorClass:i.status.warning.text,onEdit:P=>M("Defense",P),onDelete:P=>R("Defense",P)}),e.jsx(_s,{title:"Authority",items:m,type:"Citation",icon:Ee,colorClass:i.action.primary.text,onEdit:P=>M("Citation",P),onDelete:P=>R("Citation",P)})]}),e.jsx(Ne,{isOpen:j.isOpen,onClose:()=>{j.close(),b(null),S({})},title:`${C?"Edit":"Add"} ${N}`,children:e.jsxs("div",{className:"p-6 space-y-4",children:[e.jsx(Z,{label:"Title / Citation",placeholder:N==="Citation"?"e.g. 123 U.S. 456":"Title",value:v.title||"",onChange:P=>S({...v,title:P.target.value,citation:P.target.value})}),N==="Defense"&&e.jsxs("div",{children:[e.jsx("label",{className:t("block text-xs font-semibold uppercase mb-1.5",i.text.secondary),children:"Type"}),e.jsxs("select",{className:t("w-full px-3 py-2 border rounded-md text-sm",i.surface.default,i.border.default),onChange:P=>S({...v,type:P.target.value}),"aria-label":"Defense Type",children:[e.jsx("option",{value:"Affirmative",children:"Affirmative"}),e.jsx("option",{value:"Procedural",children:"Procedural"}),e.jsx("option",{value:"Factual",children:"Factual"})]})]}),e.jsx(Ge,{label:"Description",rows:4,value:v.description||"",onChange:P=>S({...v,description:P.target.value})}),e.jsxs("div",{className:t("flex justify-end gap-2 pt-4 border-t",i.border.default),children:[e.jsx(_,{variant:"ghost",onClick:()=>{j.close(),b(null),S({})},children:"Cancel"}),e.jsx(_,{variant:"primary",onClick:me,disabled:W,children:W?"Saving...":`${C?"Update":"Save"} ${N}`})]})]})}),e.jsx(Ne,{isOpen:w,onClose:()=>g(!1),title:"Confirm Delete",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("p",{className:t("text-sm mb-6",i.text.primary),children:["Are you sure you want to delete this ",T?.type?.toLowerCase(),"? This action cannot be undone."]}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(_,{variant:"ghost",onClick:()=>g(!1),children:"Cancel"}),e.jsx(_,{variant:"primary",onClick:te,className:"bg-red-600 hover:bg-red-700 border-transparent",children:"Delete"})]})]})})]})},Kn=({stages:s,onToggleTask:a,onNavigateToModule:r})=>{const{theme:l}=D(),[o,i]=c.useState(s.find(n=>n.status==="Active")?.id||null);return e.jsx("div",{className:"space-y-6",children:s.map((n,d)=>{const m=o===n.id,f=n.status==="Active";return e.jsxs("div",{className:t("rounded-xl border transition-all duration-300",l.surface.default,f?t(l.action.primary.border,"shadow-md ring-1",l.surface.highlight):l.border.default),children:[e.jsxs("div",{className:t("p-4 flex items-center justify-between cursor-pointer rounded-t-xl transition-colors",`hover:${l.surface.highlight}`),onClick:()=>i(m?null:n.id),children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:`flex items-center justify-center w-8 h-8 rounded-full border-2 text-xs font-bold ${n.status==="Completed"?"bg-green-100 border-green-500 text-green-700":n.status==="Active"?t(l.surface.highlight,l.action.primary.border,l.action.primary.text):`bg-slate-50 ${l.border.default} ${l.text.tertiary}`}`,children:n.status==="Completed"?e.jsx(ie,{className:"h-5 w-5"}):d+1}),e.jsxs("div",{children:[e.jsx("h4",{className:t("font-bold text-lg",f?l.action.primary.text:l.text.primary),children:n.title}),e.jsxs("div",{className:t("flex items-center gap-2 text-xs",l.text.secondary),children:[e.jsx("span",{className:t("px-2 py-0.5 rounded-full",f?t(l.surface.highlight,l.action.primary.text):"bg-slate-100 dark:bg-slate-800"),children:n.status}),e.jsxs("span",{children:["• ",n.tasks.length," tasks"]})]})]})]}),e.jsx("button",{className:l.text.tertiary,children:m?e.jsx(zt,{className:"h-5 w-5"}):e.jsx(ts,{className:"h-5 w-5"})})]}),m&&e.jsxs("div",{className:t("p-4 pt-0 space-y-3 rounded-b-xl border-t",l.surface.highlight,l.border.default),children:[e.jsx("div",{className:"h-2"}),n.tasks.map(u=>e.jsxs("div",{className:t("group relative p-4 rounded-lg border hover:shadow-md transition-all flex flex-col md:flex-row gap-4 items-start md:items-center hover:border-blue-500",l.surface.default,l.border.default),children:[e.jsx("button",{onClick:()=>a(n.id,u.id),title:u.status===ue.COMPLETED?"Mark as incomplete":"Mark as complete",className:t("shrink-0 w-6 h-6 rounded-full border-2 flex items-center justify-center transition-colors hover:border-blue-500",u.status===ue.COMPLETED?"bg-green-500 border-green-500 text-white":"border-slate-300 text-transparent"),children:e.jsx(ie,{className:"h-4 w-4 fill-current"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("h5",{className:t("font-semibold text-sm",u.status===ue.COMPLETED?"text-slate-400 line-through":l.text.primary),children:u.title}),u.priority==="High"&&u.status!==ue.COMPLETED&&e.jsx("span",{className:"bg-red-100 text-red-600 text-[10px] font-bold px-1.5 py-0.5 rounded border border-red-200",children:"HIGH"})]}),u.description&&e.jsx("p",{className:t("text-xs mb-2 line-clamp-1",l.text.secondary),children:u.description}),e.jsxs("div",{className:t("flex flex-wrap items-center gap-4 text-xs",l.text.tertiary),children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(Kt,{name:u.assignee||"Unassigned",size:"sm",className:"w-4 h-4 text-[9px]"})," ",u.assignee||"Unassigned"]}),u.dueDate&&e.jsxs("span",{className:`flex items-center gap-1 ${u.status!==ue.COMPLETED&&new Date(u.dueDate)<new Date?"text-red-500 font-bold":""}`,children:[e.jsx(ce,{className:"h-3 w-3"})," Due: ",u.dueDate]})]})]}),u.relatedModule&&r&&e.jsxs("button",{onClick:()=>r(u.relatedModule),className:"w-full md:w-auto mt-2 md:mt-0 px-3 py-1.5 bg-indigo-50 hover:bg-indigo-100 text-indigo-700 border border-indigo-200 rounded-md text-xs font-bold flex items-center justify-center gap-2 transition-colors whitespace-nowrap",children:[u.actionLabel||"View Module",e.jsx(Ks,{className:"h-3 w-3"})]})]},u.id))]})]},n.id)})})},Jn=()=>{const{theme:s}=D();return e.jsxs("div",{className:"grid grid-cols-1 gap-6",children:[e.jsxs("div",{className:t("p-6 rounded-xl border shadow-sm relative overflow-hidden group",s.surface.default,s.border.default),children:[e.jsx("div",{className:t("absolute top-0 left-0 w-1 h-full",s.status.warning.bg)}),e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:t("p-3 rounded-full",s.surface.highlight,s.status.warning.text),children:e.jsx(Ot,{className:"h-6 w-6"})}),e.jsxs("div",{children:[e.jsx("h4",{className:t("font-bold",s.text.primary),children:"Document Upload Trigger"}),e.jsx("p",{className:t("text-sm mt-1",s.text.secondary),children:'IF new document contains "Motion" THEN create task "Review Motion".'}),e.jsxs("div",{className:"mt-3 flex gap-2",children:[e.jsx("span",{className:t("text-xs px-2 py-1 rounded border",s.surface.highlight,s.border.default,s.text.secondary),children:"Module: Documents"}),e.jsx("span",{className:t("text-xs px-2 py-1 rounded border",s.surface.highlight,s.border.default,s.text.secondary),children:"Module: Workflow"})]})]})]}),e.jsx("div",{className:"h-6 w-11 bg-green-500 rounded-full relative cursor-pointer",children:e.jsx("div",{className:"absolute right-1 top-1 h-4 w-4 bg-white rounded-full shadow-sm"})})]})]}),e.jsxs("div",{className:t("p-6 rounded-xl border shadow-sm relative overflow-hidden group",s.surface.default,s.border.default),children:[e.jsx("div",{className:t("absolute top-0 left-0 w-1 h-full",s.action.primary.bg)}),e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:t("p-3 rounded-full",s.surface.highlight,s.text.link),children:e.jsx(ce,{className:"h-6 w-6"})}),e.jsxs("div",{children:[e.jsx("h4",{className:t("font-bold",s.text.primary),children:"SLA Breach Warning"}),e.jsxs("p",{className:t("text-sm mt-1",s.text.secondary),children:['IF "High Priority" task is overdue ',">"," 24h THEN notify Senior Partner."]}),e.jsx("div",{className:"mt-3 flex gap-2",children:e.jsx("span",{className:t("text-xs px-2 py-1 rounded border",s.surface.highlight,s.border.default,s.text.secondary),children:"Role: Senior Partner"})})]})]}),e.jsx("div",{className:"h-6 w-11 bg-green-500 rounded-full relative cursor-pointer",children:e.jsx("div",{className:"absolute right-1 top-1 h-4 w-4 bg-white rounded-full shadow-sm"})})]})]}),e.jsxs("div",{className:t("border-2 border-dashed rounded-xl p-8 flex flex-col items-center justify-center transition-all cursor-pointer hover:border-blue-500",s.border.default,s.text.tertiary,s.text.link,s.surface.default),children:[e.jsx(J,{className:"h-8 w-8 mb-2"}),e.jsx("span",{className:"font-bold",children:"Create New Automation"})]})]})},Zn=({stages:s,generatingWorkflow:a,onGenerateWorkflow:r,onNavigateToModule:l})=>{const{theme:o}=D(),[i,n]=c.useState("timeline"),[d,m]=c.useState(s),f=(h,j)=>{m(N=>N.map(y=>{if(y.id!==h)return y;const v=y.tasks.map(w=>w.id===j?{...w,status:w.status===ue.COMPLETED?ue.TODO:ue.COMPLETED}:w),S=v.every(w=>w.status===ue.COMPLETED),C=v.some(w=>w.status===ue.IN_PROGRESS);let b=y.status;return S?b="Completed":(C||v.some(w=>w.status===ue.COMPLETED))&&(b="Active"),{...y,tasks:v,status:b}}))},u=d.reduce((h,j)=>h+j.tasks.length,0),x=d.reduce((h,j)=>h+j.tasks.filter(N=>N.status===ue.COMPLETED).length,0),p=u===0?0:Math.round(x/u*100);return e.jsxs("div",{className:"space-y-6 animate-fade-in",children:[e.jsxs("div",{className:t("rounded-xl shadow-sm border p-6 flex flex-col md:flex-row justify-between items-center gap-6",o.surface.default,o.border.default),children:[e.jsxs("div",{className:"w-full md:w-1/3",children:[e.jsx("h3",{className:t("text-lg font-bold mb-1",o.text.primary),children:"Workflow Status"}),e.jsxs("div",{className:t("flex items-center justify-between text-sm mb-2",o.text.secondary),children:[e.jsxs("span",{children:[x," of ",u," Tasks Complete"]}),e.jsxs("span",{className:t("font-bold",o.text.link),children:[p,"%"]})]}),e.jsx("div",{className:t("w-full rounded-full h-2.5",o.surface.highlight),children:e.jsx("div",{className:t("h-2.5 rounded-full transition-all duration-1000 ease-out",o.action.primary.bg),style:{width:`${p}%`}})})]}),e.jsxs("div",{className:"flex gap-3 w-full md:w-auto",children:[e.jsx("button",{onClick:()=>n("timeline"),className:t("flex-1 md:flex-none px-4 py-2 rounded-lg font-medium text-sm transition-colors",i==="timeline"?"bg-slate-900 text-white shadow-lg":t("border",o.surface.default,o.text.secondary,o.border.default,`hover:${o.surface.highlight}`)),children:"Timeline"}),e.jsx("button",{onClick:()=>n("automation"),className:t("flex-1 md:flex-none px-4 py-2 rounded-lg font-medium text-sm transition-colors",i==="automation"?"bg-slate-900 text-white shadow-lg":t("border",o.surface.default,o.text.secondary,o.border.default,`hover:${o.surface.highlight}`)),children:"Automations"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(_,{variant:"outline",icon:as,onClick:()=>alert("Loading Playbook..."),children:"Templates"}),e.jsx(_,{variant:"primary",icon:a?Js:xr,onClick:r,disabled:a,className:"bg-purple-600 hover:bg-purple-700 border-transparent text-white",children:a?"Thinking...":"AI Assist"})]})]}),i==="timeline"?e.jsx(Kn,{stages:d,onToggleTask:f,onNavigateToModule:l}):e.jsx(Jn,{})]})},Yn=({caseId:s})=>{const{theme:a}=D(),{addToast:r}=Dr(),[l,o]=c.useState(!1),[i,n]=c.useState({method:"Phone",result:"Pending",date:Zs()}),{data:d=[],isLoading:m}=F(["conferrals",s],()=>I.collaboration.getConferrals(s)),{mutate:f}=le(I.collaboration.addConferral,{invalidateKeys:[["conferrals",s]],onSuccess:()=>{o(!1),n({method:"Phone",result:"Pending",date:new Date().toISOString().split("T")[0]}),r("Conferral session logged successfully","success")},onError:h=>{const j=h instanceof Error?h.message:"Unknown error";r(`Failed to log conferral session: ${j}`,"error"),console.error("Conferral save error:",h)}}),u=h=>{switch(h){case"Email":return e.jsx(Us,{className:"h-4 w-4"});case"Phone":return e.jsx(Lt,{className:"h-4 w-4"});case"Video Conference":return e.jsx(hr,{className:"h-4 w-4"});default:return e.jsx(de,{className:"h-4 w-4"})}},x=h=>{switch(h){case"Agreed":return e.jsx(K,{variant:"success",children:"Agreed"});case"Impasse":return e.jsx(K,{variant:"error",children:"Impasse"});case"Partial Agreement":return e.jsx(K,{variant:"warning",children:"Partial"});default:return e.jsx(K,{variant:"neutral",children:"Pending"})}},p=()=>{const h={id:`conf-${Date.now()}`,caseId:s,topic:i.topic||"General Conferral",date:i.date||new Date().toISOString().split("T")[0],method:i.method,participants:i.participants||[],notes:i.notes||"",result:i.result||"Pending",nextSteps:i.nextSteps};f(h)};return m?e.jsx("div",{className:"flex justify-center p-12",children:e.jsx(re,{className:t("animate-spin",a.text.link)})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h3",{className:t("font-bold",a.text.primary),children:"Meet & Confer Log"}),e.jsx("p",{className:t("text-sm",a.text.secondary),children:"Track mandatory conferral attempts for motions and discovery disputes."})]}),e.jsx(_,{variant:"primary",icon:J,onClick:()=>o(!0),children:"Log Session"})]}),e.jsxs("div",{className:"space-y-4",children:[d.map(h=>e.jsxs("div",{className:t("p-4 rounded-lg border shadow-sm transition-all hover:border-blue-500",a.surface.default,a.border.default),children:[e.jsxs("div",{className:"flex justify-between items-start mb-2",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:t("p-2 rounded-full",a.surface.highlight,a.text.secondary),children:u(h.method)}),e.jsxs("div",{children:[e.jsx("h4",{className:t("font-bold text-sm",a.text.primary),children:h.topic}),e.jsxs("div",{className:t("flex items-center gap-2 text-xs",a.text.secondary),children:[e.jsx("span",{children:h.date}),e.jsx("span",{children:"•"}),e.jsx("span",{children:h.participants.join(", ")})]})]})]}),x(h.result)]}),e.jsx("div",{className:t("ml-11 mt-2 text-sm p-3 rounded border",a.surface.highlight,a.text.secondary,a.border.subtle),children:h.notes}),h.nextSteps&&e.jsxs("div",{className:t("ml-11 mt-2 flex items-center gap-2 text-xs",a.text.link),children:[e.jsx(ie,{className:"h-3 w-3"}),e.jsxs("span",{className:"font-medium",children:["Next: ",h.nextSteps]})]})]},h.id)),d.length===0&&e.jsxs("div",{className:t("text-center py-12 border-2 border-dashed rounded-lg",a.border.default,a.text.tertiary),children:[e.jsx(de,{className:"h-12 w-12 mx-auto mb-2 opacity-20"}),e.jsx("p",{children:"No conferral sessions recorded."})]})]}),e.jsx(Ne,{isOpen:l,onClose:()=>o(!1),title:"Log Meet & Confer Session",children:e.jsxs("div",{className:"p-6 space-y-4",children:[e.jsx(Z,{label:"Subject / Topic",placeholder:"e.g. Discovery Dispute regarding RFP Set 2",value:i.topic||"",onChange:h=>n({...i,topic:h.target.value})}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(Z,{label:"Date",type:"date",value:i.date,onChange:h=>n({...i,date:h.target.value})}),e.jsxs("div",{children:[e.jsx("label",{className:t("block text-xs font-semibold uppercase mb-1.5",a.text.secondary),children:"Method"}),e.jsxs("select",{title:"Select conferral method",className:t("w-full px-3 py-2 border rounded-md text-sm",a.surface.input,a.border.default,a.text.primary),value:i.method,onChange:h=>n({...i,method:h.target.value}),children:[e.jsx("option",{children:"Phone"}),e.jsx("option",{children:"Email"}),e.jsx("option",{children:"Video Conference"}),e.jsx("option",{children:"In-Person"})]})]})]}),e.jsx(Z,{label:"Participants (Opposing Counsel)",placeholder:"e.g. Robert Smith, Jane Doe",value:i.participants?.join(", ")||"",onChange:h=>n({...i,participants:h.target.value.split(", ")})}),e.jsx(Ge,{label:"Discussion Notes",placeholder:"Summary of what was discussed...",rows:4,value:i.notes||"",onChange:h=>n({...i,notes:h.target.value})}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:t("block text-xs font-semibold uppercase mb-1.5",a.text.secondary),children:"Outcome"}),e.jsxs("select",{title:"Select conferral outcome",className:t("w-full px-3 py-2 border rounded-md text-sm",a.surface.input,a.border.default,a.text.primary),value:i.result,onChange:h=>n({...i,result:h.target.value}),children:[e.jsx("option",{value:"Pending",children:"Pending"}),e.jsx("option",{value:"Agreed",children:"Agreed"}),e.jsx("option",{value:"Partial Agreement",children:"Partial Agreement"}),e.jsx("option",{value:"Impasse",children:"Impasse (Disagreement)"})]})]}),e.jsx(Z,{label:"Next Steps",placeholder:"e.g. File Motion, Send Letter",value:i.nextSteps||"",onChange:h=>n({...i,nextSteps:h.target.value})})]}),e.jsxs("div",{className:t("pt-4 flex justify-end gap-2 border-t mt-4",a.border.subtle),children:[e.jsx(_,{variant:"secondary",onClick:()=>o(!1),children:"Cancel"}),e.jsx(_,{variant:"primary",onClick:p,children:"Log Session"})]})]})})]})},Qn=({caseId:s})=>{const{theme:a}=D(),[r,l]=c.useState(null),[o,i]=c.useState(""),{data:n=[],isLoading:d}=F(["joint-plans",s],()=>I.collaboration.getPlans(s)),m=n.length>0?n[0]:null,{mutate:f}=le(I.collaboration.updatePlan,{invalidateKeys:[["joint-plans",s]]}),u=h=>{l(h.id),i(h.content)},x=async()=>{if(!m||!r)return;const h=m.sections.map(N=>N.id===r?{...N,content:o}:N),j={...m,sections:h};f(j),l(null)},p=async(h,j)=>{if(!m)return;const N=m.sections.map(v=>v.id===h?{...v,status:j}:v),y={...m,sections:N};f(y)};return d?e.jsx("div",{className:"flex justify-center p-12",children:e.jsx(re,{className:t("animate-spin",a.text.link)})}):m?e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:t("flex justify-between items-center p-4 rounded-lg border shadow-sm",a.surface.default,a.border.default),children:[e.jsxs("div",{children:[e.jsx("h3",{className:t("font-bold",a.text.primary),children:m.title}),e.jsxs("p",{className:t("text-xs",a.text.secondary),children:["Last updated: ",m.lastUpdated]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(K,{variant:"info",children:m.status}),e.jsx(_,{variant:"outline",size:"sm",icon:$e,children:"Export PDF"})]})]}),e.jsx("div",{className:"space-y-4",children:m.sections.map(h=>e.jsxs(ye,{noPadding:!0,className:"overflow-visible",children:[e.jsxs("div",{className:t("p-4 border-b flex justify-between items-center rounded-t-lg",a.surface.highlight,a.border.default),children:[e.jsx("h4",{className:t("font-bold text-sm",a.text.primary),children:h.title}),e.jsxs("div",{className:"flex items-center gap-2",children:[h.status==="Agreed"&&e.jsxs("span",{className:"text-xs font-bold text-green-600 flex items-center",children:[e.jsx(ie,{className:"h-3 w-3 mr-1"})," Agreed"]}),h.status==="Disputed"&&e.jsxs("span",{className:"text-xs font-bold text-red-600 flex items-center",children:[e.jsx(je,{className:"h-3 w-3 mr-1"})," Disputed"]}),e.jsx("div",{className:t("h-4 w-px mx-1",a.border.default)}),e.jsxs("div",{className:"flex gap-1",children:[e.jsx("button",{onClick:()=>p(h.id,"Agreed"),className:`p-1 rounded hover:bg-green-100 ${h.status==="Agreed"?"text-green-600 bg-green-50":"text-slate-400"}`,title:"Mark Agreed",children:e.jsx(ie,{className:"h-4 w-4"})}),e.jsx("button",{onClick:()=>p(h.id,"Disputed"),className:`p-1 rounded hover:bg-red-100 ${h.status==="Disputed"?"text-red-600 bg-red-50":"text-slate-400"}`,title:"Mark Disputed",children:e.jsx(je,{className:"h-4 w-4"})})]})]})]}),e.jsxs("div",{className:"p-4",children:[r===h.id?e.jsxs("div",{children:[e.jsx("textarea",{className:t("w-full p-3 border rounded-md text-sm outline-none focus:ring-2 focus:ring-blue-100 min-h-[100px]",a.border.default,a.surface.default,a.text.primary),value:o,onChange:j=>i(j.target.value),placeholder:"Enter section content..."}),e.jsxs("div",{className:"flex justify-end gap-2 mt-2",children:[e.jsx(_,{size:"sm",variant:"ghost",onClick:()=>l(null),children:"Cancel"}),e.jsx(_,{size:"sm",variant:"primary",icon:es,onClick:x,children:"Save"})]})]}):e.jsxs("div",{className:"group relative",children:[e.jsx("p",{className:t("text-sm whitespace-pre-wrap leading-relaxed",a.text.secondary),children:h.content}),e.jsx("button",{onClick:()=>u(h),title:"Edit section",className:t("absolute top-0 right-0 opacity-0 group-hover:opacity-100 p-1 rounded transition-opacity",a.text.primary,`hover:${a.primary.light}`),children:e.jsx(Mt,{className:"h-4 w-4"})})]}),h.opposingComments&&e.jsxs("div",{className:"mt-4 p-3 bg-red-50 border border-red-100 rounded text-xs text-red-800 flex items-start",children:[e.jsx(je,{className:"h-4 w-4 mr-2 shrink-0 mt-0.5"}),e.jsxs("div",{children:[e.jsx("span",{className:"font-bold block mb-1",children:"Opposing Counsel Comment:"}),h.opposingComments]})]})]})]},h.id))})]}):e.jsxs("div",{className:t("flex flex-col items-center justify-center p-12 border-2 border-dashed rounded-lg",a.surface.highlight,a.border.default,a.text.tertiary),children:[e.jsx(Q,{className:"h-12 w-12 mb-3 opacity-20"}),e.jsx("p",{children:"No joint discovery plans active."}),e.jsx(_,{variant:"outline",className:"mt-4",onClick:()=>alert("Start New Plan"),children:"Start Rule 26(f) Report"})]})},Xn=({caseId:s})=>{const{theme:a}=D(),[r,l]=c.useState("conferral"),{data:o=[],isLoading:i}=F(["stipulations","all"],I.collaboration.getStipulations,{enabled:r==="stipulations"});return e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-6 h-full",children:[e.jsxs("div",{className:"lg:col-span-1 space-y-2",children:[e.jsxs("button",{onClick:()=>l("conferral"),className:t("w-full text-left p-4 rounded-lg border transition-all flex items-center gap-3",r==="conferral"?t(a.primary.light,a.primary.text,a.primary.border,"shadow-sm"):t(a.surface.default,a.border.default,a.text.secondary,`hover:${a.surface.highlight}`)),children:[e.jsx(de,{className:"h-5 w-5"}),e.jsxs("div",{children:[e.jsx("span",{className:"block font-bold text-sm",children:"Meet & Confer"}),e.jsx("span",{className:"text-xs opacity-80",children:"Track compliance logs"})]})]}),e.jsxs("button",{onClick:()=>l("plans"),className:t("w-full text-left p-4 rounded-lg border transition-all flex items-center gap-3",r==="plans"?t(a.primary.light,a.primary.text,a.primary.border,"shadow-sm"):t(a.surface.default,a.border.default,a.text.secondary,`hover:${a.surface.highlight}`)),children:[e.jsx(Q,{className:"h-5 w-5"}),e.jsxs("div",{children:[e.jsx("span",{className:"block font-bold text-sm",children:"Joint Discovery Plans"}),e.jsx("span",{className:"text-xs opacity-80",children:"Rule 26(f) Reports"})]})]}),e.jsxs("button",{onClick:()=>l("stipulations"),className:t("w-full text-left p-4 rounded-lg border transition-all flex items-center gap-3",r==="stipulations"?t(a.primary.light,a.primary.text,a.primary.border,"shadow-sm"):t(a.surface.default,a.border.default,a.text.secondary,`hover:${a.surface.highlight}`)),children:[e.jsx(fr,{className:"h-5 w-5"}),e.jsxs("div",{children:[e.jsx("span",{className:"block font-bold text-sm",children:"Stipulations"}),e.jsx("span",{className:"text-xs opacity-80",children:"Deadline negotiation"})]})]})]}),e.jsxs("div",{className:"lg:col-span-3",children:[r==="conferral"&&e.jsx(Yn,{caseId:s}),r==="plans"&&e.jsx(Qn,{caseId:s}),r==="stipulations"&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h3",{className:t("font-bold",a.text.primary),children:"Stipulation Requests"}),e.jsx(_,{variant:"primary",icon:ss,children:"Propose Stipulation"})]}),i?e.jsx("div",{className:"flex justify-center p-12",children:e.jsx(re,{className:t("animate-spin",a.text.link)})}):o.map(n=>e.jsxs(ye,{className:"border-l-4 border-l-amber-500",children:[e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsx("h4",{className:t("font-bold",a.text.primary),children:n.title}),e.jsxs("p",{className:t("text-sm mt-1",a.text.secondary),children:["Requested by: ",n.requestingParty]}),e.jsxs("p",{className:t("text-sm",a.text.secondary),children:["Reason: ",n.reason]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:t("text-xs font-bold uppercase mb-1",a.text.tertiary),children:"Proposed Date"}),e.jsx("div",{className:t("text-lg font-mono font-bold",a.text.primary),children:n.proposedDate})]})]}),e.jsxs("div",{className:t("mt-4 pt-4 border-t flex gap-3",a.border.subtle),children:[e.jsx(_,{size:"sm",variant:"primary",className:t("bg-green-600 hover:bg-green-700 border-transparent",a.text.inverse),children:"Accept"}),e.jsx(_,{size:"sm",variant:"danger",children:"Reject"}),e.jsx(_,{size:"sm",variant:"secondary",children:"Counter-Propose"})]})]},n.id)),!i&&o.length===0&&e.jsx("div",{className:"text-center py-12 text-slate-400 italic border-2 border-dashed rounded-lg",children:"No pending stipulations."})]})]})]})},eo=({motions:s,onTaskClick:a})=>{const{theme:r}=D(),l=Array.isArray(s)?s:[],o=n=>{switch(n){case"Draft":return"neutral";case"Filed":return"info";case"Hearing Set":return"warning";case"Decided":return"success";default:return"neutral"}},i=n=>{switch(n){case"Agreed":return e.jsx("span",{className:"text-[10px] bg-green-100 text-green-700 px-2 py-0.5 rounded font-bold border border-green-200",children:"Agreed"});case"Impasse":return e.jsx("span",{className:"text-[10px] bg-red-100 text-red-700 px-2 py-0.5 rounded font-bold border border-red-200",children:"Impasse"});case"Scheduled":return e.jsx("span",{className:"text-[10px] bg-blue-100 text-blue-700 px-2 py-0.5 rounded font-bold border border-blue-200",children:"Scheduled"});default:return e.jsx("span",{className:"text-[10px] bg-amber-50 text-amber-700 px-2 py-0.5 rounded font-bold border border-amber-200",children:"Required"})}};return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"hidden md:block",children:e.jsxs(We,{children:[e.jsxs(He,{children:[e.jsx(B,{children:"Motion Title"}),e.jsx(B,{children:"Type"}),e.jsx(B,{children:"Status"}),e.jsx(B,{children:"Hearing"}),e.jsx(B,{children:"Rules"}),e.jsx(B,{children:"Meet & Confer"}),e.jsx(B,{className:"text-right",children:"Actions"})]}),e.jsxs(Ue,{children:[l.map(n=>e.jsxs(Ie,{children:[e.jsxs(V,{className:t("font-medium flex items-center",r.text.primary),children:[e.jsx(ve,{className:t("h-4 w-4 mr-2",r.text.tertiary)}),e.jsxs("div",{children:[n.title,n.documents&&n.documents.length>0&&e.jsxs("div",{className:t("text-[10px] flex items-center mt-0.5",r.text.link),children:[e.jsx(Q,{className:"h-3 w-3 mr-1"})," ",n.documents.length," Exhibits Linked"]})]})]}),e.jsx(V,{children:n.type}),e.jsx(V,{children:e.jsx(K,{variant:o(n.status),children:n.status})}),e.jsx(V,{children:n.hearingDate?e.jsxs("span",{className:"flex items-center text-red-600 font-medium text-xs",children:[e.jsx(pe,{className:"h-3 w-3 mr-1"})," ",n.hearingDate]}):"-"}),e.jsx(V,{children:e.jsx("div",{className:"flex flex-wrap gap-1 max-w-[150px]",children:n.linkedRules&&n.linkedRules.length>0?n.linkedRules.map(d=>e.jsx("span",{className:t("text-[9px] border px-1 rounded",r.surface.highlight,r.text.secondary,r.border.default),children:d},d)):"-"})}),e.jsx(V,{children:e.jsxs("div",{className:"flex flex-col gap-1",children:[i(n.conferralStatus),e.jsxs("button",{className:t("text-[10px] hover:underline flex items-center",r.text.link),children:[e.jsx(qs,{className:"h-3 w-3 mr-1"})," Log Session"]})]})}),e.jsx(V,{className:"text-right",children:e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(_,{size:"sm",variant:"ghost",className:"text-indigo-600",onClick:()=>a(n),icon:rt,children:"To Workflow"}),e.jsx(_,{size:"sm",variant:"ghost",className:r.text.link,children:"Details"})]})})]},n.id)),s.length===0&&e.jsx(Ie,{children:e.jsx(V,{colSpan:7,className:t("text-center py-8 italic",r.text.tertiary),children:"No active motions."})})]})]})}),e.jsxs("div",{className:"md:hidden space-y-4",children:[l.map(n=>e.jsxs("div",{className:t("p-4 rounded-lg shadow-sm border",r.surface.default,r.border.default),children:[e.jsxs("div",{className:"flex justify-between items-start mb-2",children:[e.jsxs("h4",{className:t("font-bold text-sm flex items-center gap-2",r.text.primary),children:[e.jsx(ve,{className:t("h-4 w-4",r.text.link)}),n.title]}),e.jsx(K,{variant:o(n.status),children:n.status})]}),e.jsxs("div",{className:t("text-xs mb-3",r.text.secondary),children:[n.type," • Filed: ",n.filingDate||"Draft"]}),e.jsx("div",{className:t("flex justify-between items-center mb-3 p-2 rounded",r.surface.highlight),children:e.jsxs("div",{className:"flex items-center text-xs",children:[e.jsx(de,{className:t("h-3 w-3 mr-1",r.text.tertiary)}),e.jsx("span",{className:t("mr-2",r.text.secondary),children:"Conferral:"}),i(n.conferralStatus)]})}),n.hearingDate&&e.jsxs("div",{className:t("p-3 rounded border space-y-2 mb-3",r.surface.highlight,r.border.subtle),children:[e.jsxs("div",{className:"flex items-center justify-between text-xs",children:[e.jsxs("span",{className:t("font-medium flex items-center",r.text.secondary),children:[e.jsx(pe,{className:"h-3 w-3 mr-1"})," Hearing"]}),e.jsx("span",{className:t("font-bold",r.text.primary),children:n.hearingDate})]}),e.jsxs("div",{className:"flex items-center justify-between text-xs",children:[e.jsx("span",{className:r.text.secondary,children:"Opposition Due"}),e.jsx("span",{className:t("font-mono",r.text.primary),children:n.oppositionDueDate})]})]}),e.jsxs("div",{className:t("flex justify-end gap-2 pt-2 border-t",r.border.subtle),children:[e.jsx(_,{size:"sm",variant:"outline",className:"flex-1",icon:rt,onClick:()=>a(n),children:"To Workflow"}),e.jsx(_,{size:"sm",variant:"outline",className:"flex-1",children:"Details"})]})]},n.id)),l.length===0&&e.jsx("div",{className:t("text-center py-8 italic rounded-lg",r.surface.highlight,r.text.tertiary),children:"No active motions."})]})]})},so=({isOpen:s,onClose:a,onSave:r,documents:l,initialMotion:o,isOrbital:i})=>{const{theme:n}=D(),[d,m]=c.useState(o),[f,u]=c.useState(!1);c.useEffect(()=>{m(o)},[o]),c.useEffect(()=>{if(d.hearingDate){const j=new Date(d.hearingDate);if(!isNaN(j.getTime())){const N=new Date(j);N.setDate(j.getDate()-14);const y=new Date(j);y.setDate(j.getDate()-7),m(v=>({...v,oppositionDueDate:N.toISOString().split("T")[0],replyDueDate:y.toISOString().split("T")[0]}))}}},[d.hearingDate]);const x=async()=>{d.title&&(u(!0),await new Promise(j=>setTimeout(j,DEBUG_API_SIMULATION_DELAY_MS+500)),alert(`AI Strategy Generated for ${d.title}`),u(!1))},p=j=>{const N=d.documents||[],y=j;N.includes(y)?m({...d,documents:N.filter(v=>v!==y)}):m({...d,documents:[...N,y]})},h=e.jsxs("div",{className:t("p-6 space-y-4 h-full overflow-y-auto",n.surface.default),children:[e.jsxs("div",{children:[e.jsx("label",{className:t("block text-xs font-semibold uppercase mb-1.5",n.text.secondary),children:"Motion Type"}),e.jsxs("select",{className:t("w-full px-3 py-2 border rounded-md text-sm",n.surface.default,n.border.default,n.text.primary),value:d.type,onChange:j=>m({...d,type:j.target.value}),"aria-label":"Motion Type",children:[e.jsx("option",{value:"Dismiss",children:"Motion to Dismiss"}),e.jsx("option",{value:"Summary Judgment",children:"Summary Judgment"}),e.jsx("option",{value:"Compel Discovery",children:"Compel Discovery"}),e.jsx("option",{value:"In Limine",children:"Motion In Limine"}),e.jsx("option",{value:"Continuance",children:"Motion for Continuance"})]})]}),e.jsx(Z,{label:"Title",placeholder:"e.g. Motion to Dismiss Count III",value:d.title||"",onChange:j=>m({...d,title:j.target.value})}),e.jsxs("div",{children:[e.jsx("label",{className:t("block text-xs font-semibold uppercase mb-1.5",n.text.secondary),children:"Hearing Date (Optional)"}),e.jsx("input",{type:"date",className:t("w-full px-3 py-2 border rounded-md text-sm",n.surface.default,n.border.default,n.text.primary),value:d.hearingDate||"",onChange:j=>m({...d,hearingDate:j.target.value}),"aria-label":"Hearing Date"}),d.hearingDate&&e.jsxs("div",{className:t("mt-2 text-xs flex items-center gap-4 p-2 rounded border",n.text.link,n.surface.highlight,n.border.default),children:[e.jsxs("span",{children:[e.jsx(ce,{className:"h-3 w-3 inline mr-1"})," Opp: ",d.oppositionDueDate]}),e.jsxs("span",{children:[e.jsx(ce,{className:"h-3 w-3 inline mr-1"})," Reply: ",d.replyDueDate]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:t("block text-xs font-semibold uppercase mb-1.5",n.text.secondary),children:"Governing Rules"}),e.jsx(Yr,{selectedRules:d.linkedRules||[],onRulesChange:j=>m({...d,linkedRules:j})})]}),e.jsxs("div",{children:[e.jsx("label",{className:t("block text-xs font-semibold uppercase mb-2",n.text.secondary),children:"Link Exhibits / Documents"}),e.jsxs("div",{className:t("border rounded-md p-2 max-h-32 overflow-y-auto",n.surface.highlight,n.border.default),children:[l.map(j=>e.jsxs("div",{className:t("flex items-center p-1 rounded cursor-pointer",`hover:${n.surface.default}`),onClick:()=>p(j.id),children:[e.jsx("div",{className:t("w-4 h-4 mr-2 border rounded flex items-center justify-center",d.documents?.includes(j.id)?t(n.action.primary.bg,n.action.primary.border):"bg-white border-slate-300"),children:d.documents?.includes(j.id)&&e.jsx(Ae,{className:"h-3 w-3 text-white"})}),e.jsx("span",{className:t("text-xs truncate",n.text.primary),children:j.title})]},j.id)),l.length===0&&e.jsx("p",{className:t("text-xs italic",n.text.tertiary),children:"No case documents available."})]})]}),e.jsxs("div",{className:"p-4 bg-indigo-50 border border-indigo-100 rounded-lg flex items-start gap-3",children:[e.jsx(oe,{className:"h-5 w-5 text-indigo-600 shrink-0 mt-0.5"}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-bold text-indigo-900",children:"AI Strategy Assistance"}),e.jsx("p",{className:"text-xs text-indigo-700 mt-1 mb-2",children:"Analyze case facts and local rules to suggest arguments."}),e.jsx("button",{onClick:x,disabled:f||!d.title,className:"text-xs bg-indigo-600 text-white px-3 py-1.5 rounded hover:bg-indigo-700 disabled:opacity-50 transition-colors",children:f?"Analyzing...":"Generate Arguments"})]})]}),e.jsxs("div",{className:t("pt-4 flex justify-end gap-3 border-t mt-2",n.border.default),children:[e.jsx(_,{variant:"secondary",onClick:a,children:"Cancel"}),e.jsx(_,{variant:"primary",onClick:()=>r(d),icon:Ks,children:"Create Draft"})]})]});return i?h:e.jsx(Ne,{isOpen:s,onClose:a,title:"Draft New Motion",children:h})},to=({caseId:s,caseTitle:a,documents:r=[]})=>{const{theme:l}=D(),o=De(),{openWindow:i,closeWindow:n}=_e(),[d,m]=c.useState(null),{data:f=[],isLoading:u}=F(["motions",s],()=>I.motions.getByCaseId(s),{enabled:!!s}),{mutate:x}=le(I.motions.add,{invalidateKeys:[["motions",s]],onSuccess:()=>n("new-motion-modal")}),{mutate:p,isLoading:h}=le(I.calendar.sync,{onSuccess:()=>o.success("Synced deadlines to Master Calendar and Outlook.")}),j={type:"Dismiss",status:"Draft",documents:[],linkedRules:[],conferralStatus:"Required"},N=v=>{if(!v.title)return;const S={id:`mot-${Date.now()}`,caseId:s,title:v.title,description:v.description||"",type:v.type,status:v.status,assignedAttorney:"Current User",filingDate:new Date().toISOString().split("T")[0],hearingDate:v.hearingDate,oppositionDueDate:v.oppositionDueDate,replyDueDate:v.replyDueDate,documents:v.documents,linkedRules:v.linkedRules,conferralStatus:v.conferralStatus||"Required"};x(S)},y=()=>{i("new-motion-modal","Draft New Motion",e.jsx(so,{isOpen:!0,onClose:()=>n("new-motion-modal"),onSave:N,documents:r,initialMotion:j,isOrbital:!0}))};return e.jsxs("div",{className:"space-y-6",children:[d&&e.jsx(Ke,{isOpen:!0,onClose:()=>m(null),initialTitle:`Prepare: ${d.title}`,relatedModule:"Motions",relatedItemId:d.id,relatedItemTitle:d.title}),e.jsxs("div",{className:"flex flex-col md:flex-row md:justify-between md:items-center gap-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:t("text-lg font-bold",l.text.primary),children:"Motion Practice"}),e.jsxs("p",{className:t("text-sm",l.text.secondary),children:[a?`${a} - `:"","Track filings, opposition deadlines, and hearings."]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(_,{variant:"secondary",size:"sm",icon:Is,onClick:()=>p(void 0),isLoading:h,children:"Sync Calendar"}),e.jsx(_,{variant:"primary",size:"sm",icon:J,onClick:y,children:"New Motion"})]})]}),u?e.jsxs("div",{className:t("flex items-center justify-center py-12",l.text.tertiary),children:[e.jsx(Is,{className:"h-6 w-6 animate-spin mr-2"}),"Loading motions..."]}):e.jsx(eo,{motions:f,onTaskClick:m})]})},ao=({caseData:s})=>{const{theme:a}=D(),r=s.jurisdictionConfig?`${s.jurisdictionConfig.courtLevel} - ${s.jurisdictionConfig.state}`:s.jurisdiction||"N/A",l=s.valuation?`${s.valuation.amount.toLocaleString()} ${s.valuation.currency}`:`$${(s.value||0).toLocaleString()}`,o=[{label:"Matter Type",value:`${s.matterType||"General"} ${s.matterSubType?`(${s.matterSubType})`:""}`,icon:null,highlight:!0},{label:"Est. Value / Exposure",value:l,icon:Ce,mono:!0},{label:"Jurisdiction",value:r,icon:pr},{label:"Venue / Court",value:s.court||"N/A",icon:ve},{label:"Presiding Judge",value:s.judge||"Unassigned",icon:Ee},{label:"Magistrate Judge",value:s.magistrateJudge||"N/A",icon:Ee},{label:"Opposing Counsel",value:s.opposingCounsel||"N/A",icon:fe},{label:"Originating Case",value:s.origCaseNumber||"N/A",icon:as},s.dateTerminated?{label:"Date Terminated",value:s.dateTerminated,icon:pe,color:a.status.error.text}:null];return e.jsx(ye,{title:"Matter Particulars",className:t("border-t-4",a.primary.border),children:e.jsxs("dl",{className:"grid grid-cols-1 sm:grid-cols-2 gap-x-8 gap-y-6",children:[o.filter(i=>!!i).map((i,n)=>e.jsxs("div",{className:"min-w-0",children:[e.jsx("dt",{className:t("text-xs font-bold uppercase mb-1 truncate",a.text.tertiary),children:i.label}),e.jsxs("dd",{className:t("text-sm flex items-start break-words",i.color||a.text.primary,i.mono?"font-mono font-bold":""),children:[i.highlight&&e.jsx("span",{className:t("w-2 h-2 rounded-full mr-2 mt-1.5 shrink-0",a.primary.DEFAULT)}),i.icon&&e.jsx(i.icon,{className:t("h-3.5 w-3.5 mr-2 mt-0.5 shrink-0",a.text.tertiary)}),e.jsx("span",{className:"flex-1",children:i.value})]})]},n)),e.jsxs("div",{className:t("col-span-1 sm:col-span-2 p-3 rounded border",a.surface.highlight,a.border.default),children:[e.jsx("dt",{className:t("text-xs font-bold uppercase mb-1",a.text.secondary),children:"Case Abstract"}),e.jsx("dd",{className:t("text-sm leading-relaxed max-h-32 overflow-y-auto custom-scrollbar",a.text.secondary),children:s.description})]}),s.origJudgmentDate&&e.jsxs("div",{className:"min-w-0",children:[e.jsxs("dt",{className:t("text-xs font-bold uppercase mb-1 flex items-center",a.text.tertiary),children:[e.jsx(ve,{className:"h-3 w-3 mr-1 opacity-50"}),"Orig. Judgment"]}),e.jsx("dd",{className:t("text-sm",a.text.secondary),children:s.origJudgmentDate})]}),s.noticeOfAppealDate&&e.jsxs("div",{className:"min-w-0",children:[e.jsxs("dt",{className:t("text-xs font-bold uppercase mb-1 flex items-center",a.text.tertiary),children:[e.jsx(je,{className:"h-3 w-3 mr-1 opacity-50"}),"Notice of Appeal"]}),e.jsx("dd",{className:t("text-sm",a.text.secondary),children:s.noticeOfAppealDate})]}),s.solDate&&e.jsxs("div",{className:"min-w-0",children:[e.jsxs("dt",{className:t("text-xs font-bold uppercase mb-1 flex items-center",a.status.error.text),children:[e.jsx(je,{className:"h-3 w-3 mr-1"}),"SOL Expiry"]}),e.jsx("dd",{className:t("text-sm",a.status.error.text),children:s.solDate})]})]})})},ro=({activeProjects:s})=>{const{theme:a}=D();return s.length===0?e.jsxs("div",{className:t("rounded-lg border shadow-sm overflow-hidden",a.surface.default,a.border.default),children:[e.jsx("div",{className:t("p-4 border-b flex justify-between items-center",a.surface.highlight,a.border.default),children:e.jsxs("h3",{className:t("text-sm font-bold flex items-center",a.text.primary),children:[e.jsx(fe,{className:t("h-4 w-4 mr-2",a.primary.text)})," Active Workstreams"]})}),e.jsxs("div",{className:t("p-8 text-center",a.text.tertiary),children:[e.jsx(fe,{className:"h-10 w-10 mx-auto mb-3 opacity-30"}),e.jsx("p",{className:"text-sm",children:"No active workstreams"})]})]}):e.jsxs("div",{className:t("rounded-lg border shadow-sm overflow-hidden",a.surface.default,a.border.default),children:[e.jsx("div",{className:t("p-4 border-b flex justify-between items-center",a.surface.highlight,a.border.default),children:e.jsxs("h3",{className:t("text-sm font-bold flex items-center",a.text.primary),children:[e.jsx(fe,{className:t("h-4 w-4 mr-2",a.primary.text)})," Active Workstreams"]})}),e.jsx("div",{className:"p-4 grid grid-cols-1 gap-3",children:s.map(r=>{const l=(r.tasks||[]).length,o=(r.tasks||[]).filter(n=>n.status==="Done").length,i=l===0?0:Math.round(o/l*100);return e.jsxs("div",{className:t("flex items-center gap-4 p-3 border rounded-lg",a.surface.default,a.border.default),children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex justify-between mb-1",children:[e.jsx("span",{className:t("text-sm font-bold",a.text.primary),children:r.title}),e.jsxs("span",{className:t("text-xs font-bold",a.primary.text),children:[i,"%"]})]}),e.jsx("div",{className:t("w-full rounded-full h-1.5",a.surface.highlight),role:"progressbar","aria-valuenow":i,"aria-valuemin":0,"aria-valuemax":100,"aria-label":`Progress for ${r.title}`,children:e.jsx("div",{className:t("h-1.5 rounded-full",a.primary.DEFAULT),style:{width:`${i}%`}})})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("span",{className:t("text-xs block",a.text.secondary),children:"Lead"}),e.jsx("span",{className:t("text-xs font-medium",a.text.primary),children:r.lead})]})]},r.id)})})]})},lo=({caseData:s,linkedCases:a,onShowTimeModal:r,onShowLinkModal:l,onShowTransferModal:o,onNavigateToCase:i})=>{const{theme:n,mode:d}=D(),m=[{id:"act-time",label:"Log Time",icon:ce,onClick:r},{id:"act-link",label:"Link Docket",icon:ds,onClick:l},{id:"act-transfer",label:"Transfer / Appeal",icon:$t,onClick:o}];return e.jsxs("div",{className:"space-y-6 w-full",children:[e.jsxs("div",{className:t("p-5 rounded-lg shadow-sm border",n.surface.default,n.border.default),children:[e.jsx("h3",{className:t("text-sm font-bold uppercase tracking-wide mb-4",n.text.primary),children:"Quick Actions"}),e.jsx("div",{className:"space-y-2",children:m.map(f=>e.jsxs("button",{onClick:f.onClick,className:t("w-full text-left px-3 py-2 text-sm font-medium rounded-md transition-colors flex items-center border",n.surface.highlight,n.text.secondary,n.border.default,`hover:${n.primary.light}`,`hover:${n.primary.text}`,`hover:${n.primary.border}`),children:[e.jsx(f.icon,{className:"h-4 w-4 mr-2 shrink-0"})," ",f.label]},f.id))})]}),e.jsxs("div",{className:t("rounded-lg border shadow-sm p-5",n.surface.default,n.border.default),children:[e.jsxs("div",{className:"flex justify-between items-center mb-3",children:[e.jsxs("h4",{className:t("font-bold text-sm flex items-center",n.text.primary),children:[e.jsx(ds,{className:t("h-3 w-3 mr-2 shrink-0",n.text.link)})," Linked Matters"]}),e.jsx("button",{onClick:l,className:t("p-1 rounded transition-colors",`hover:${n.surface.highlight}`,n.primary.text),"aria-label":"Add linked matter",children:e.jsx(J,{className:"h-4 w-4"})})]}),a.length>0?e.jsxs("div",{className:"space-y-3 relative",children:[e.jsx("div",{className:t("absolute left-2.5 top-0 bottom-4 w-0.5 z-0",n.border.default)}),a.map(f=>e.jsxs("div",{onClick:()=>i&&i(f),className:t("relative z-10 p-3 rounded-lg border cursor-pointer transition-all group overflow-hidden",n.surface.highlight,n.border.default,`hover:${n.primary.border}`,"hover:shadow-md"),children:[e.jsx("div",{className:t("absolute -left-[19px] top-1/2 -translate-y-1/2 w-3 h-3 rounded-full border-2",n.surface.default,n.primary.border)}),e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{className:"flex-1 min-w-0 pr-2",children:[e.jsx("span",{className:t("font-bold text-xs truncate block group-hover:underline",n.text.primary),title:f.title,children:f.title}),e.jsx("span",{className:t("text-xs uppercase font-bold px-1.5 py-0.5 rounded border mt-1 inline-block",n.surface.default,n.border.default,n.text.secondary),children:f.matterType})]}),e.jsx(fs,{className:t("h-3 w-3 opacity-0 group-hover:opacity-100 transition-opacity shrink-0",n.primary.text)})]}),e.jsxs("div",{className:t("flex justify-between items-center mt-2 text-[10px]",n.text.tertiary),children:[e.jsx("span",{className:"font-mono truncate max-w-[80px]",children:f.id}),e.jsx("span",{children:f.status})]})]},f.id))]}):e.jsxs("div",{className:t("text-center py-4 border-2 border-dashed rounded-lg",n.border.default),children:[e.jsx(ds,{className:t("h-8 w-8 mx-auto mb-2 opacity-20",n.text.tertiary)}),e.jsx("p",{className:t("text-xs italic",n.text.tertiary),children:"No linked dockets."})]})]}),e.jsxs("div",{className:t("rounded-lg shadow-md p-5 text-white",d==="dark"?"bg-slate-800":"bg-gradient-to-br from-slate-800 to-slate-900"),children:[e.jsxs("h3",{className:"font-bold text-sm mb-4 flex items-center",children:[e.jsx(gr,{className:"h-4 w-4 mr-2"})," Strategy Health"]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex justify-between items-center text-xs",children:[e.jsx("span",{className:"text-slate-300",children:"Arguments"}),e.jsx("span",{className:"font-bold bg-white/10 px-2 py-0.5 rounded",children:s.arguments?.length||0})]}),e.jsxs("div",{className:"flex justify-between items-center text-xs",children:[e.jsx("span",{className:"text-slate-300",children:"Defenses"}),e.jsx("span",{className:"font-bold bg-white/10 px-2 py-0.5 rounded",children:s.defenses?.length||0})]}),e.jsxs("div",{className:"flex justify-between items-center text-xs",children:[e.jsx("span",{className:"text-slate-300",children:"Citations"}),e.jsx("span",{className:"font-bold bg-white/10 px-2 py-0.5 rounded",children:s.citations?.length||0})]})]})]})]})},io=()=>{const{theme:s}=D(),{openWindow:a,closeWindow:r}=_e(),l=o=>{const i=`stat-${o.toLowerCase().replace(" ","-")}`;a(i,`Detail: ${o}`,e.jsxs("div",{className:t("p-6 flex flex-col items-center justify-center h-full text-center",s.text.primary),children:[e.jsxs("h3",{className:"text-xl font-bold mb-2",children:[o," Breakdown"]}),e.jsx("p",{className:s.text.secondary,children:"Detailed analytics and historical data for this metric would appear here."}),e.jsx("button",{className:t("mt-4 underline",s.primary.text),onClick:()=>r(i),children:"Close"})]}))};return e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[{label:"Total Billed",value:"124,500",icon:Ce,color:s.status.success.text},{label:"Upcoming Events",value:"3",icon:ce,color:s.primary.text},{label:"Open Tasks",value:"12",icon:ie,color:s.chart.colors.purple},{label:"Risk Score",value:"Low",icon:bs,color:s.status.warning.text}].map((o,i)=>e.jsxs("div",{onClick:()=>l(o.label),className:t("p-4 rounded-lg border shadow-sm flex flex-col justify-center cursor-pointer group relative overflow-hidden",s.surface.default,s.border.default,`hover:${s.surface.highlight}`,`hover:${s.primary.border} transition-all`),children:[e.jsx("p",{className:t("text-xs font-bold uppercase mb-1",s.text.secondary),children:o.label}),e.jsxs("div",{className:t("flex items-center font-bold text-lg",s.text.primary),children:[e.jsx(o.icon,{className:t("h-4 w-4 mr-1",o.color)})," ",o.value]}),e.jsx("div",{className:"absolute top-2 right-2 opacity-0 group-hover:opacity-100 transition-opacity",children:e.jsx(fs,{className:t("h-3 w-3",s.text.tertiary)})})]},i))})},no=({isOpen:s,onClose:a,caseId:r,onSave:l})=>{const[o,i]=c.useState(""),[n,d]=c.useState("0.5"),[m,f]=c.useState(!1),{theme:u}=D(),x=async()=>{if(!o)return;f(!0);const h=await qe.refineTimeEntry(o);i(h),f(!1)},p=()=>{l({caseId:r||"General",date:new Date().toISOString().split("T")[0],duration:parseFloat(n)*60,description:o,rate:450,total:parseFloat(n)*450,status:"Unbilled"}),i(""),a()};return e.jsx(Ne,{isOpen:s,onClose:a,title:e.jsxs("span",{className:t("flex items-center gap-2",u.text.primary),children:[e.jsx(ce,{className:t("h-5 w-5",u.primary.text)})," Log Billable Time"]}),size:"sm",children:e.jsxs("div",{className:"p-6 space-y-5",children:[e.jsx(Z,{label:"Matter / Case",value:r||"General / Non-Billable",disabled:!0,className:t(u.surface.input,u.border.default,u.text.primary)}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(Z,{label:"Duration (Hours)",type:"number",step:"0.1",value:n,onChange:h=>d(h.target.value),className:t(u.surface.input,u.border.default,u.text.primary)}),e.jsxs("div",{children:[e.jsx("label",{className:t("block text-xs font-semibold uppercase mb-1.5",u.text.secondary),children:"Value Est."}),e.jsxs("div",{className:t("w-full px-3 py-2 border rounded-md text-sm font-mono flex items-center",u.surface.input,u.border.default,u.text.primary),children:[e.jsx(Ce,{className:t("h-3 w-3 mr-1",u.text.tertiary)}),(parseFloat(n||"0")*450).toFixed(2)]})]})]}),e.jsxs("div",{children:[e.jsx(Ge,{label:"Description",placeholder:"e.g. Call with client re: settlement strategy...",value:o,onChange:h=>i(h.target.value),rows:4,className:t("resize-none",u.surface.input,u.border.default,u.text.primary)}),e.jsx("div",{className:"mt-2 flex justify-end",children:e.jsx(_,{variant:"ghost",size:"sm",onClick:x,disabled:m||!o,icon:oe,isLoading:m,className:t("text-indigo-600 hover:text-indigo-700 hover:bg-indigo-50 dark:text-indigo-400 dark:hover:bg-indigo-900/50"),children:"AI Refine & Expand"})})]}),e.jsx("div",{className:"pt-2",children:e.jsx(_,{variant:"primary",className:"w-full",onClick:p,children:"Save Time Entry"})})]})})},oo=({caseData:s,showTimeModal:a,setShowTimeModal:r,showLinkModal:l,setShowLinkModal:o,showTransferModal:i,setShowTransferModal:n,availableCases:d,onSaveTime:m,onLinkCase:f,onTransfer:u})=>{const{theme:x}=D();return e.jsxs(e.Fragment,{children:[e.jsx(no,{isOpen:a,onClose:()=>r(!1),caseId:s.id,onSave:m}),e.jsxs(Ne,{isOpen:l,onClose:()=>o(!1),title:"Link Related Docket",children:[e.jsxs("div",{className:"p-4 space-y-2 max-h-[60vh] overflow-y-auto",children:[e.jsx("p",{className:t("text-sm mb-4",x.text.secondary),children:"Select a docket to consolidate or link as a related matter."}),d.length===0&&e.jsx("p",{className:t("text-sm italic",x.text.tertiary),children:"No other cases available to link."}),d.map(p=>e.jsxs("div",{className:t("flex justify-between items-center p-3 border rounded transition-colors",x.border.default,`hover:${x.surface.highlight}`),children:[e.jsxs("div",{children:[e.jsx("p",{className:t("font-bold text-sm",x.text.primary),children:p.title}),e.jsxs("p",{className:t("text-xs",x.text.secondary),children:[p.id," • ",p.court]})]}),e.jsx(_,{size:"sm",variant:"outline",icon:J,onClick:()=>f(p),children:"Link"})]},p.id))]}),e.jsx("div",{className:t("p-4 border-t flex justify-end",x.border.default),children:e.jsx(_,{onClick:()=>o(!1),children:"Done"})})]}),e.jsx(Ne,{isOpen:i,onClose:()=>n(!1),title:"Transfer to Appeal",size:"sm",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:t("border rounded p-4 mb-4",x.status.warning.bg,x.status.warning.border),children:[e.jsxs("div",{className:t("flex items-center gap-2 font-bold mb-1",x.status.warning.text),children:[e.jsx(je,{className:"h-5 w-5"})," Important"]}),e.jsx("p",{className:t("text-xs",x.status.warning.text),children:'This action will create a new linked matter with type "Appeal". The current case status will remain active until closed. FRAP 4 deadlines will be tracked.'})]}),e.jsxs("p",{className:t("text-sm mb-4",x.text.secondary),children:["Confirm creation of Appellate Matter for ",e.jsx("strong",{children:s.title}),"?"]}),e.jsxs("div",{className:"flex justify-end gap-3",children:[e.jsx(_,{variant:"secondary",onClick:()=>n(!1),children:"Cancel"}),e.jsx(_,{variant:"primary",icon:$t,onClick:u,children:"File Appeal"})]})]})})]})},co=({caseData:s,onTimeEntryAdded:a,onNavigateToCase:r})=>{const{theme:l}=D(),{showTimeModal:o,setShowTimeModal:i,showLinkModal:n,setShowLinkModal:d,showTransferModal:m,setShowTransferModal:f,linkedCases:u,availableCases:x,handleSaveTime:p,handleLinkCase:h,handleTransferToAppeal:j}=ji(s,a,r),{data:N=[]}=F(["cases",s.id,"parties"],()=>I.cases.getParties(s.id),{initialData:s.parties||[]}),y=s.projects?.filter(v=>v.status==="In Progress")||[];return e.jsxs("div",{className:"space-y-6",children:[e.jsx(oo,{caseData:s,showTimeModal:o,setShowTimeModal:i,showLinkModal:n,setShowLinkModal:d,showTransferModal:m,setShowTransferModal:f,availableCases:x,onSaveTime:v=>p(v),onLinkCase:h,onTransfer:j}),e.jsx(io,{}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"col-span-1 md:col-span-2 space-y-6",children:[e.jsx(ao,{caseData:s}),e.jsx(ro,{activeProjects:y}),e.jsxs("div",{className:t("p-6 rounded-lg shadow-sm border",l.surface.default,l.border.default),children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsxs("h3",{className:t("text-lg font-bold flex items-center",l.text.primary),children:[e.jsx(de,{className:t("h-5 w-5 mr-2",l.text.secondary)})," Key Parties"]}),e.jsx(_,{variant:"ghost",size:"sm",className:l.primary.text,children:"View All"})]}),e.jsxs(We,{responsive:"card",className:"shadow-none border-0 rounded-none",children:[e.jsxs(He,{children:[e.jsx(B,{children:"Role"}),e.jsx(B,{children:"Entity Name"}),e.jsx(B,{children:"Type"})]}),e.jsx(Ue,{children:N.slice(0,4).map(v=>e.jsxs(Ie,{children:[e.jsx(V,{className:t("text-sm font-medium",l.text.primary),children:v.role}),e.jsx(V,{className:t("text-sm",l.text.secondary),children:v.name}),e.jsx(V,{children:e.jsx("span",{className:t("inline-flex items-center px-2 py-0.5 rounded text-[10px] font-medium",l.surface.highlight,l.text.secondary),children:v.type})})]},v.id))})]}),(!N||N.length===0)&&e.jsx("div",{className:t("text-center py-4 italic text-sm",l.text.tertiary),children:"No parties listed."})]})]}),e.jsx("div",{className:"space-y-6",children:e.jsx(lo,{caseData:s,linkedCases:u,onShowTimeModal:()=>i(!0),onShowLinkModal:()=>d(!0),onShowTransferModal:()=>f(!0),onNavigateToCase:r})})]})]})},mo=({project:s,isExpanded:a,onToggleExpand:r,onAddTask:l,onUpdateTaskStatus:o})=>{const{theme:i}=D(),n=u=>{switch(u){case"Active":return t(i.status.info.bg,i.status.info.text,i.status.info.border);case"Completed":return t(i.status.success.bg,i.status.success.text,i.status.success.border);case"On Hold":return t(i.status.warning.bg,i.status.warning.text,i.status.warning.border);default:return t(i.surface.highlight,i.text.secondary,i.border.default)}},d=s.tasks?.length??0,m=s.tasks?.filter(u=>u.status==="Done").length??0,f=d===0?s.completionPercentage??0:Math.round(m/d*100);return e.jsxs("div",{className:t("rounded-xl border transition-all duration-300 shadow-sm overflow-hidden",i.surface.default,s.priority==="Urgent"?"border-l-4 border-l-red-500":i.border.default),children:[e.jsxs("div",{className:t("p-5 flex flex-col md:flex-row md:items-center justify-between cursor-pointer gap-4",`hover:${i.surface.highlight}`),onClick:r,children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-1",children:[e.jsx("h4",{className:t("font-bold text-lg truncate",i.text.primary),children:s.name}),e.jsx("span",{className:t("px-2 py-0.5 rounded-full text-xs font-bold border",n(s.status)),children:s.status}),s.priority==="Urgent"&&e.jsx(K,{variant:"error",children:"Urgent"})]}),e.jsx("p",{className:t("text-sm line-clamp-1",i.text.secondary),children:s.description}),e.jsxs("div",{className:t("flex flex-wrap items-center gap-4 mt-3 text-xs",i.text.tertiary),children:[s.startDate&&e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(pe,{className:"h-3 w-3"})," Started: ",new Date(s.startDate).toLocaleDateString()]}),s.dueDate&&e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(pe,{className:"h-3 w-3"})," Due: ",new Date(s.dueDate).toLocaleDateString()]}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(ie,{className:"h-3 w-3"})," ",m,"/",d," Tasks"]})]})]}),e.jsxs("div",{className:"flex items-center gap-4 w-full md:w-auto mt-2 md:mt-0",children:[e.jsxs("div",{className:"flex-1 md:w-32",children:[e.jsxs("div",{className:t("flex justify-between text-xs mb-1 font-medium",i.text.secondary),children:[e.jsx("span",{children:"Progress"}),e.jsxs("span",{children:[f,"%"]})]}),e.jsx("div",{className:t("w-full rounded-full h-1.5",i.surface.highlight),children:e.jsx("div",{className:t("h-1.5 rounded-full transition-all",i.action.primary.bg),"data-progress":f})}),e.jsx("style",{children:`
                    [data-progress="${f}"] {
                      width: ${f}%;
                    }
                  `})]}),e.jsx("button",{className:t("transition-colors",i.text.tertiary,`hover:${i.text.link}`),title:a?"Collapse project":"Expand project","aria-label":a?"Collapse project details":"Expand project details",children:a?e.jsx(zt,{className:"h-5 w-5"}):e.jsx(ts,{className:"h-5 w-5"})})]})]}),a&&e.jsx("div",{className:t("p-5 pt-0 border-t bg-slate-50/50",i.border.default),children:e.jsxs("div",{className:"space-y-3 mt-4 max-h-[400px] overflow-y-auto custom-scrollbar pr-1",children:[s.tasks?.map(u=>e.jsxs("div",{className:t("group flex flex-col md:flex-row gap-3 items-start md:items-center p-3 rounded-lg border transition-all hover:shadow-sm",i.surface.default,i.border.default),children:[e.jsx("button",{onClick:()=>o(s.id,u.id),title:u.status==="Done"?"Mark as incomplete":"Mark as complete","aria-label":u.status==="Done"?"Mark task as incomplete":"Mark task as complete",className:`shrink-0 w-5 h-5 rounded-full border-2 flex items-center justify-center transition-colors ${u.status==="Done"?"bg-green-500 border-green-500 text-white":t("text-transparent",i.border.default,`hover:${i.action.primary.border}`)}`,children:e.jsx(ie,{className:"h-3.5 w-3.5 fill-current"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("div",{className:"flex items-center gap-2",children:e.jsx("h5",{className:t("text-sm font-medium truncate",u.status==="Done"?"text-slate-400 line-through":i.text.primary),children:u.name})}),e.jsxs("div",{className:t("flex items-center gap-3 text-xs mt-0.5",i.text.tertiary),children:[u.assignedTo&&e.jsx("span",{children:u.assignedTo}),u.dueDate&&e.jsxs("span",{children:["Due: ",new Date(u.dueDate).toLocaleDateString()]})]})]})]},u.id)),(s.tasks?.length??0)===0&&e.jsx("div",{className:t("text-center py-4 text-sm italic",i.text.tertiary),children:"No tasks in this project."}),e.jsxs("button",{onClick:()=>l(s.id),className:t("w-full py-2 text-xs font-medium rounded border border-dashed transition-colors flex items-center justify-center gap-1",i.text.primary,i.border.default,`hover:${i.surface.default}`,`hover:${i.primary.text}`),children:[e.jsx(J,{className:"h-3 w-3"})," Add Task to Project"]})]})})]})},uo=({projects:s,onAddTask:a,onUpdateTaskStatus:r,onNavigateToModule:l})=>{const[o,i]=c.useState(s.find(n=>n.status==="In Progress")?.id||null);return e.jsx("div",{className:"space-y-6",children:s.map(n=>e.jsx(mo,{project:n,isExpanded:o===n.id,onToggleExpand:()=>i(o===n.id?null:n.id),onAddTask:a,onUpdateTaskStatus:r,onNavigateToModule:l},n.id))})},xo=({isOpen:s,onClose:a,onSave:r})=>{const{theme:l}=D(),[o,i]=c.useState({title:"",description:"",status:"Not Started",priority:"Medium",lead:"Current User"}),n=()=>{r(o),i({name:"",description:"",status:"Not Started",priority:"Medium"})};return e.jsx(Ne,{isOpen:s,onClose:a,title:"Create New Project",children:e.jsxs("div",{className:"p-6 space-y-4",children:[e.jsx(Z,{label:"Project Title",placeholder:"e.g. Expert Witness Prep",value:o.title,onChange:d=>i({...o,title:d.target.value})}),e.jsx(Ge,{label:"Description",rows:3,placeholder:"Objectives and scope...",value:o.description,onChange:d=>i({...o,description:d.target.value})}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:t("block text-xs font-semibold uppercase mb-1.5",l.text.secondary),children:"Status"}),e.jsxs("select",{className:t("w-full px-3 py-2 border rounded-md text-sm",l.surface.input,l.border.default,l.text.primary),value:o.status,onChange:d=>i({...o,status:d.target.value}),"aria-label":"Project status",children:[e.jsx("option",{value:"Not Started",children:"Not Started"}),e.jsx("option",{value:"In Progress",children:"In Progress"}),e.jsx("option",{value:"On Hold",children:"On Hold"}),e.jsx("option",{value:"Completed",children:"Completed"}),e.jsx("option",{value:"Cancelled",children:"Cancelled"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:t("block text-xs font-semibold uppercase mb-1.5",l.text.secondary),children:"Priority"}),e.jsxs("select",{className:t("w-full px-3 py-2 border rounded-md text-sm",l.surface.input,l.border.default,l.text.primary),value:o.priority,onChange:d=>i({...o,priority:d.target.value}),"aria-label":"Project priority",children:[e.jsx("option",{value:"Low",children:"Low"}),e.jsx("option",{value:"Medium",children:"Medium"}),e.jsx("option",{value:"High",children:"High"}),e.jsx("option",{value:"Urgent",children:"Urgent"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(Z,{label:"Lead",value:o.lead,onChange:d=>i({...o,lead:d.target.value})}),e.jsx(Z,{type:"date",label:"Due Date",value:o.dueDate||"",onChange:d=>i({...o,dueDate:d.target.value})})]}),e.jsxs("div",{className:t("flex justify-end pt-4 border-t mt-4",l.border.subtle),children:[e.jsx(_,{variant:"secondary",onClick:a,className:"mr-2",children:"Cancel"}),e.jsx(_,{variant:"primary",onClick:n,children:"Create Project"})]})]})})},ho=({projects:s,onAddProject:a,onAddTask:r,onUpdateTaskStatus:l,onNavigateToModule:o})=>{const{theme:i}=D(),[n,d]=c.useState(!1),[m,f]=c.useState(null),[u,x]=c.useState(s);c.useEffect(()=>{s.length>0&&s[0].caseId&&(async()=>{const j=await I.projects.getByCaseId(s[0].caseId);j.length>0&&x(j)})()},[s]);const p=async h=>{if(!h.name)return;const j={id:`proj-${Date.now()}`,caseId:s[0]?.caseId||"General",name:h.name,description:h.description,status:h.status||"Not Started",priority:h.priority||"Medium",completionPercentage:0,startDate:h.startDate,dueDate:h.dueDate,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString(),tasks:[]};await I.projects.add(j),x([...u,j]),a(j),d(!1)};return e.jsxs("div",{className:"space-y-6 animate-fade-in h-full flex flex-col",children:[m&&e.jsx(Ke,{isOpen:!0,onClose:()=>f(null),relatedItemTitle:u.find(h=>h.id===m)?.title,relatedModule:"Project",onSave:h=>r(m,h)}),e.jsx(xo,{isOpen:n,onClose:()=>d(!1),onSave:p}),e.jsxs("div",{className:t("flex flex-col md:flex-row justify-between items-center p-6 rounded-xl border shadow-sm gap-4 shrink-0",i.surface.default,i.border.default),children:[e.jsxs("div",{children:[e.jsx("h3",{className:t("text-lg font-bold mb-1",i.text.primary),children:"Case Projects"}),e.jsx("p",{className:t("text-sm",i.text.secondary),children:"Manage parallel workstreams and group cross-functional tasks."})]}),e.jsx(_,{variant:"primary",icon:J,onClick:()=>d(!0),children:"New Project"})]}),e.jsx("div",{className:"flex-1 overflow-y-auto",children:u.length===0?e.jsxs("div",{className:t("text-center py-12 rounded-xl border-2 border-dashed h-64 flex flex-col items-center justify-center",i.surface.highlight,i.border.default),children:[e.jsx(fe,{className:t("h-12 w-12 mx-auto mb-3",i.text.tertiary)}),e.jsx("p",{className:t("font-medium",i.text.secondary),children:"No projects yet."}),e.jsx("button",{onClick:()=>d(!0),className:t("text-sm hover:underline mt-2",i.text.link),children:"Create your first project"})]}):e.jsx(uo,{projects:u,onAddTask:f,onUpdateTaskStatus:l,onNavigateToModule:o})})]})},$s=({caseData:s,onBack:a,onSelectCase:r,initialTab:l="Overview",initialDocuments:o,initialParties:i})=>{const{theme:n}=D(),[d,m]=c.useState(!1),[f,u]=c.useState(!1),{activeTab:x,setActiveTab:p,documents:h,setDocuments:j,stages:N,parties:y,setParties:v,projects:S,addProject:C,addTaskToProject:b,updateProjectTaskStatus:w,billingEntries:g,setBillingEntries:T,generatingWorkflow:E,analyzingId:L,draftPrompt:W,setDraftPrompt:X,draftResult:me,isDrafting:M,timelineEvents:R,analyzeWithAI:te,draftDocument:P,generateAIWorkflow:O}=gi(s,l,o,i),$=ae=>te(ae.id),H=()=>P("Motion/Clause",W),ee=()=>O(),se=c.useCallback(ae=>{const Re=us.find(ga=>ga.id===ae);Re&&Re.subTabs.length>0&&p(Re.subTabs[0].id)},[p]),Te=c.useCallback(ae=>{T(Re=>[...Re||[],ae])},[T]),ls=c.useCallback(ae=>{j(Re=>[...Re||[],ae])},[j]),Ns=c.useMemo(()=>{switch(x){case"Overview":return e.jsx(co,{caseData:s,onTimeEntryAdded:Te,onNavigateToCase:r});case"Parties":return e.jsx(Bn,{parties:y,onUpdate:v});case"Timeline":return e.jsx(ha,{events:R,onEventClick:ae=>console.log("Event clicked:",ae)});case"Research":return e.jsx(kt,{caseId:s.id,evidence:[]});case"Arguments":return e.jsx(Oi,{caseData:s,evidence:[]});case"Risk":return e.jsx(qn,{caseData:s});case"Strategy":return e.jsx(kt,{caseId:s.id,evidence:[]});case"Planning":return e.jsx(Wn,{caseData:s});case"Projects":return e.jsx(ho,{projects:S,onAddProject:C,onAddTask:b,onUpdateTaskStatus:w});case"Workflow":return e.jsx(Zn,{stages:N,generatingWorkflow:E,onGenerateWorkflow:ee,onNavigateToModule:ae=>p(ae)});case"Collaboration":return e.jsx(Xn,{caseId:s.id});case"Motions":return e.jsx(to,{caseId:s.id,caseTitle:s.title});case"Discovery":return e.jsx(On,{caseId:s.id});case"Evidence":return e.jsx(Ct,{caseId:s.id});case"Exhibits":return e.jsx(Ct,{caseId:s.id});case"Documents":return e.jsx(Vn,{documents:h,analyzingId:L,onAnalyze:$,onDocumentCreated:ls});case"Drafting":return e.jsx(Fn,{caseTitle:s.title,draftPrompt:W,setDraftPrompt:X,draftResult:me,isDrafting:M,onDraft:H});case"Contract Review":return e.jsx($i,{});case"Billing":return e.jsx(zi,{billingModel:s.billingModel||"Hourly",value:s.billingValue||0,entries:g});default:return e.jsx("div",{className:t("flex items-center justify-center h-96",n.text.tertiary),children:e.jsxs("div",{className:"text-center",children:[e.jsxs("p",{className:"text-lg font-medium mb-2",children:["Tab: ",x]}),e.jsx("p",{className:"text-sm",children:"Content component coming soon"})]})})}},[x,s,y,R,S,N,h,g,L,E,W,me,M,v,C,b,w,$,H,ee,Te,ls,r,n,p]);return e.jsxs("div",{className:t("h-full flex flex-col",n.surface.default),children:[e.jsx(xa,{id:s.id,title:s.title,status:s.status,client:s.client,clientId:s.clientId||s.id,jurisdiction:s.jurisdiction,onBack:a||(()=>{}),onShowTimeline:()=>u(!0)}),e.jsx(Ei,{activeTab:x,setActiveTab:p,onParentTabChange:se}),e.jsx("div",{className:"flex-1 overflow-y-auto px-6 pb-6",children:e.jsx("div",{className:"max-w-7xl mx-auto",children:Ns})}),e.jsx("button",{onClick:()=>m(!0),title:"Quick Actions Menu","aria-label":"Open quick actions menu",className:t("md:hidden fixed bottom-6 right-6 h-14 w-14 rounded-full shadow-lg flex items-center justify-center z-40",n.action.primary.bg,n.action.primary.text,n.action.primary.hover),children:e.jsx(J,{className:"h-6 w-6"})}),e.jsx(Ti,{isOpen:d,onClose:()=>m(!1),onNavigate:ae=>{p(ae),m(!1)}}),e.jsx(Pi,{isOpen:f,onClose:()=>u(!1),events:R,onEventClick:ae=>console.log("Timeline event:",ae)})]})},fo=Object.freeze(Object.defineProperty({__proto__:null,CaseDetail:$s,default:$s},Symbol.toStringTag,{value:"Module"})),G=c.memo(function({className:a="",animate:r=!0}){return e.jsx("div",{className:`rounded bg-gray-200 dark:bg-gray-700 ${r?"animate-pulse":""} ${a}`,"aria-hidden":"true"})}),po=c.memo(function({size:a="md",className:r=""}){const l={sm:"h-4 w-4",md:"h-8 w-8",lg:"h-12 w-12"};return e.jsxs("svg",{className:`animate-spin text-blue-600 dark:text-blue-400 ${l[a]} ${r}`,xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","aria-hidden":"true",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]})});c.memo(function({message:a="Loading...",fullPage:r=!1,className:l=""}){const o=e.jsxs("div",{className:`flex flex-col items-center justify-center gap-4 ${l}`,role:"status","aria-label":a,children:[e.jsx(po,{size:r?"lg":"md"}),e.jsx("p",{className:"text-sm font-medium text-gray-600 dark:text-gray-400",children:a})]});return r?e.jsx("div",{className:"flex min-h-screen items-center justify-center bg-gray-50 dark:bg-gray-900",children:o}):e.jsx("div",{className:"flex min-h-[400px] items-center justify-center p-8",children:o})});c.memo(function({className:a=""}){return e.jsxs("div",{className:`p-8 ${a}`,"aria-hidden":"true",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx(G,{className:"mb-2 h-8 w-64"}),e.jsx(G,{className:"h-4 w-96"})]}),e.jsxs("div",{className:"mb-6 flex items-center justify-between",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsx(G,{className:"h-10 w-32"}),e.jsx(G,{className:"h-10 w-24"})]}),e.jsx(G,{className:"h-10 w-64"})]}),e.jsx("div",{className:"grid gap-6 md:grid-cols-2 lg:grid-cols-3",children:Array.from({length:6}).map((r,l)=>e.jsx(Xe,{},l))})]})});const Xe=c.memo(function({className:a=""}){return e.jsxs("div",{className:`rounded-lg border border-gray-200 bg-white p-6 shadow-sm dark:border-gray-700 dark:bg-gray-800 ${a}`,"aria-hidden":"true",children:[e.jsxs("div",{className:"mb-4 flex items-start justify-between",children:[e.jsx(G,{className:"h-6 w-3/4"}),e.jsx(G,{className:"h-6 w-16 rounded-full"})]}),e.jsx(G,{className:"mb-3 h-4 w-full"}),e.jsx(G,{className:"mb-3 h-4 w-5/6"}),e.jsxs("div",{className:"mt-4 flex items-center gap-2",children:[e.jsx(G,{className:"h-8 w-8 rounded-full"}),e.jsx(G,{className:"h-4 w-24"})]})]})});c.memo(function({columns:a=5,rows:r=5,className:l=""}){return e.jsxs("div",{className:`overflow-hidden rounded-lg border border-gray-200 bg-white dark:border-gray-700 dark:bg-gray-800 ${l}`,"aria-hidden":"true",children:[e.jsx("div",{className:"flex gap-4 border-b border-gray-200 bg-gray-50 p-4 dark:border-gray-700 dark:bg-gray-900",children:Array.from({length:a}).map((o,i)=>e.jsx(G,{className:"h-4 flex-1"},i))}),Array.from({length:r}).map((o,i)=>e.jsx("div",{className:"flex gap-4 border-b border-gray-100 p-4 last:border-b-0 dark:border-gray-700",children:Array.from({length:a}).map((n,d)=>e.jsx(G,{className:`h-4 flex-1 ${d===0?"w-1/4":""}`},d))},i))]})});const go=c.memo(function({className:a=""}){return e.jsxs("div",{className:`mb-8 ${a}`,"aria-hidden":"true",children:[e.jsxs("div",{className:"mb-4 flex items-center gap-2",children:[e.jsx(G,{className:"h-4 w-16"}),e.jsx(G,{className:"h-4 w-4"}),e.jsx(G,{className:"h-4 w-24"}),e.jsx(G,{className:"h-4 w-4"}),e.jsx(G,{className:"h-4 w-32"})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(G,{className:"mb-2 h-8 w-64"}),e.jsx(G,{className:"h-4 w-96"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(G,{className:"h-10 w-24"}),e.jsx(G,{className:"h-10 w-32"})]})]})]})});c.memo(function({className:a=""}){return e.jsxs("div",{className:`p-8 ${a}`,"aria-hidden":"true",children:[e.jsx(go,{}),e.jsxs("div",{className:"grid gap-8 lg:grid-cols-3",children:[e.jsxs("div",{className:"space-y-6 lg:col-span-2",children:[e.jsxs("div",{className:"rounded-lg border border-gray-200 bg-white p-6 dark:border-gray-700 dark:bg-gray-800",children:[e.jsx(G,{className:"mb-4 h-6 w-32"}),e.jsx("div",{className:"grid gap-4 sm:grid-cols-2",children:Array.from({length:6}).map((r,l)=>e.jsxs("div",{children:[e.jsx(G,{className:"mb-2 h-4 w-20"}),e.jsx(G,{className:"h-5 w-full"})]},l))})]}),e.jsxs("div",{className:"rounded-lg border border-gray-200 bg-white p-6 dark:border-gray-700 dark:bg-gray-800",children:[e.jsx(G,{className:"mb-4 h-6 w-24"}),e.jsx(G,{className:"mb-2 h-4 w-full"}),e.jsx(G,{className:"mb-2 h-4 w-full"}),e.jsx(G,{className:"h-4 w-3/4"})]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsx(Xe,{}),e.jsx(Xe,{})]})]})]})});function jc({data:s}){return tl({caseTitle:s?.caseData?.title,caseNumber:s?.caseData?.caseNumber})}function jo(){return e.jsxs("div",{className:"animate-pulse p-8",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("div",{className:"mb-2 h-8 w-64 rounded bg-gray-200 dark:bg-gray-700"}),e.jsx("div",{className:"h-4 w-48 rounded bg-gray-200 dark:bg-gray-700"})]}),e.jsx("div",{className:"mb-6 flex gap-4 border-b border-gray-200 dark:border-gray-700",children:Array.from({length:5}).map((s,a)=>e.jsx("div",{className:"h-10 w-24 rounded-t bg-gray-200 dark:bg-gray-700"},a))}),e.jsxs("div",{className:"grid gap-6 lg:grid-cols-3",children:[e.jsx("div",{className:"lg:col-span-2",children:e.jsx(Xe,{})}),e.jsx("div",{children:e.jsx(Xe,{})})]})]})}function St({label:s}){return e.jsxs("div",{className:"flex items-center gap-2 p-4 text-sm text-gray-500 dark:text-gray-400",children:[e.jsx("div",{className:"h-4 w-4 animate-spin rounded-full border-2 border-gray-300 border-t-blue-600 dark:border-gray-600 dark:border-t-blue-400"}),e.jsxs("span",{children:["Loading ",s,"..."]})]})}const bc=jr(function({loaderData:a}){const{caseData:r,documents:l,parties:o}=a,i=vr(),n=c.useCallback(()=>{i("/cases")},[i]),d=c.useCallback(m=>{i(`/cases/${m.id}`)},[i]);return e.jsx(c.Suspense,{fallback:e.jsx(jo,{}),children:e.jsx(lt,{resolve:l,errorElement:e.jsx(St,{label:"documents (error)"}),children:m=>e.jsx(lt,{resolve:o,errorElement:e.jsx(St,{label:"parties (error)"}),children:f=>e.jsx($s,{caseData:r,initialDocuments:m,initialParties:f,onBack:n,onSelectCase:d,initialTab:"Overview"})})})})}),vc=br(function({error:a}){return console.error("Case detail error:",a),a instanceof Response&&a.status===404?e.jsx(el,{title:"Case Not Found",message:"The case you're looking for doesn't exist or has been deleted.",backTo:"/cases",backLabel:"Back to Cases"}):e.jsx(sl,{error:a,title:"Failed to Load Case",message:"We couldn't load this case. Please try again.",backTo:"/cases",backLabel:"Back to Cases",onRetry:()=>window.location.reload()})});export{gl as A,cc as C,Zt as D,Yi as E,vs as F,jl as I,Yt as P,hc as R,pl as S,gc as T,uc as V,fc as W,mc as a,xl as b,Qt as c,sa as d,hl as e,fl as f,ys as g,Xs as h,il as i,ea as j,Fi as k,Vi as l,ta as m,pi as n,pc as o,xc as p,jc as q,bc as r,vc as s,dc as t,ul as u};
