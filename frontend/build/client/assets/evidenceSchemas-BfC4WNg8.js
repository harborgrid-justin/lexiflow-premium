import{A as l,d}from"./type-mappings-DEPYyX4d.js";const a=s=>s.replace(/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi,"").replace(/<iframe\b[^<]*(?:(?!<\/iframe>)<[^<]*)*<\/iframe>/gi,"").replace(/on\w+\s*=\s*["'][^"']*["']/gi,"").replace(/javascript:/gi,"").trim(),p=s=>/^\d{4}-\d{2}-\d{2}$/.test(s),u=s=>/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i.test(s),g=s=>/^[a-fA-F0-9]{64}$/.test(s),h=["Physical","Digital","Document","Testimony","Forensic"],f=Object.values(l),m=Object.values(d),y=s=>{const t=[];if(!s||typeof s!="object")return{success:!1,error:{errors:[{path:"root",message:"Data must be an object"}]}};const e=s;(!e.id||typeof e.id!="string")&&t.push({path:"id",message:"Evidence ID is required"}),(!e.trackingUuid||typeof e.trackingUuid!="string"||!u(e.trackingUuid))&&t.push({path:"trackingUuid",message:"Invalid UUID format"}),(!e.caseId||typeof e.caseId!="string")&&t.push({path:"caseId",message:"Case ID is required"});const n=e.title&&typeof e.title=="string"?a(e.title):"";n?n.length>500&&t.push({path:"title",message:"Title too long"}):t.push({path:"title",message:"Title is required"}),h.includes(e.type)||t.push({path:"type",message:"Invalid evidence type"});const o=e.description&&typeof e.description=="string"?a(e.description):"";o.length>5e3&&t.push({path:"description",message:"Description too long"}),(!e.collectionDate||typeof e.collectionDate!="string"||!p(e.collectionDate))&&t.push({path:"collectionDate",message:"Invalid date format (YYYY-MM-DD)"});const i=e.collectedBy&&typeof e.collectedBy=="string"?a(e.collectedBy):"";i?i.length>200&&t.push({path:"collectedBy",message:"Collector name too long"}):t.push({path:"collectedBy",message:"Collector name is required"});const c=e.custodian&&typeof e.custodian=="string"?a(e.custodian):"";c?c.length>200&&t.push({path:"custodian",message:"Custodian name too long"}):t.push({path:"custodian",message:"Custodian is required"});const r=e.location&&typeof e.location=="string"?a(e.location):"";return r.length>500&&t.push({path:"location",message:"Location too long"}),f.includes(e.admissibility)||t.push({path:"admissibility",message:"Invalid admissibility status"}),e.tags&&(!Array.isArray(e.tags)||e.tags.length>20)&&t.push({path:"tags",message:"Too many tags (max 20)"}),e.blockchainHash&&typeof e.blockchainHash=="string"&&!g(e.blockchainHash)&&t.push({path:"blockchainHash",message:"Invalid hash format"}),t.length>0?{success:!1,error:{errors:t}}:{success:!0,data:{...s,title:n,description:o,collectedBy:i,custodian:c,location:r}}},v=s=>{const t=[];if(!s||typeof s!="object")return{success:!1,error:{errors:[{path:"root",message:"Data must be an object"}]}};const e=s;(!e.id||typeof e.id!="string")&&t.push({path:"id",message:"Event ID is required"});const n=/^\d{4}-\d{2}-\d{2}(T\d{2}:\d{2}:\d{2}(\.\d{3})?Z)?$/;(!e.date||typeof e.date!="string"||!n.test(e.date))&&t.push({path:"date",message:"Invalid date format"}),m.includes(e.action)||t.push({path:"action",message:"Invalid custody action"});const o=e.actor&&typeof e.actor=="string"?a(e.actor):"";o?o.length>200&&t.push({path:"actor",message:"Actor name too long"}):t.push({path:"actor",message:"Actor name is required"});const i=e.notes&&typeof e.notes=="string"?a(e.notes):void 0;return i&&i.length>2e3&&t.push({path:"notes",message:"Notes too long"}),t.length>0?{success:!1,error:{errors:t}}:{success:!0,data:{...s,actor:o,notes:i}}},D=s=>y(s),I=s=>v(s);export{D as a,I as v};
