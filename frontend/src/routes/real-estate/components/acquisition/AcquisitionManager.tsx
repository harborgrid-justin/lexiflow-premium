import { CheckCircle, Clock, DollarSign, Filter, Plus, Search, ShoppingCart } from 'lucide-react';
import { useState } from 'react';
import { Form, Link } from 'react-router';

import type { AcquisitionLoaderData, AcquisitionStatus, RealEstateAcquisition } from './types'; interface AcquisitionManagerProps { data: RealEstateAcquisition[]; stats: AcquisitionLoaderData['stats'];
} export function AcquisitionManager({ data, stats }: AcquisitionManagerProps) { const [showCreateForm, setShowCreateForm] = useState(false); const [searchTerm, setSearchTerm] = useState(''); const [statusFilter, setStatusFilter] = useState<AcquisitionStatus | 'All'>('All'); const getStatusColor = (status: AcquisitionStatus): string => { switch (status) { case 'Prospecting': return 'text-[var(--color-primary)] bg-blue-50 dark:bg-blue-900/20'; case 'Under Contract': return 'text-amber-600 bg-amber-50 dark:text-amber-400 dark:bg-amber-900/20'; case 'Due Diligence': return 'text-purple-600 bg-purple-50 dark:text-purple-400 dark:bg-purple-900/20'; case 'Closed': return 'text-emerald-600 bg-emerald-50 dark:text-emerald-400 dark:bg-emerald-900/20'; case 'Cancelled': return 'text-[var(--color-textMuted)] bg-[var(--color-surfaceRaised)] /20'; default: return 'text-[var(--color-textMuted)] bg-[var(--color-surfaceRaised)]'; } }; const formatCurrency = (value?: number): string => { if (!value) return '—'; return new Intl.NumberFormat('en-US', { style: 'currency', currency: 'USD', maximumFractionDigits: 0 }).format(value); }; const formatDate = (dateStr?: string): string => { if (!dateStr) return '—'; return new Date(dateStr).toLocaleDateString('en-US', { year: 'numeric', month: 'short', day: 'numeric' }); }; const filteredData = data.filter(item => { const matchesSearch = item.propertyName.toLowerCase().includes(searchTerm.toLowerCase()) || item.address.toLowerCase().includes(searchTerm.toLowerCase()); const matchesStatus = statusFilter === 'All' || item.status === statusFilter; return matchesSearch && matchesStatus; }); return ( <div className="p-8"> {/* Breadcrumb */} <nav className="mb-4 text-sm text-[var(--color-textMuted)] dark:text-[var(--color-textMuted)]"> <Link to="/real_estate/portfolio_summary" className="hover:text-[var(--color-text)] dark:hover:text-gray-200"> Real Estate </Link> <span className="mx-2">/</span> <span className="text-[var(--color-text)]">Acquisition</span> </nav> {/* Header */} <div className="mb-8 flex items-center justify-between"> <div> <h1 className="text-2xl font-bold text-[var(--color-text)]"> Acquisition </h1> <p className="mt-1 text-sm text-[var(--color-textMuted)] dark:text-[var(--color-textMuted)]"> Manage property acquisitions and related transaction workflows. </p> </div> <button onClick={() => setShowCreateForm(true)} className="inline-flex items-center gap-2 rounded-lg bg-[var(--color-primary)] px-4 py-2 text-sm font-medium text-white hover:bg-[var(--color-primaryDark)] transition-colors" > <Plus className="h-4 w-4" /> New Acquisition </button> </div> {/* Stats Cards */} <div className="mb-8 grid grid-cols-1 gap-4 sm:grid-cols-4"> <div className="rounded-lg border border-[var(--color-borderLight)] bg-[var(--color-surface)] p-4"> <div className="flex items-center gap-3"> <div className="rounded-lg bg-slate-100 p-2"> <ShoppingCart className="h-5 w-5 text-[var(--color-textMuted)]" /> </div> <div> <p className="text-sm font-medium text-[var(--color-textMuted)] dark:text-[var(--color-textMuted)]">Total Acquisitions</p> <p className="text-xl font-bold text-[var(--color-text)]">{stats.total}</p> </div> </div> </div> <div className="rounded-lg border border-[var(--color-borderLight)] bg-[var(--color-surface)] p-4"> <div className="flex items-center gap-3"> <div className="rounded-lg bg-blue-100 p-2 dark:bg-blue-900/30"> <Clock className="h-5 w-5 text-[var(--color-primary)]" /> </div> <div> <p className="text-sm font-medium text-[var(--color-textMuted)] dark:text-[var(--color-textMuted)]">Active Deals</p> <p className="text-xl font-bold text-[var(--color-text)]">{stats.pending}</p> </div> </div> </div> <div className="rounded-lg border border-[var(--color-borderLight)] bg-[var(--color-surface)] p-4"> <div className="flex items-center gap-3"> <div className="rounded-lg bg-emerald-100 p-2 dark:bg-emerald-900/30"> <CheckCircle className="h-5 w-5 text-emerald-600 dark:text-emerald-400" /> </div> <div> <p className="text-sm font-medium text-[var(--color-textMuted)] dark:text-[var(--color-textMuted)]">Closed Deals</p> <p className="text-xl font-bold text-[var(--color-text)]">{stats.completed}</p> </div> </div> </div> <div className="rounded-lg border border-[var(--color-borderLight)] bg-[var(--color-surface)] p-4"> <div className="flex items-center gap-3"> <div className="rounded-lg bg-indigo-100 p-2 dark:bg-indigo-900/30"> <DollarSign className="h-5 w-5 text-indigo-600 dark:text-indigo-400" /> </div> <div> <p className="text-sm font-medium text-[var(--color-textMuted)] dark:text-[var(--color-textMuted)]">Total Pipeline</p> <p className="text-xl font-bold text-[var(--color-text)]">{formatCurrency(stats.totalInvestment)}</p> </div> </div> </div> </div> {/* Filters and Search */} <div className="mb-6 flex flex-col gap-4 sm:flex-row sm:items-center sm:justify-between"> <div className="relative max-w-sm flex-1"> <Search className="absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-[var(--color-textMuted)]" /> <input type="text" placeholder="Search properties..." value={searchTerm} onChange={(e) => setSearchTerm(e.target.value)} className="w-full rounded-md border border-[var(--color-borderLight)] bg-[var(--color-surface)] pl-10 pr-4 py-2 text-sm focus:border-blue-500 focus:outline-none focus:ring-1 focus:ring-blue-500" /> </div> <div className="flex items-center gap-2"> <Filter className="h-4 w-4 text-[var(--color-textMuted)]" /> <select value={statusFilter} onChange={(e) => setStatusFilter(e.target.value as AcquisitionStatus | 'All')} className="rounded-md border border-[var(--color-borderLight)] bg-[var(--color-surface)] px-3 py-2 text-sm focus:border-blue-500 focus:outline-none focus:ring-1 focus:ring-blue-500" > <option value="All">All Statuses</option> <option value="Prospecting">Prospecting</option> <option value="Under Contract">Under Contract</option> <option value="Due Diligence">Due Diligence</option> <option value="Closed">Closed</option> <option value="Cancelled">Cancelled</option> </select> </div> </div> {/* Acquisitions Table */} <div className="overflow-hidden rounded-lg border border-[var(--color-borderLight)] bg-[var(--color-surface)] shadow-sm"> <table className="min-w-full divide-y divide-gray-200 dark:divide-gray-700"> <thead className="bg-[var(--color-surfaceRaised)] /50"> <tr> <th className="px-6 py-3 text-left text-xs font-medium uppercase tracking-wider text-[var(--color-textMuted)] dark:text-[var(--color-textMuted)]">Property</th> <th className="px-6 py-3 text-left text-xs font-medium uppercase tracking-wider text-[var(--color-textMuted)] dark:text-[var(--color-textMuted)]">Status</th> <th className="px-6 py-3 text-left text-xs font-medium uppercase tracking-wider text-[var(--color-textMuted)] dark:text-[var(--color-textMuted)]">Type</th> <th className="px-6 py-3 text-right text-xs font-medium uppercase tracking-wider text-[var(--color-textMuted)] dark:text-[var(--color-textMuted)]">Price</th> <th className="px-6 py-3 text-left text-xs font-medium uppercase tracking-wider text-[var(--color-textMuted)] dark:text-[var(--color-textMuted)]">Target Close</th> <th className="px-6 py-3 text-right text-xs font-medium uppercase tracking-wider text-[var(--color-textMuted)] dark:text-[var(--color-textMuted)]">Actions</th> </tr> </thead> <tbody className="divide-y divide-gray-200 bg-[var(--color-surface)] dark:divide-gray-700"> {filteredData.length > 0 ? ( filteredData.map((item) => ( <tr key={item.id} className="hover:bg-[var(--color-surfaceRaised)] dark:hover:bg-gray-700/50"> <td className="px-6 py-4"> <div className="flex flex-col"> <span className="font-medium text-[var(--color-text)]">{item.propertyName}</span> <span className="text-sm text-[var(--color-textMuted)] dark:text-[var(--color-textMuted)]">{item.address}</span> </div> </td> <td className="px-6 py-4"> <span className={`inline-flex rounded-full px-2 py-1 text-xs font-semibold leading-5 ${getStatusColor(item.status)}`}> {item.status} </span> </td> <td className="px-6 py-4 text-sm text-[var(--color-textMuted)] dark:text-[var(--color-textMuted)]"> {item.propertyType} </td> <td className="px-6 py-4 text-right text-sm font-medium text-[var(--color-text)]"> {formatCurrency(item.offeredPrice || item.askingPrice)} </td> <td className="px-6 py-4 text-sm text-[var(--color-textMuted)] dark:text-[var(--color-textMuted)]"> {formatDate(item.targetCloseDate)} </td> <td className="px-6 py-4 text-right text-sm"> <Form method="post" className="inline-block"> <input type="hidden" name="id" value={item.id} /> <input type="hidden" name="intent" value="delete" /> <button type="submit" className="text-red-600 hover:text-red-900 dark:text-red-400 dark:hover:text-red-300" onClick={(e) => { if (!confirm('Are you sure you want to delete this acquisition?')) { e.preventDefault(); } }} > Delete </button> </Form> </td> </tr> )) ) : ( <tr> <td colSpan={6} className="px-6 py-12 text-center text-[var(--color-textMuted)] dark:text-[var(--color-textMuted)]"> No acquisitions found matching your criteria. </td> </tr> )} </tbody> </table> </div> {/* Create Modal would go here - simplified for this refactor */} {showCreateForm && ( <div className="fixed inset-0 z-50 flex items-center justify-center bg-black/50 p-4"> <div className="w-full max-w-md rounded-lg bg-[var(--color-surface)] p-6 shadow-xl"> <h2 className="mb-4 text-lg font-bold text-[var(--color-text)]">New Acquisition</h2> <Form method="post" onSubmit={() => setShowCreateForm(false)}> <input type="hidden" name="intent" value="create" /> <div className="space-y-4"> <div> <label className="block text-sm font-medium text-[var(--color-text)]">Property Name</label> <input name="propertyName" required className="mt-1 block w-full rounded-md border border-[var(--color-border)] px-3 py-2 text-sm" /> </div> <div> <label className="block text-sm font-medium text-[var(--color-text)]">Address</label> <input name="address" required className="mt-1 block w-full rounded-md border border-[var(--color-border)] px-3 py-2 text-sm" /> </div> <div> <label className="block text-sm font-medium text-[var(--color-text)]">Type</label> <select name="propertyType" className="mt-1 block w-full rounded-md border border-[var(--color-border)] px-3 py-2 text-sm"> <option value="Land">Land</option> <option value="Building">Building</option> <option value="Multi-Family">Multi-Family</option> <option value="Commercial">Commercial</option> </select> </div> <div> <label className="block text-sm font-medium text-[var(--color-text)]">Asking Price</label> <input name="askingPrice" type="number" className="mt-1 block w-full rounded-md border border-[var(--color-border)] px-3 py-2 text-sm" /> </div> <div className="mt-6 flex justify-end gap-3"> <button type="button" onClick={() => setShowCreateForm(false)} className="rounded-md border border-[var(--color-border)] px-4 py-2 text-sm font-medium text-[var(--color-text)] hover:bg-[var(--color-surfaceRaised)]" > Cancel </button> <button type="submit" className="rounded-md bg-[var(--color-primary)] px-4 py-2 text-sm font-medium text-white hover:bg-[var(--color-primaryDark)]" > Create </button> </div> </div> </Form> </div> </div> )} </div> );
}
